import{r as s,j as e,u as i}from"./react-vendor-Ve3SFwKO.js";import{C as t,b as n,c as o,e as r,i as a,B as d,a as c,u as l,j as m,v as p}from"./index-BnushFQy.js";import{h as u,f as x}from"./firebase-vendor-BC71bXmb.js";import{B as h}from"./BackButton-DohCcac0.js";import{redeemHostPointsForSubscriptionDiscount as j}from"./hostPointsService-BCZ7eKj5.js";import{i as f,G as b,L as v}from"./icons-vendor-DD8ZfUKZ.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-D9RGQy8n.js";const N=({points:i,userId:l,onRedeem:m})=>{const[p,u]=s.useState(null);return e.jsxs(t,{children:[e.jsx(n,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5 text-yellow-500"}),"Points & Rewards"]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-primary/10 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:i}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Points"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Available Rewards:"}),[{points:200,discount:100,description:"₱100 subscription discount"},{points:500,discount:250,description:"₱250 subscription discount"},{points:1e3,discount:500,description:"₱500 subscription discount"},{points:2e3,discount:1e3,description:"₱1000 subscription discount"}].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-primary"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-sm",children:[a(s.discount)," subscription discount"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.points," points"]})]})]}),e.jsx(d,{size:"sm",disabled:i<s.points||p===""+s.points,onClick:()=>(async s=>{if(l){u(""+s);try{const e=await j(l,s);c.success(`Successfully redeemed ${s} points for ${a(e)} discount! You can use this discount on your next subscription purchase.`),m&&m(e)}catch(e){c.error("Failed to redeem points: "+(e.message||"Unknown error"))}finally{u(null)}}else c.error("User ID is required to redeem points")})(s.points,s.discount),children:p===""+s.points?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-3 w-3 mr-2 animate-spin"}),"Redeeming..."]}):"Redeem"})]},s.points))]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-4 p-3 bg-muted rounded",children:[e.jsx("p",{className:"font-semibold mb-1",children:"How to earn points:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Complete a booking: 1 point per ₱100 (minimum 50 points)"}),e.jsx("li",{children:"• Receive a 5-star rating: +25 bonus points"}),e.jsx("li",{children:"• Listing approved: +100 points"})]}),e.jsx("p",{className:"font-semibold mt-3 mb-1",children:"Rewards:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Redeem points for subscription discounts"}),e.jsx("li",{children:"• 100 points = ₱50 discount"})]})]})]})]})},y=()=>{const t=i(),{user:n,userRole:o,refreshUserProfile:r,hasRole:d}=l(),[j,f]=s.useState(null),[b,v]=s.useState(!0);s.useEffect(()=>{!n||d("host")?n?y():v(!1):t("/host/login")},[n,o,t]);const y=async()=>{if(n)try{v(!0);const s=await u(x(m,"users",n.uid));if(s.exists()){const e=s.data();f(e)}}catch(s){c.error("Failed to load profile")}finally{v(!1)}};return b?e.jsx(p,{}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-3 sm:py-4 md:py-6 lg:py-8 max-w-4xl",children:[e.jsx(h,{to:"/host/dashboard",className:"mb-4 sm:mb-6"}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-4 sm:mb-6",children:"Rewards"}),e.jsx(N,{points:j?.hostPoints||0,userId:n?.uid||"",onRedeem:s=>{n&&(y(),r()),c.info(`You've earned ${a(s)} discount! Use it on your next subscription purchase.`)}})]})})};export{y as default};
