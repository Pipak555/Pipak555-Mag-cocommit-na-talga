import{u as s,r as e,j as t}from"./react-vendor-Ve3SFwKO.js";import{u as a,j as r,h as i,k as o,L as l,B as c,C as n,b as d,c as m,e as x,i as h,d as p,a as g,t as u}from"./index-BnushFQy.js";import{N as j}from"./NotificationBell-Dpks8-kf.js";import{C as b,h as v,e as f,s as w}from"./category-service-Dj__Y3MP.js";import{V as N}from"./video-background-DTGZ_twq.js";import{T as y}from"./theme-toggle-C_syTt2a.js";import{L as k}from"./ListingCard-D6Td60Vf.js";import{getRecommendations as C}from"./recommendations-B-fDFj-J.js";import{l as B,f as S}from"./firebase-vendor-BC71bXmb.js";import{A as R,a as z,b as A,c as O,d as D,e as F,f as I,g as T}from"./alert-dialog-Bv7bA0QL.js";import{h as V}from"./hero-home-D5ap7Mum.js";import{o as W,p as P,q as Y,j as L,k as E,r as G,B as H,H as M,b as q,W as U,s as X,l as Z,n as J}from"./icons-vendor-DD8ZfUKZ.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-D9RGQy8n.js";import"./input-C6C1u0Er.js";import"./scroll-area-BhtIT-Hd.js";import"./badge-CYghlWc2.js";import"./select-D2BQB2Va.js";import"./switch-nzajq-Jl.js";import"./label-DdT-oWKe.js";import"./dropdown-menu-eYIb6UEc.js";const K=()=>{const{user:K,userRole:Q,userProfile:$,signOut:_,hasRole:ss,addRole:es}=a(),ts=s(),[as,rs]=e.useState({favorites:0,wishlist:0,upcomingTrips:0,pastBookings:0,walletBalance:0}),[is,os]=e.useState([]),[ls,cs]=e.useState([]),[ns,ds]=e.useState([]),[ms,xs]=e.useState(!0),[hs,ps]=e.useState(!1);e.useEffect(()=>{if(!K||!ss("guest"))return void ts("/guest/login");gs();const s=B(S(r,"users",K.uid),s=>{if(s.exists()){const e=s.data();rs(s=>({...s,favorites:e.favorites?.length||0,wishlist:e.wishlist?.length||0,walletBalance:e.walletBalance||0})),cs(e.favorites||[]),ds(e.wishlist||[])}});return()=>{s()}},[K,Q,ts]);const gs=async()=>{if(K){xs(!0);try{const s=await i({guestId:K.uid}),e=new Date,t=s.filter(s=>new Date(s.checkIn)>=e&&"confirmed"===s.status).length,a=s.filter(s=>{const t=new Date(s.checkOut);return e>t||"completed"===s.status}).length;rs(s=>({...s,upcomingTrips:t,pastBookings:a}));const r=await C(K.uid,6);if(r.length>0){const s=r.map(s=>s.id),e=await o(s),t=r.map(s=>{const t=e.get(s.id);return{...s,averageRating:t?.averageRating||0,reviewCount:t?.reviewCount||0}});os(t)}else os(r)}catch(s){}finally{xs(!1)}}},us=async()=>{ss("host")?ts("/host/dashboard"):ts("/host/policies")};return t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx("header",{className:"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 shadow-soft",children:t.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center gap-2 sm:gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[t.jsx(l,{size:"sm"}),t.jsx("div",{className:"hidden sm:block p-2 rounded-lg bg-secondary/10",children:t.jsx(W,{className:"w-5 h-5 text-secondary"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("h1",{className:"text-base sm:text-lg font-bold truncate",children:["Welcome, ",$?.fullName||"Guest","!"]}),t.jsx("p",{className:"text-xs text-muted-foreground hidden sm:block",children:"Discover your next adventure"})]})]}),t.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0",children:[t.jsx(j,{}),t.jsx(y,{}),t.jsxs(c,{variant:"outline",onClick:()=>ps(!0),className:"h-9 sm:h-auto text-xs sm:text-sm px-2 sm:px-4 touch-manipulation",children:[t.jsx("span",{className:"hidden sm:inline",children:"Sign Out"}),t.jsx("span",{className:"sm:hidden",children:"Out"})]})]})]})}),t.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"relative mb-8 rounded-xl overflow-hidden h-64 md:h-80 lg:h-96 shadow-lg",children:[t.jsx(N,{src:"/videos/landing-hero.mp4",overlay:!0,fallbackImage:V}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/60 via-black/40 to-black/60 z-10"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent z-10"}),t.jsxs("div",{className:"relative z-20 h-full flex flex-col items-center justify-center text-center px-6",children:[t.jsx("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold mb-4 text-white drop-shadow-2xl",children:"Discover Your Next Adventure"}),t.jsxs("p",{className:"text-lg md:text-xl text-white/90 mb-6 max-w-2xl drop-shadow-lg",children:["Welcome back, ",$?.fullName||"Guest","! Ready to explore amazing places?"]}),t.jsx(c,{size:"lg",className:"h-12 px-8 text-lg bg-primary hover:bg-primary/90 shadow-2xl hover:shadow-2xl hover:scale-105 transition-all",onClick:()=>ts("/guest/browse"),children:"Browse All Listings"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3 md:gap-4 lg:gap-6 mb-4 sm:mb-6 md:mb-8 "+(ss("host")?"lg:grid-cols-5":"lg:grid-cols-6"),children:[t.jsxs(n,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer hover:scale-105 active:scale-100",onClick:()=>ts("/guest/favorites"),children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary via-secondary to-accent"}),t.jsx(d,{className:"pb-2 sm:pb-3 px-3 sm:px-6 pt-3 sm:pt-6",children:t.jsxs(m,{className:"text-xs sm:text-sm font-medium text-muted-foreground uppercase tracking-wide flex items-center gap-2",children:[t.jsx(P,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"Favorites"]})}),t.jsx(x,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:t.jsx("div",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-br from-primary to-primary-glow bg-clip-text text-transparent",children:as.favorites})})]}),t.jsxs(n,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer hover:scale-105 active:scale-100",onClick:()=>ts("/guest/wishlist"),children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 via-blue-400 to-blue-300"}),t.jsx(d,{className:"pb-2 sm:pb-3 px-3 sm:px-6 pt-3 sm:pt-6",children:t.jsxs(m,{className:"text-xs sm:text-sm font-medium text-muted-foreground uppercase tracking-wide flex items-center gap-2",children:[t.jsx(Y,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"Wishlist"]})}),t.jsx(x,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:t.jsx("div",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-br from-blue-500 to-blue-600 bg-clip-text text-transparent",children:as.wishlist})})]}),t.jsxs(n,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>ts("/guest/bookings?filter=upcoming"),children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-primary to-accent"}),t.jsx(d,{className:"pb-2 sm:pb-3 px-3 sm:px-6 pt-3 sm:pt-6",children:t.jsxs(m,{className:"text-xs sm:text-sm font-medium text-muted-foreground uppercase tracking-wide flex items-center gap-2",children:[t.jsx(L,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"Upcoming Trips"]})}),t.jsx(x,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:t.jsx("div",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-br from-secondary to-secondary/80 bg-clip-text text-transparent",children:as.upcomingTrips})})]}),t.jsxs(n,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>ts("/guest/bookings?filter=past"),children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-accent via-primary to-secondary"}),t.jsx(d,{className:"pb-2 sm:pb-3 px-3 sm:px-6 pt-3 sm:pt-6",children:t.jsxs(m,{className:"text-xs sm:text-sm font-medium text-muted-foreground uppercase tracking-wide flex items-center gap-2",children:[t.jsx(E,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"Past Bookings"]})}),t.jsx(x,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:t.jsx("div",{className:"text-2xl sm:text-3xl font-bold",children:as.pastBookings})})]}),t.jsxs(n,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group",children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-accent via-green-500 to-green-600"}),t.jsx(d,{className:"pb-2 sm:pb-3 px-3 sm:px-6 pt-3 sm:pt-6",children:t.jsxs(m,{className:"text-xs sm:text-sm font-medium text-muted-foreground uppercase tracking-wide flex items-center gap-2",children:[t.jsx(G,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"Wallet Balance"]})}),t.jsx(x,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:t.jsx("div",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-accent",children:h(as.walletBalance)})})]}),!ss("host")&&t.jsxs(n,{className:"relative overflow-hidden border-2 border-secondary/30 shadow-lg hover:shadow-xl transition-all duration-300 group cursor-pointer bg-gradient-to-br from-secondary/5 to-secondary/10",onClick:us,children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-secondary/80 to-secondary/60"}),t.jsx(d,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(H,{className:"w-5 h-5 text-secondary"}),t.jsx(m,{className:"text-sm font-medium text-secondary uppercase tracking-wide",children:"Become a Host"})]})}),t.jsxs(x,{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Start earning by hosting your property"}),t.jsx(c,{variant:"secondary",className:"w-full",onClick:s=>{s.stopPropagation(),us()},children:"Get Started"})]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Browse Categories"}),t.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[t.jsx(b,{videoSrc:"/videos/category-home.mp4",fallbackImage:v,icon:M,title:"Homes",description:"Find your perfect stay",href:"/guest/browse?category=home",colorClass:"primary"}),t.jsx(b,{videoSrc:"/videos/category-experience.mp4",fallbackImage:f,icon:q,title:"Experiences",description:"Discover unique activities",href:"/guest/browse?category=experience",colorClass:"secondary"}),t.jsx(b,{videoSrc:"/videos/category-service.mp4",fallbackImage:w,icon:U,title:"Services",description:"Professional assistance",href:"/guest/browse?category=service",colorClass:"accent"})]})]}),is.length>0&&t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(X,{className:"w-6 h-6 text-primary"}),t.jsx("h3",{className:"text-2xl font-bold",children:"Recommended for You"})]}),t.jsx(c,{variant:"outline",onClick:()=>ts("/guest/browse"),children:"View All"})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 items-stretch",children:is.slice(0,3).map(s=>t.jsx(k,{listing:s,onView:()=>ts("/guest/listing/"+s.id),onFavorite:()=>(async s=>{if(K)try{const e=await u(K.uid,s,ls);cs(e),g.success(e.includes(s)?"Added to favorites":"Removed from favorites")}catch(e){g.error("Failed to update favorites")}else g.error("Please login to add favorites")})(s.id),isFavorite:ls.includes(s.id)},s.id))})]}),t.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-5 gap-6",children:[t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ts("/guest/favorites"),children:t.jsxs(d,{children:[t.jsx(P,{className:"w-8 h-8 text-primary mb-2"}),t.jsx(m,{children:"Favorites"}),t.jsx(p,{children:"Your saved listings"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ts("/guest/bookings"),children:t.jsxs(d,{children:[t.jsx(L,{className:"w-8 h-8 text-secondary mb-2"}),t.jsx(m,{children:"My Bookings"}),t.jsx(p,{children:"View your trips"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ts("/guest/messages"),children:t.jsxs(d,{children:[t.jsx(Z,{className:"w-8 h-8 text-primary mb-2"}),t.jsx(m,{children:"Messages"}),t.jsx(p,{children:"View your conversations"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ts("/guest/wallet"),children:t.jsxs(d,{children:[t.jsx(G,{className:"w-8 h-8 text-accent mb-2"}),t.jsx(m,{children:"E-Wallet"}),t.jsx(p,{children:"Manage your balance"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ts("/guest/settings"),children:t.jsxs(d,{children:[t.jsx(J,{className:"w-8 h-8 text-muted-foreground mb-2"}),t.jsx(m,{children:"Settings"}),t.jsx(p,{children:"Account preferences"})]})})]})]}),t.jsx(R,{open:hs,onOpenChange:ps,children:t.jsxs(z,{children:[t.jsxs(A,{children:[t.jsx(O,{children:"Sign Out"}),t.jsx(D,{children:"Are you sure you want to sign out? You'll need to sign in again to access your account."})]}),t.jsxs(F,{children:[t.jsx(I,{children:"Cancel"}),t.jsx(T,{onClick:async()=>{await _(),ts("/")},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sign Out"})]})]})})]})};export{K as default};
