import{u as e,r as s,j as t}from"./react-vendor-DAkY0NgE.js";import{u as a,h as r,E as n,e as i,x as d,B as c,C as l,a as o,b as m,d as x,i as h,c as g}from"./index-BbvEjZj9.js";import{B as j}from"./badge-Bdu_tSqo.js";import{A as u,i as p,q as f,r as N}from"./icons-vendor-3zhgXMYa.js";import"./maps-vendor-CYGXCXz5.js";import"./utils-vendor-yBsXXcRr.js";import"./ui-vendor-CZx_xpmK.js";import"./firebase-vendor-CvoiOdvz.js";const b=()=>{const b=e(),{user:y,userRole:v}=a(),[w,E]=s.useState(!0),[k,S]=s.useState({totalEarnings:0,pendingEarnings:0,completedEarnings:0,serviceFees:0}),[D,F]=s.useState([]),[B,P]=s.useState([]);s.useEffect(()=>{y&&"host"===v?A():b("/host/login")},[y,v,b]);const A=async()=>{if(y){E(!0);try{const e=await r({hostId:y.uid});F(e);const s=e.filter(e=>"confirmed"===e.status||"completed"===e.status),t=e.filter(e=>"pending"===e.status),a=s.reduce((e,s)=>e+(s.totalPrice||0),0),i=t.reduce((e,s)=>e+(s.totalPrice||0),0),d=.1*a;S({totalEarnings:a,pendingEarnings:i,completedEarnings:a-d,serviceFees:d});const c=await n(y.uid);P(c)}catch(e){i.error("Failed to load payments: "+(e.message||"Unknown error"))}finally{E(!1)}}};return w?t.jsx("div",{className:"min-h-screen bg-background p-6",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx(d,{})})}):t.jsx("div",{className:"min-h-screen bg-background p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsxs(c,{variant:"ghost",onClick:()=>b("/host/dashboard"),children:[t.jsx(u,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Payments & Earnings"}),t.jsx("p",{className:"text-muted-foreground",children:"View your earnings and payment history"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[t.jsxs(l,{children:[t.jsx(o,{className:"pb-3",children:t.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Total Earnings"})}),t.jsxs(x,{children:[t.jsx("div",{className:"text-2xl font-bold text-primary",children:h(k.totalEarnings)}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"From all confirmed bookings"})]})]}),t.jsxs(l,{children:[t.jsx(o,{className:"pb-3",children:t.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Your Earnings"})}),t.jsxs(x,{children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:h(k.completedEarnings)}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"After 10% service fee"})]})]}),t.jsxs(l,{children:[t.jsx(o,{className:"pb-3",children:t.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Pending Earnings"})}),t.jsxs(x,{children:[t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:h(k.pendingEarnings)}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Awaiting confirmation"})]})]}),t.jsxs(l,{children:[t.jsx(o,{className:"pb-3",children:t.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Service Fees"})}),t.jsxs(x,{children:[t.jsx("div",{className:"text-2xl font-bold text-accent",children:h(k.serviceFees)}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"10% commission"})]})]})]}),t.jsxs(l,{className:"mb-8",children:[t.jsxs(o,{children:[t.jsx(m,{children:"Recent Bookings"}),t.jsx(g,{children:"Your recent booking payments"})]}),t.jsx(x,{children:0===D.length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(p,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No bookings yet"})]}):t.jsx("div",{className:"space-y-4",children:D.slice(0,5).map(e=>t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center",children:t.jsx(p,{className:"h-6 w-6 text-primary"})}),t.jsxs("div",{children:[t.jsxs("p",{className:"font-medium",children:["Booking #",e.id.slice(0,8)]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[new Date(e.checkIn).toLocaleDateString()," - ",new Date(e.checkOut).toLocaleDateString()]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.guests," guest",e.guests>1?"s":""]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-lg font-bold",children:h(e.totalPrice||0)}),t.jsx(j,{className:"confirmed"===e.status||"completed"===e.status?"bg-green-500":"pending"===e.status?"bg-yellow-500":"bg-red-500",children:e.status})]})]},e.id))})})]}),t.jsxs(l,{children:[t.jsxs(o,{children:[t.jsx(m,{children:"Transaction History"}),t.jsx(g,{children:"Your payment and withdrawal history"})]}),t.jsx(x,{children:0===B.length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(f,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No transactions yet"})]}):t.jsx("div",{className:"space-y-4",children:B.map(e=>t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center "+("deposit"===e.type||"reward"===e.type?"bg-green-500/10":"bg-red-500/10"),children:"deposit"===e.type||"reward"===e.type?t.jsx(N,{className:"h-6 w-6 text-green-500"}):t.jsx(N,{className:"h-6 w-6 text-red-500 rotate-180"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:e.description}),t.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(e.createdAt).toLocaleString()}),e.paymentMethod&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Method: ",e.paymentMethod]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"text-lg font-bold "+("deposit"===e.type||"reward"===e.type?"text-green-500":"text-red-500"),children:["deposit"===e.type||"reward"===e.type?"+":"-",h(e.amount)]}),e.status&&t.jsx(j,{className:"completed"===e.status?"bg-green-500":"pending"===e.status?"bg-yellow-500":"failed"===e.status?"bg-red-500":"bg-gray-500",children:e.status})]})]},e.id))})})]})]})})};export{b as default};
