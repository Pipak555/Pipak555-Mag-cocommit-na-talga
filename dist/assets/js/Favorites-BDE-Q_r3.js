const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-BnushFQy.js","assets/js/react-vendor-Ve3SFwKO.js","assets/js/utils-vendor-DzY7Ay74.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-D9RGQy8n.js","assets/js/icons-vendor-DD8ZfUKZ.js","assets/js/firebase-vendor-BC71bXmb.js","assets/index-CZT-s-DH.css"])))=>i.map(i=>d[i]);
import{u as s,j as t,_ as e,v as i,C as a,b as r,c as o,d as n,e as c,B as d,a as l,t as m}from"./index-BnushFQy.js";import{u,r as f,j as g}from"./react-vendor-Ve3SFwKO.js";import{h as j,f as v}from"./firebase-vendor-BC71bXmb.js";import{L as h}from"./ListingCard-D6Td60Vf.js";import{E as x}from"./empty-state-BDfunuWx.js";import{B as p}from"./BackButton-DohCcac0.js";import{p as y}from"./icons-vendor-DD8ZfUKZ.js";import"./ui-vendor-D9RGQy8n.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./badge-CYghlWc2.js";const b=()=>{const b=u(),{user:w,hasRole:L}=s(),[N,S]=f.useState(null),[_,B]=f.useState([]),[E,F]=f.useState([]),[k,C]=f.useState([]),[P,R]=f.useState(!0);f.useEffect(()=>{!w||L("guest")?w?A():R(!1):b("/guest/login")},[w,b]),f.useEffect(()=>{w&&N&&(Y(),V())},[w,N]);const A=async()=>{if(w)try{const s=await j(v(t,"users",w.uid));if(s.exists()){const t=s.data();S(t),F(t.favorites||[]),C(t.wishlist||[])}}catch(s){}finally{R(!1)}},V=async()=>{if(w)try{const s=await j(v(t,"users",w.uid));if(s.exists()){const t=s.data();C(t.wishlist||[])}}catch(s){}},Y=async()=>{if(w&&N?.favorites?.length)try{const{getListing:s}=await e(async()=>{const{getListing:s}=await import("./index-BnushFQy.js").then(s=>s.W);return{getListing:s}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),t=await Promise.all(N.favorites.map(t=>s(t)));B(t.filter(s=>null!==s))}catch(s){B([])}else B([])};return P?g.jsx(i,{}):g.jsx("div",{className:"min-h-screen bg-background",children:g.jsxs("div",{className:"container mx-auto px-4 py-8",children:[g.jsx(p,{to:"/guest/dashboard",className:"mb-4 sm:mb-6"}),g.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Your Favorites"}),g.jsxs(a,{children:[g.jsxs(r,{children:[g.jsx(o,{children:"Your Favorites"}),g.jsx(n,{children:"Listings you've liked and saved"})]}),g.jsx(c,{children:0===_.length?g.jsx(x,{icon:g.jsx(y,{className:"h-10 w-10"}),title:"No favorites yet",description:"Start exploring and add listings to your favorites!",action:g.jsx(d,{onClick:()=>b("/guest/browse"),children:"Browse Listings"})}):g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map(s=>g.jsx(h,{listing:s,onView:()=>b("/guest/listing/"+s.id),onFavorite:()=>(async s=>{if(w)try{const t=await m(w.uid,s,E);F(t),S(s=>s?{...s,favorites:t}:null),Y(),l.success(t.includes(s)?"Added to favorites":"Removed from favorites")}catch(t){l.error("Failed to update favorites")}else l.error("Please login to manage favorites")})(s.id),isFavorite:E.includes(s.id)},s.id))})})]})]})})};export{b as default};
