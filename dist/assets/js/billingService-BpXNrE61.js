import{q as t,c as e,w as a,d as i,u as n,e as s,j as r}from"./firebase-vendor-BtzXZj7S.js";import{j as o,G as c}from"./index-BbQqfVom.js";import"./react-vendor-BMVo5gto.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-Dbp4DHG_.js";import"./icons-vendor-D1YpcxsO.js";const l=[{id:"active-host-monthly",name:"Active Host",description:"Full access to host properties and manage listings",price:699,billingCycle:"monthly",features:["Unlimited listings","Priority support","Advanced analytics","Marketing tools","Booking management"],isActive:!0},{id:"active-host-yearly",name:"Active Host",description:"Full access to host properties and manage listings (Yearly)",price:6990,billingCycle:"yearly",features:["Unlimited listings","Priority support","Advanced analytics","Marketing tools","Booking management","Save 2 months (17% discount)"],isActive:!0}],d=()=>l.filter(t=>t.isActive),p=t=>l.find(e=>e.id===t)||null,m=async(c,l,d,m)=>{try{const u=p(l);if(!u)throw Error("Invalid plan selected");const y=new Date,g=new Date;"monthly"===u.billingCycle?g.setMonth(g.getMonth()+1):g.setFullYear(g.getFullYear()+1);const I=new Date(g),v=t(e(o,"subscriptions"),a("userId","==",c),a("status","==","active")),h=await i(v);let S;if(h.empty){const t={userId:c,planId:u.id,planName:u.name,amount:u.price,billingCycle:u.billingCycle,status:"active",startDate:y.toISOString(),endDate:g.toISOString(),nextBillingDate:I.toISOString(),paymentMethod:"paypal",paymentId:d,transactionId:m,createdAt:y.toISOString(),updatedAt:y.toISOString()};S=(await r(e(o,"subscriptions"),t)).id}else S=h.docs[0].id,await n(s(o,"subscriptions",S),{planId:u.id,planName:u.name,amount:u.price,billingCycle:u.billingCycle,status:"active",startDate:y.toISOString(),endDate:g.toISOString(),nextBillingDate:I.toISOString(),paymentMethod:"paypal",paymentId:d,transactionId:m,updatedAt:(new Date).toISOString()});return S}catch(u){throw Error(u.message||"Failed to create subscription")}},u=async n=>{try{const s=t(e(o,"subscriptions"),a("userId","==",n),a("status","==","active")),r=await i(s);if(r.empty)return null;const c=r.docs[0];return{id:c.id,...c.data()}}catch(s){return null}},y=async t=>{const e=await u(t);return!!e&&(e.endDate?new Date(e.endDate)>new Date:"active"===e.status)},g=async(t,e,a,i)=>{try{const n=p(e);if(!n)throw Error("Invalid plan selected");const s=await c({userId:t,type:"payment",amount:n.price,description:`Host subscription: ${n.name} (${n.billingCycle})`,status:"completed",paymentMethod:"paypal",paymentId:i});return{subscriptionId:await m(t,e,a,s),transactionId:s}}catch(n){throw Error(n.message||"Failed to process subscription payment")}};export{l as HOST_PLANS,m as createHostSubscription,d as getAvailablePlans,p as getPlanById,u as getUserSubscription,y as hasActiveSubscription,g as processSubscriptionPayment};
