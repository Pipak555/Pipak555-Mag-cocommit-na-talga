import{h as t,f as o,u as s}from"./firebase-vendor-BC71bXmb.js";import{j as r,z as i}from"./index-DaMaslBo.js";import"./react-vendor-Ve3SFwKO.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-D9RGQy8n.js";import"./icons-vendor-Dhca6XHc.js";const a=async(a,n,e)=>{try{const c=await t(o(r,"users",a));if(!c.exists())throw Error("Host not found");const d=c.data().hostPoints||0,u=Math.max(50,Math.floor(e/100)),p=d+u;return await s(o(r,"users",a),{hostPoints:p}),await i({userId:a,type:"reward",amount:u,description:"Host points earned for completed booking #"+n.slice(0,8),status:"completed",bookingId:n}),u}catch(c){throw c}},n=async(a,n,e)=>{try{if(5>n)return 0;const c=await t(o(r,"users",a));if(!c.exists())throw Error("Host not found");const d=c.data().hostPoints||0,u=25,p=d+u;return await s(o(r,"users",a),{hostPoints:p}),await i({userId:a,type:"reward",amount:u,description:`Host bonus points for 5-star rating (booking #${e.slice(0,8)})`,status:"completed",bookingId:e}),u}catch(c){throw c}},e=async(a,n)=>{try{const e=await t(o(r,"users",a));if(!e.exists())throw Error("Host not found");const c=e.data().hostPoints||0,d=100,u=c+d;return await s(o(r,"users",a),{hostPoints:u}),await i({userId:a,type:"reward",amount:d,description:`Host points for listing approval (listing #${n.slice(0,8)})`,status:"completed"}),d}catch(e){throw e}},c=async(a,n)=>{try{const e=await t(o(r,"users",a));if(!e.exists())throw Error("Host not found");const c=e.data().hostPoints||0;if(n>c)throw Error("Insufficient points");const d=Math.floor(n/100*50),u=c-n;return await s(o(r,"users",a),{hostPoints:u}),await i({userId:a,type:"reward",amount:-n,description:`Host points redeemed for subscription discount (â‚±${d.toFixed(2)})`,status:"completed"}),d}catch(e){throw e}};export{a as awardHostPointsForBooking,e as awardHostPointsForListingApproval,n as awardHostPointsForRating,c as redeemHostPointsForSubscriptionDiscount};
