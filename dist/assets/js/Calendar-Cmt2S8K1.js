import{u as e,r as s,j as t}from"./react-vendor-Ve3SFwKO.js";import{u as a,L as n,B as r,C as i,e as l,b as d,c as o,d as c,i as m,j as x}from"./index-BnushFQy.js";import{N as u}from"./NotificationBell-Dpks8-kf.js";import{B as h}from"./badge-CYghlWc2.js";import{C as g}from"./calendar-CF_sIwXc.js";import{T as p}from"./theme-toggle-C_syTt2a.js";import{B as j}from"./BackButton-DohCcac0.js";import{q as f,w as b,d as N,l as w,f as v,h as y}from"./firebase-vendor-BC71bXmb.js";import{S as k,a as D,b as S,c as C,d as _}from"./select-D2BQB2Va.js";import{D as I,a as O,b as T,c as L,d as B}from"./dialog-B475KvSN.js";import{A as H,a as P,b as z,c as M,d as A,e as V,f as G,g as Y}from"./alert-dialog-Bv7bA0QL.js";import{a3 as F,a4 as U,K as E,an as q,ao as K,j as Z}from"./icons-vendor-DD8ZfUKZ.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-D9RGQy8n.js";import"./input-C6C1u0Er.js";import"./scroll-area-BhtIT-Hd.js";import"./switch-nzajq-Jl.js";import"./label-DdT-oWKe.js";import"./dropdown-menu-eYIb6UEc.js";const J=()=>{const J=e(),{user:Q,signOut:R}=a(),[W,X]=s.useState([]),[$,ee]=s.useState([]),[se,te]=s.useState(!0),[ae,ne]=s.useState(new Date),[re,ie]=s.useState("month"),[le,de]=s.useState("all"),[oe,ce]=s.useState(null),[me,xe]=s.useState(!1),[ue,he]=s.useState(!1),[ge,pe]=s.useState();s.useEffect(()=>{if(!Q)return;const e=f(N(x,"listing"),b("hostId","==",Q.uid)),s=w(e,e=>{const s=e.docs.map(e=>({id:e.id,...e.data()}));ee(s)});return()=>s()},[Q]),s.useEffect(()=>{if(!Q)return;te(!0);const e=f(N(x,"bookings"),b("hostId","==",Q.uid)),s=w(e,async e=>{const s=await Promise.all(e.docs.map(async e=>{const s={id:e.id,...e.data()};if(s.listingId){const e=v(x,"listing",s.listingId),t=await y(e);if(t.exists()){const e=t.data();s.listingTitle=e?.title,s.listingLocation=e?.location}}if(s.guestId){const e=v(x,"users",s.guestId),t=await y(e);t.exists()&&(s.guestName=t.data()?.fullName)}return s}));X(s),te(!1)});return()=>s()},[Q]);const je=e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e.checkOut);return t.setHours(0,0,0,0),s>t&&"confirmed"===e.status?"bg-green-500":"confirmed"===e.status?"bg-blue-500":"pending"===e.status?"bg-orange-500":(e.status,"bg-gray-400")},fe=e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e.checkOut);return t.setHours(0,0,0,0),s>t&&"confirmed"===e.status?"Successful":"confirmed"===e.status?"Upcoming":"pending"===e.status?"Pending":"cancelled"===e.status?"Cancelled":e.status},be=e=>{if("all"===le)return!1;const s=$.find(e=>e.id===le);if(!s?.blockedDates||0===s.blockedDates.length)return!1;const t=e.toISOString().split("T")[0];return s.blockedDates.includes(t)};(()=>{const e=ae.getFullYear(),s=ae.getMonth(),t=new Date(e,s,1),a=new Date(e,s+1,0).getDate(),n=t.getDay(),r=[];for(let i=0;n>i;i++)r.push(null);for(let i=1;a>=i;i++)r.push(new Date(e,s,i))})();const Ne=ae.toLocaleDateString("en-US",{month:"long",year:"numeric"}),we=()=>{let e=W.filter(e=>"cancelled"!==e.status);return"all"!==le&&(e=e.filter(e=>e.listingId===le)),e.sort((e,s)=>new Date(e.checkIn).getTime()-new Date(s.checkIn).getTime()),e};return t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx("header",{className:"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 shadow-soft",children:t.jsxs("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-3 sm:py-4 flex justify-between items-center gap-2 sm:gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[t.jsx(j,{to:"/host/dashboard"}),t.jsx(n,{size:"sm"})]}),t.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0",children:[t.jsx(u,{}),t.jsx(p,{}),t.jsxs(r,{variant:"outline",onClick:()=>he(!0),className:"h-9 sm:h-auto text-xs sm:text-sm px-2 sm:px-4 touch-manipulation",children:[t.jsx("span",{className:"hidden sm:inline",children:"Sign Out"}),t.jsx("span",{className:"sm:hidden",children:"Out"})]})]})]})}),t.jsxs("main",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6 md:py-8",children:[t.jsx(j,{to:"/host/dashboard",className:"mb-4 sm:mb-6"}),t.jsxs("div",{className:"mb-4 sm:mb-6 md:mb-8",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-2",children:"Booking Calendar"}),t.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage your bookings and availability"})]}),t.jsx(i,{className:"mb-6",children:t.jsx(l,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(r,{variant:"outline",size:"icon",onClick:()=>{ne(new Date(ae.getFullYear(),ae.getMonth()-1))},children:t.jsx(F,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-xl font-semibold min-w-[200px] text-center",children:Ne}),t.jsx(r,{variant:"outline",size:"icon",onClick:()=>{ne(new Date(ae.getFullYear(),ae.getMonth()+1))},children:t.jsx(U,{className:"h-4 w-4"})}),t.jsx(r,{variant:"outline",onClick:()=>{ne(new Date)},children:"Today"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(k,{value:le,onValueChange:de,children:[t.jsxs(D,{className:"w-[200px]",children:[t.jsx(E,{className:"h-4 w-4 mr-2"}),t.jsx(S,{placeholder:"All Properties"})]}),t.jsxs(C,{children:[t.jsx(_,{value:"all",children:"All Properties"}),$.map(e=>t.jsx(_,{value:e.id,children:e.title},e.id))]})]}),t.jsxs("div",{className:"flex items-center gap-2 border rounded-md p-1",children:[t.jsxs(r,{variant:"month"===re?"default":"ghost",size:"sm",onClick:()=>ie("month"),children:[t.jsx(q,{className:"h-4 w-4 mr-2"}),"Month"]}),t.jsxs(r,{variant:"list"===re?"default":"ghost",size:"sm",onClick:()=>ie("list"),children:[t.jsx(K,{className:"h-4 w-4 mr-2"}),"List"]})]})]})]})})}),t.jsx(i,{className:"mb-6",children:t.jsx(l,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-4 sm:gap-6",children:[t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-primary/5 border border-primary/20 hover:bg-primary/10 transition-colors",children:[t.jsx("div",{className:"w-5 h-5 rounded-md border-2 border-primary bg-primary/10 flex items-center justify-center shadow-sm",children:t.jsx(Z,{className:"h-3 w-3 text-primary"})}),t.jsx("span",{className:"text-sm font-semibold text-primary",children:"Today"})]}),t.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-blue-500/5 border border-blue-500/20 hover:bg-blue-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-blue-500 shadow-sm ring-2 ring-blue-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Upcoming"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-green-500/5 border border-green-500/20 hover:bg-green-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-green-500 shadow-sm ring-2 ring-green-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Successful"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-orange-500/5 border border-orange-500/20 hover:bg-orange-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-orange-500 shadow-sm ring-2 ring-orange-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Pending"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-gray-500/5 border border-gray-500/20 hover:bg-gray-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-gray-400 dark:bg-gray-500 shadow-sm ring-2 ring-gray-400/20 dark:ring-gray-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Cancelled"})]})]})})}),"month"===re&&t.jsxs(i,{className:"shadow-lg",children:[t.jsxs(d,{className:"pb-4 sm:pb-6 px-4 sm:px-6",children:[t.jsxs(o,{className:"text-lg sm:text-xl font-bold flex items-center gap-2",children:[t.jsx(Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"}),"Select Dates"]}),t.jsx(c,{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:"View booking availability calendar"})]}),t.jsx(l,{className:"px-4 sm:px-6 pb-4 sm:pb-6",children:t.jsx("div",{className:"w-full",children:t.jsx(g,{mode:"range",selected:ge,onSelect:e=>pe(e),disabled:e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e);return t.setHours(0,0,0,0),s>=t||!!be(t)},modifiers:{booked:e=>(e=>{const s=(()=>{let e=W.filter(e=>"confirmed"===e.status);return"all"!==le&&(e=e.filter(e=>e.listingId===le)),e})();if(!s.length)return!1;const t=e.getTime();return s.some(e=>{const s=new Date(e.checkIn),a=new Date(e.checkOut);return s.setHours(0,0,0,0),a.setHours(0,0,0,0),t>=s.getTime()&&t<=a.getTime()})})(e),blocked:e=>be(e)},modifiersClassNames:{booked:"bg-orange-500/20 text-orange-600 dark:text-orange-400",blocked:"bg-red-500/20 text-red-600 dark:text-red-400"},classNames:{months:"flex flex-row space-x-4",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:"h-9 w-9 p-0 font-normal aria-selected:opacity-100 rounded-md hover:bg-accent transition-colors",day_range_end:"day-range-end",day_selected:"bg-green-500 text-white hover:bg-green-600 hover:text-white focus:bg-green-500 focus:text-white rounded-md",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50 cursor-not-allowed",day_range_middle:"aria-selected:bg-green-100 dark:aria-selected:bg-green-900/30 aria-selected:text-green-900 dark:aria-selected:text-green-100",day_hidden:"invisible"},numberOfMonths:2})})})]}),"list"===re&&t.jsxs(i,{children:[t.jsxs(d,{children:[t.jsx(o,{children:"All Bookings"}),t.jsxs(c,{children:[we().length," booking",1!==we().length?"s":""]})]}),t.jsx(l,{children:se?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading bookings..."}):0===we().length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No bookings found"})]}):t.jsx("div",{className:"space-y-4",children:we().map(e=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>(e=>{ce(e),xe(!0)})(e),children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("h3",{className:"font-semibold",children:e.listingTitle}),t.jsx(h,{className:je(e),children:fe(e)})]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:["ðŸ“ ",e.listingLocation]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:["ðŸ‘¤ ",e.guestName||"Guest"]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["ðŸ“… ",new Date(e.checkIn).toLocaleDateString()," - ",new Date(e.checkOut).toLocaleDateString()]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-semibold text-lg",children:m(e.totalPrice||0)}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.guests," guest",1!==e.guests?"s":""]})]})]})},e.id))})})]})]}),t.jsx(I,{open:me,onOpenChange:xe,children:t.jsxs(O,{className:"max-w-2xl",children:[t.jsxs(T,{children:[t.jsx(L,{children:"Booking Details"}),t.jsx(B,{children:"View booking information"})]}),oe&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold",children:oe.listingTitle}),t.jsx(h,{className:je(oe),children:fe(oe)})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-in"}),t.jsx("p",{className:"font-medium",children:new Date(oe.checkIn).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-out"}),t.jsx("p",{className:"font-medium",children:new Date(oe.checkOut).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Guest"}),t.jsx("p",{className:"font-medium",children:oe.guestName||"Guest"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Guests"}),t.jsx("p",{className:"font-medium",children:oe.guests})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),t.jsx("p",{className:"font-medium text-lg",children:m(oe.totalPrice||0)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Booking ID"}),t.jsxs("p",{className:"font-medium text-sm",children:[oe.id.slice(0,8),"..."]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Location"}),t.jsx("p",{className:"font-medium",children:oe.listingLocation})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(r,{variant:"default",className:"flex-1",onClick:()=>{J("/host/bookings"),xe(!1)},children:"View in Bookings"}),t.jsx(r,{variant:"outline",onClick:()=>xe(!1),children:"Close"})]})]})]})}),t.jsx(H,{open:ue,onOpenChange:he,children:t.jsxs(P,{children:[t.jsxs(z,{children:[t.jsx(M,{children:"Sign Out?"}),t.jsx(A,{children:"Are you sure you want to sign out?"})]}),t.jsxs(V,{children:[t.jsx(G,{children:"Cancel"}),t.jsx(Y,{onClick:async()=>{try{await R(),J("/")}catch(e){}},children:"Sign Out"})]})]})})]})};export{J as default};
