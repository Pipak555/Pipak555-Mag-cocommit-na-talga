import{u as e,r as s,j as a}from"./react-vendor-BMVo5gto.js";import{o as l,e as i,B as t,v as r,i as n,y as o,l as c,m as d,F as m}from"./index-Bl4WVUm9.js";import{L as h}from"./ListingCard-CV_xDRBJ.js";import{A as x,a as g,b as p,c as u,d as j,e as f,f as b,g as v}from"./alert-dialog-ChaDevpt.js";import{D as N,a as w,b as y,c as k,d as C}from"./dialog-DVuhSEXh.js";import{B as A}from"./badge-_91-i8yA.js";import{S as z}from"./separator-B1Y9EFTv.js";import{A as S,$ as L,a0 as I,a1 as F,o as P,M as R,u as $,m as B,U as E,w as O,x as U,H as D,X as T}from"./icons-vendor-BQMxNFbQ.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-Dbp4DHG_.js";import"./firebase-vendor-BtzXZj7S.js";const G=()=>{const G=e(),[H,M]=s.useState([]),[V,X]=s.useState(!0),[q,J]=s.useState(!1),[K,Q]=s.useState(!1),[W,Y]=s.useState(null),[Z,_]=s.useState(null),[ee,se]=s.useState(null),[ae,le]=s.useState(!1),[ie,te]=s.useState(!1),[re,ne]=s.useState(0),[oe,ce]=s.useState(!1),[de,me]=s.useState(0);s.useEffect(()=>{he()},[]);const he=async()=>{try{X(!0);const e=await l({status:"pending"});M(e)}catch(e){i.error("Failed to load pending listings: "+(e.message||"Unknown error"))}finally{X(!1)}},xe=e=>{Y(e),J(!0)},ge=e=>{Y(e),Q(!0)};return a.jsxs("div",{className:"min-h-screen bg-background p-6",children:[a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs(t,{variant:"ghost",onClick:()=>G("/admin/dashboard"),className:"mb-6",children:[a.jsx(S,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Review Pending Listings"}),V?a.jsx(r,{}):0===H.length?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-muted-foreground",children:"No pending listings"})}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:H.map(e=>a.jsxs("div",{className:"cursor-pointer",onClick:()=>(async e=>{if(_(e),le(!0),ne(0),te(!0),e.hostId)try{const s=await o(e.hostId);se(s?{fullName:s.fullName||"N/A",email:s.email||"N/A"}:{fullName:"N/A",email:"N/A"})}catch(s){se({fullName:"Error loading",email:"Error loading"})}finally{te(!1)}else se({fullName:"N/A",email:"N/A"}),te(!1)})(e),children:[a.jsx(h,{listing:e}),a.jsxs("div",{className:"mt-2 flex gap-2",onClick:e=>e.stopPropagation(),children:[a.jsx(t,{variant:"default",size:"sm",className:"flex-1",onClick:()=>xe(e.id),children:"Approve"}),a.jsx(t,{variant:"destructive",size:"sm",className:"flex-1",onClick:()=>ge(e.id),children:"Reject"})]})]},e.id))})]}),a.jsx(x,{open:q,onOpenChange:J,children:a.jsxs(g,{children:[a.jsxs(p,{children:[a.jsx(u,{children:"Approve Listing?"}),a.jsx(j,{children:"Are you sure you want to approve this listing? It will be published and visible to all users."})]}),a.jsxs(f,{children:[a.jsx(b,{onClick:()=>Y(null),children:"Cancel"}),a.jsx(v,{onClick:async()=>{if(W)try{const s=await c(W);if(!s)return void i.error("Listing not found");if(await d(W,{status:"approved"}),s.hostId)try{await m(s.hostId,W,s.title)}catch(e){}i.success("Listing approved"),he(),Y(null)}catch(s){i.error("Failed to approve listing: "+(s.message||"Unknown error"))}finally{J(!1)}},children:"Approve"})]})]})}),a.jsx(x,{open:K,onOpenChange:Q,children:a.jsxs(g,{children:[a.jsxs(p,{children:[a.jsx(u,{children:"Reject Listing?"}),a.jsx(j,{children:"Are you sure you want to reject this listing? The host will be notified and the listing will not be published."})]}),a.jsxs(f,{children:[a.jsx(b,{onClick:()=>Y(null),children:"Cancel"}),a.jsx(v,{onClick:async()=>{if(W)try{await d(W,{status:"rejected"}),i.success("Listing rejected"),he(),Y(null)}catch(e){i.error("Failed to reject listing: "+(e.message||"Unknown error"))}finally{Q(!1)}},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Reject"})]})]})}),a.jsx(N,{open:ae,onOpenChange:le,children:a.jsxs(w,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(y,{children:[a.jsx(k,{className:"text-2xl",children:Z?.title}),a.jsx(C,{children:"Review full listing details and host information"})]}),Z&&a.jsxs("div",{className:"space-y-6",children:[Z.images&&Z.images.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"relative w-full h-[400px] rounded-lg overflow-hidden group bg-muted cursor-pointer",onClick:()=>{me(re),ce(!0)},children:[a.jsx("div",{className:"flex transition-transform duration-500 ease-in-out h-full",style:{transform:`translateX(-${100*re}%)`},children:Z.images.map((e,s)=>a.jsx("div",{className:"min-w-full h-full flex-shrink-0 relative",children:a.jsx("img",{src:e||"/placeholder.svg",alt:`${Z.title} - Image ${s+1}`,className:"w-full h-full object-cover"})},s))}),Z.images.length>1&&a.jsxs(a.Fragment,{children:[a.jsx(t,{variant:"secondary",size:"icon",className:"absolute left-4 top-1/2 -translate-y-1/2 opacity-80 hover:opacity-100 transition-opacity bg-black/70 hover:bg-black/90 text-white border-none z-10 shadow-lg backdrop-blur-sm h-10 w-10",onClick:e=>{e.stopPropagation(),ne(e=>0===e?Z.images.length-1:e-1)},"aria-label":"Previous image",children:a.jsx(L,{className:"h-5 w-5"})}),a.jsx(t,{variant:"secondary",size:"icon",className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-80 hover:opacity-100 transition-opacity bg-black/70 hover:bg-black/90 text-white border-none z-10 shadow-lg backdrop-blur-sm h-10 w-10",onClick:e=>{e.stopPropagation(),ne(e=>e===Z.images.length-1?0:e+1)},"aria-label":"Next image",children:a.jsx(I,{className:"h-5 w-5"})}),a.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white px-3 py-1.5 rounded-full text-xs font-medium backdrop-blur-sm z-10 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx(F,{className:"h-3 w-3 inline mr-1"}),"Click to zoom"]}),a.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/70 text-white px-4 py-1.5 rounded-full text-sm font-medium backdrop-blur-sm z-10",children:[re+1," / ",Z.images.length]})]})]}),Z.images.length>1&&a.jsx("div",{className:"relative",children:a.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-2 snap-x snap-mandatory",children:Z.images.map((e,s)=>a.jsx("button",{onClick:()=>ne(s),className:"relative flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-all snap-start "+(re===s?"border-primary ring-2 ring-primary/50 scale-105":"border-transparent hover:border-border opacity-70 hover:opacity-100"),children:a.jsx("img",{src:e,alt:"Thumbnail "+(s+1),className:"w-full h-full object-cover"})},s))})})]}),a.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[a.jsx(P,{className:"h-5 w-5"}),"Host Information"]}),ie?a.jsx("p",{className:"text-muted-foreground",children:"Loading host information..."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(P,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium",children:"Name:"}),a.jsx("span",{children:ee?.fullName||"N/A"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(R,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium",children:"Email:"}),a.jsx("a",{href:"mailto:"+(ee?.email||""),className:"text-primary hover:underline",children:ee?.email||"N/A"})]})]})]}),a.jsx(z,{}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[a.jsx($,{className:"h-5 w-5"}),"Location"]}),a.jsx("p",{className:"text-muted-foreground",children:Z.location})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),a.jsx("p",{className:"text-muted-foreground whitespace-pre-wrap",children:Z.description})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Price"}),a.jsxs("p",{className:"font-semibold",children:[n(Z.price),"/night"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(E,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Max Guests"}),a.jsx("p",{className:"font-semibold",children:Z.maxGuests})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Bedrooms"}),a.jsx("p",{className:"font-semibold",children:Z.bedrooms||"N/A"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Bathrooms"}),a.jsx("p",{className:"font-semibold",children:void 0!==Z.bathrooms?Z.bathrooms:"N/A"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Category"}),a.jsx(A,{variant:"secondary",children:Z.category})]})]}),Z.amenities&&Z.amenities.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Amenities"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Z.amenities.map((e,s)=>a.jsx(A,{variant:"outline",children:e},s))})]})]}),a.jsx(z,{}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(t,{variant:"outline",onClick:()=>le(!1),children:"Close"}),a.jsx(t,{variant:"destructive",onClick:()=>{le(!1),ge(Z.id)},children:"Reject"}),a.jsx(t,{onClick:()=>{le(!1),xe(Z.id)},children:"Approve"})]})]})]})}),a.jsx(N,{open:oe,onOpenChange:ce,children:a.jsxs(w,{className:"max-w-[98vw] max-h-[98vh] w-auto h-auto p-0 bg-black/95 border-none m-1",children:[a.jsx(k,{className:"sr-only",children:"View Full Size Image"}),a.jsxs(C,{className:"sr-only",children:["Viewing image ",de+1," of ",Z?.images?.length||0," for ",Z?.title]}),a.jsx("div",{className:"relative w-full h-full flex items-center justify-center min-h-[400px]",children:Z?.images&&Z.images.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(t,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-10 sm:w-10",onClick:()=>ce(!1),children:a.jsx(T,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),a.jsxs("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 bg-black/70 text-white px-3 py-1.5 rounded-full text-xs sm:text-sm font-medium backdrop-blur-sm z-50",children:[de+1," / ",Z.images.length]}),a.jsx("div",{className:"w-full h-full flex items-center justify-center p-2 sm:p-4 pt-12 pb-20 sm:pb-24",children:a.jsx("img",{src:Z.images[de]||"/placeholder.svg",alt:`${Z.title} - Image ${de+1}`,className:"max-w-full max-h-[calc(98vh-160px)] object-contain"})}),Z.images.length>1&&a.jsxs(a.Fragment,{children:[a.jsx(t,{variant:"ghost",size:"icon",className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-12 sm:w-12",onClick:()=>me(e=>0===e?Z.images.length-1:e-1),children:a.jsx(L,{className:"h-4 w-4 sm:h-6 sm:w-6"})}),a.jsx(t,{variant:"ghost",size:"icon",className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-12 sm:w-12",onClick:()=>me(e=>e===Z.images.length-1?0:e+1),children:a.jsx(I,{className:"h-4 w-4 sm:h-6 sm:w-6"})})]}),Z.images.length>1&&a.jsx("div",{className:"absolute bottom-2 sm:bottom-4 left-1/2 -translate-x-1/2 bg-black/70 backdrop-blur-sm rounded-lg p-2 sm:p-3 z-50 max-w-[calc(98vw-32px)]",children:a.jsx("div",{className:"flex gap-2 sm:gap-3 overflow-x-auto scrollbar-hide px-1",children:Z.images.map((e,s)=>a.jsx("button",{onClick:()=>me(s),className:"relative flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 rounded transition-all "+(de===s?"scale-110 shadow-lg shadow-primary/50":"opacity-70 hover:opacity-100"),children:a.jsx("div",{className:"absolute inset-0 rounded overflow-hidden border-2 "+(de===s?"border-primary ring-2 ring-primary/50 ring-offset-2 ring-offset-black/70":"border-transparent hover:border-white/50"),children:a.jsx("img",{src:e,alt:"Thumbnail "+(s+1),className:"w-full h-full object-cover transition-opacity "+(de===s?"opacity-100":"opacity-70")})})},s))})})]})})]})})]})};export{G as default};
