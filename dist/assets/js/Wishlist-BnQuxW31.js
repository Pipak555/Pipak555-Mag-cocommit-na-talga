const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-Bl4WVUm9.js","assets/js/react-vendor-BMVo5gto.js","assets/js/utils-vendor-yBsXXcRr.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-Dbp4DHG_.js","assets/js/icons-vendor-BQMxNFbQ.js","assets/js/firebase-vendor-BtzXZj7S.js","assets/index-D7xL4X8S.css"])))=>i.map(i=>d[i]);
import{u as s,j as i,_ as t,v as e,B as a,C as r,a as o,b as n,c as l,d as c,e as d,q as u,t as m}from"./index-Bl4WVUm9.js";import{u as h,r as f,j as g}from"./react-vendor-BMVo5gto.js";import{f as j,e as x}from"./firebase-vendor-BtzXZj7S.js";import{L as p}from"./ListingCard-CV_xDRBJ.js";import{E as v}from"./empty-state-Fqt3Rb73.js";import{A as w,a2 as y}from"./icons-vendor-BQMxNFbQ.js";import"./ui-vendor-Dbp4DHG_.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./badge-_91-i8yA.js";const b=()=>{const b=h(),{user:N,hasRole:L}=s(),[_,k]=f.useState(null),[A,E]=f.useState([]),[S,C]=f.useState([]),[F,P]=f.useState([]),[R,W]=f.useState(!0);f.useEffect(()=>{!N||L("guest")?N?B():W(!1):b("/guest/login")},[N,b]),f.useEffect(()=>{N&&_&&(I(),D())},[N,_]);const B=async()=>{if(N)try{const s=await j(x(i,"users",N.uid));if(s.exists()){const i=s.data();k(i),C(i.favorites||[]),P(i.wishlist||[])}}catch(s){}finally{W(!1)}},D=async()=>{if(N)try{const s=await j(x(i,"users",N.uid));if(s.exists()){const i=s.data();C(i.favorites||[])}}catch(s){}},I=async()=>{if(N&&_?.wishlist?.length)try{const{getListing:s}=await t(async()=>{const{getListing:s}=await import("./index-Bl4WVUm9.js").then(s=>s.T);return{getListing:s}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),i=await Promise.all(_.wishlist.map(i=>s(i)));E(i.filter(s=>null!==s))}catch(s){E([])}else E([])};return R?g.jsx(e,{}):g.jsx("div",{className:"min-h-screen bg-background",children:g.jsxs("div",{className:"container mx-auto px-4 py-8",children:[g.jsx("div",{className:"flex items-center justify-between mb-6",children:g.jsxs(a,{variant:"ghost",onClick:()=>b("/guest/dashboard"),className:"flex items-center gap-2",children:[g.jsx(w,{className:"h-4 w-4"}),"Back to Dashboard"]})}),g.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Your Wishlist"}),g.jsxs(r,{children:[g.jsxs(o,{children:[g.jsx(n,{children:"Your Wishlist"}),g.jsx(l,{children:"Listings you're planning to book in the future"})]}),g.jsx(c,{children:0===A.length?g.jsx(v,{icon:g.jsx(y,{className:"h-10 w-10"}),title:"No wishlist items yet",description:"Add listings to your wishlist for future trips!",action:g.jsx(a,{onClick:()=>b("/guest/browse"),children:"Browse Listings"})}):g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(s=>g.jsx(p,{listing:s,onView:()=>b("/guest/listing/"+s.id),onFavorite:()=>(async s=>{if(N)try{const i=await m(N.uid,s,S);C(i),k(s=>s?{...s,favorites:i}:null),d.success(i.includes(s)?"Added to favorites":"Removed from favorites")}catch(i){d.error("Failed to update favorites")}else d.error("Please login to manage favorites")})(s.id),onWishlist:()=>(async s=>{if(N)try{const i=await u(N.uid,s,F);P(i),k(s=>s?{...s,wishlist:i}:null),I(),d.success(i.includes(s)?"Added to wishlist":"Removed from wishlist")}catch(i){d.error("Failed to update wishlist")}else d.error("Please login to manage wishlist")})(s.id),isFavorite:S.includes(s.id),isInWishlist:F.includes(s.id)},s.id))})})]})]})})};export{b as default};
