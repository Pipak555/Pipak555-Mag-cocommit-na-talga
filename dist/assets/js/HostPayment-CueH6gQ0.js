import{u as e,i as s,l as t,r as a,j as r}from"./react-vendor-BMVo5gto.js";import{u as l,e as i,C as n,d as c,B as d,a as m,b as o,i as x}from"./index-Bl4WVUm9.js";import{P as h}from"./PayPalButton-BeJKL0tB.js";import{getPlanById as u,getUserSubscription as j}from"./billingService-iurdcjpD.js";import{L as p,e as f,A as g,H as N,X as y,i as b}from"./icons-vendor-BQMxNFbQ.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-Dbp4DHG_.js";import"./firebase-vendor-BtzXZj7S.js";const v=()=>{const v=e(),w=s(),[P]=t(),{user:C}=l(),[k,S]=a.useState(null),[I,Y]=a.useState(!0),[$,A]=a.useState(!1),[B,D]=a.useState(!0),R=P.get("planId")||"active-host-monthly",E="/host/payment/success"===w.pathname;return a.useEffect(()=>{if(!C)return i.error("Please sign in to continue"),void v("/host/login");const e=u(R);if(!e)return i.error("Invalid plan selected"),void v("/host/register");S(e),(async()=>{try{const e=await j(C.uid);if(e&&"active"===e.status&&e.planId===R&&(A(!0),!E))return void v("/host/payment/success?planId="+R,{replace:!0})}catch(e){}finally{D(!1),Y(!1)}})()},[R,C,v,E]),I||B||!k?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(p,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),r.jsx("p",{className:"mt-4 text-muted-foreground",children:B?"Checking payment status...":"Loading payment page..."})]})}):$?r.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:r.jsx(n,{className:"max-w-2xl w-full",children:r.jsxs(c,{className:"p-8 text-center",children:[r.jsx("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:r.jsx(f,{className:"h-12 w-12 text-green-600 dark:text-green-400"})}),r.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Payment Already Completed"}),r.jsx("p",{className:"text-muted-foreground mb-8",children:"Your subscription is already active. Redirecting to dashboard..."}),r.jsx(d,{onClick:()=>v("/host/dashboard"),children:"Go to Dashboard"})]})})}):r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs(d,{variant:"ghost",onClick:()=>v("/host/register"),className:"gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"Back to Registration"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(d,{variant:"ghost",onClick:()=>v("/host/dashboard"),className:"gap-2",children:[r.jsx(N,{className:"h-4 w-4"}),"Dashboard"]}),r.jsxs(d,{variant:"ghost",onClick:()=>{window.confirm("Are you sure you want to exit? Your payment progress will not be saved.")&&v("/host/settings")},className:"gap-2 text-muted-foreground hover:text-destructive",children:[r.jsx(y,{className:"h-4 w-4"}),"Exit"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsx("div",{className:"lg:col-span-1",children:r.jsxs(n,{children:[r.jsx(m,{children:r.jsx(o,{className:"text-lg",children:"Registration Progress"})}),r.jsxs(c,{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"mt-1",children:r.jsx("div",{className:"w-6 h-6 rounded-full bg-primary flex items-center justify-center",children:r.jsx(f,{className:"h-4 w-4 text-primary-foreground"})})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium",children:"1. Choose Plan"}),r.jsx("div",{className:"text-sm text-muted-foreground",children:"Select your hosting package."})]})]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"mt-1",children:r.jsx("div",{className:"w-6 h-6 rounded-full bg-primary flex items-center justify-center",children:r.jsx(f,{className:"h-4 w-4 text-primary-foreground"})})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium",children:"2. Create Account"}),r.jsx("div",{className:"text-sm text-muted-foreground",children:"Set up your host profile."})]})]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"mt-1",children:r.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center "+($?"bg-green-600":"bg-primary"),children:$?r.jsx(f,{className:"h-4 w-4 text-white"}):r.jsx(b,{className:"h-4 w-4 text-primary-foreground"})})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium",children:"3. Payment"}),r.jsx("div",{className:"text-sm text-muted-foreground",children:$?"Payment completed!":"Complete your payment."})]})]}),r.jsxs("div",{className:"pt-4",children:[r.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Progress"}),r.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:r.jsx("div",{className:"h-2 rounded-full transition-all "+($?"bg-green-600":"bg-primary"),style:{width:$?"100%":"66%"}})}),r.jsx("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:$?"100%":"66%"})]})]})]})}),r.jsx("div",{className:"lg:col-span-2",children:r.jsx(n,{children:r.jsxs(c,{className:"p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center mx-auto mb-4",children:r.jsx(b,{className:"h-8 w-8 text-primary"})}),r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Complete Payment"}),r.jsx("p",{className:"text-muted-foreground",children:"You'll be redirected to PayPal to complete your payment."})]}),r.jsxs("div",{className:"mb-8",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Order Summary"}),r.jsxs("div",{className:"space-y-3 border rounded-lg p-4",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Plan:"}),r.jsx("span",{className:"font-medium",children:k.name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Billing:"}),r.jsx("span",{className:"font-medium capitalize",children:k.billingCycle})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Amount:"}),r.jsx("span",{className:"font-medium",children:x(k.price)})]}),r.jsx("div",{className:"border-t pt-3 mt-3",children:r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-semibold",children:"Total Due:"}),r.jsx("span",{className:"font-bold text-primary text-lg",children:x(k.price)})]})})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"border-2 border-primary rounded-lg p-6 bg-primary/5",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-1",children:"PayPal Checkout"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Secure payment with PayPal."})]}),r.jsx("div",{className:"w-6 h-6 rounded-full bg-muted flex items-center justify-center",children:r.jsx(b,{className:"h-4 w-4 text-muted-foreground"})})]}),r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Click the button below to complete your payment. You'll be redirected to PayPal to securely complete the transaction."}),r.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3 mb-4",children:r.jsxs("p",{className:"text-xs text-yellow-800 dark:text-yellow-200",children:[r.jsx("strong",{children:"Note:"})," You don't need to link your PayPal account beforehand. You'll log in to PayPal during checkout."]})}),C&&r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("span",{className:"text-sm font-medium",children:"Pay with PayPal"}),r.jsx("span",{className:"text-lg font-bold text-primary",children:x(k.price)})]}),r.jsx(h,{amount:k.price,userId:C.uid,description:`Host subscription: ${k.name} (${k.billingCycle}) - planId=${k.id}`,onSuccess:async()=>{if(C&&k)try{A(!0),setTimeout(()=>{v("/host/payment/success?planId="+k.id,{replace:!0})},500)}catch(e){i.error("Payment processed but there was an error activating your subscription. Please contact support.")}},redirectUrl:`${window.location.origin}/host/payment/success?planId=${k.id}&userId=${C.uid}`}),r.jsx("div",{className:"mt-4 text-center",children:r.jsxs(d,{variant:"outline",className:"w-full",onClick:()=>{i.info("Credit card payment coming soon")},children:[r.jsx(b,{className:"h-4 w-4 mr-2"}),"Debit or Credit Card"]})})]})})]}),r.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Powered by PayPal"}),!1]})]})})})]})]})})};export{v as default};
