const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-BnushFQy.js","assets/js/react-vendor-Ve3SFwKO.js","assets/js/utils-vendor-DzY7Ay74.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-D9RGQy8n.js","assets/js/icons-vendor-DD8ZfUKZ.js","assets/js/firebase-vendor-BC71bXmb.js","assets/index-CZT-s-DH.css"])))=>i.map(i=>d[i]);
import{u as e,j as s,_ as t,v as i,C as r,b as a,c as o,d as n,e as d,a as l,t as c}from"./index-BnushFQy.js";import{u as m,r as u,j as p}from"./react-vendor-Ve3SFwKO.js";import{h as x,f as j}from"./firebase-vendor-BC71bXmb.js";import{L as h}from"./ListingCard-D6Td60Vf.js";import{E as b}from"./empty-state-BDfunuWx.js";import{B as f}from"./BackButton-DohCcac0.js";import{q as g}from"./icons-vendor-DD8ZfUKZ.js";import"./ui-vendor-D9RGQy8n.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./badge-CYghlWc2.js";const y=()=>{const y=m(),{user:v,hasRole:N}=e(),[R,q]=u.useState(null),[w,k]=u.useState([]),[A,L]=u.useState([]),[B,_]=u.useState([]),[E,S]=u.useState(!0);u.useEffect(()=>{!v||N("guest")?v?I():S(!1):y("/guest/login")},[v,y]),u.useEffect(()=>{v&&R&&(P(),F())},[v,R]);const I=async()=>{if(v)try{const e=await x(j(s,"users",v.uid));if(e.exists()){const s=e.data();q(s),L(s.favorites||[]),_(s.wishlist||[])}}catch(e){}finally{S(!1)}},F=async()=>{if(v)try{const e=await x(j(s,"users",v.uid));if(e.exists()){const s=e.data();L(s.favorites||[])}}catch(e){}},P=async()=>{if(v&&R?.wishlist?.length)try{const{getListing:e}=await t(async()=>{const{getListing:e}=await import("./index-BnushFQy.js").then(e=>e.W);return{getListing:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),s=R.wishlist.map(e=>"string"==typeof e?e:e.listingId),i=await Promise.all(s.map(s=>e(s)));k(i.filter(e=>null!==e))}catch(e){k([])}else k([])};return E?p.jsx(i,{}):p.jsx("div",{className:"min-h-screen bg-background",children:p.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p.jsx(f,{to:"/guest/dashboard",className:"mb-4 sm:mb-6"}),p.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Your Wishlist"}),p.jsxs(r,{children:[p.jsxs(a,{children:[p.jsx(o,{children:"Your Wishlist"}),p.jsx(n,{children:"Listings you're planning to book in the future"})]}),p.jsx(d,{children:0===w.length?p.jsx(b,{icon:p.jsx(g,{className:"h-10 w-10"}),title:"No wishlist items yet",description:"Add listings to your wishlist for future trips!"}):p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(e=>{const s=B.find(s=>"string"==typeof s?s===e.id:s.listingId===e.id),t="object"==typeof s&&s?.recommendations;return B.some(s=>"string"==typeof s?s===e.id:s.listingId===e.id),p.jsxs("div",{className:"space-y-2",children:[p.jsx(h,{listing:e,onView:()=>y("/guest/listing/"+e.id),onFavorite:()=>(async e=>{if(v)try{const s=await c(v.uid,e,A);L(s),q(e=>e?{...e,favorites:s}:null),l.success(s.includes(e)?"Added to favorites":"Removed from favorites")}catch(s){l.error("Failed to update favorites")}else l.error("Please login to manage favorites")})(e.id),isFavorite:A.includes(e.id)}),(t||"object"==typeof s&&s?.propertyRequirements||"object"==typeof s&&s?.desiredAmenities)&&p.jsx(r,{className:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800",children:p.jsxs(d,{className:"p-3 space-y-2",children:["object"==typeof s&&s?.propertyRequirements&&Object.keys(s.propertyRequirements).length>0&&p.jsxs("div",{children:[p.jsx("p",{className:"text-xs font-semibold text-blue-900 dark:text-blue-100 mb-1",children:"Requirements:"}),p.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1",children:[s.propertyRequirements.beds&&p.jsxs("p",{children:["• Beds: ",s.propertyRequirements.beds]}),s.propertyRequirements.bedrooms&&p.jsxs("p",{children:["• Bedrooms: ",s.propertyRequirements.bedrooms]}),s.propertyRequirements.bathrooms&&p.jsxs("p",{children:["• Bathrooms: ",s.propertyRequirements.bathrooms]}),s.propertyRequirements.guests&&p.jsxs("p",{children:["• Guests: ",s.propertyRequirements.guests]})]})]}),"object"==typeof s&&s?.desiredAmenities&&s.desiredAmenities.length>0&&p.jsxs("div",{children:[p.jsx("p",{className:"text-xs font-semibold text-blue-900 dark:text-blue-100 mb-1",children:"Desired Amenities:"}),p.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:s.desiredAmenities.join(", ")})]}),t&&p.jsxs("div",{children:[p.jsx("p",{className:"text-xs font-semibold text-blue-900 dark:text-blue-100 mb-1",children:"Recommendations:"}),p.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:t})]})]})})]},e.id)})})})]})]})})};export{y as default};
