const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-BbvEjZj9.js","assets/js/react-vendor-DAkY0NgE.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/utils-vendor-yBsXXcRr.js","assets/js/ui-vendor-CZx_xpmK.js","assets/js/icons-vendor-3zhgXMYa.js","assets/js/firebase-vendor-CvoiOdvz.js","assets/index-CLiUbsBH.css"])))=>i.map(i=>d[i]);
import{u as e,j as s,h as t,k as a,L as r,B as i,C as o,a as l,b as n,d as c,i as d,c as m,e as h,_ as x,t as g}from"./index-BbvEjZj9.js";import{u,r as p,j}from"./react-vendor-DAkY0NgE.js";import{N as v}from"./NotificationBell-zOtcMnYS.js";import{h as f,C as b,a as w,e as N,s as y}from"./category-service-C4UnKIWM.js";import{V as k}from"./video-background-ClFV52Pv.js";import{T as C}from"./theme-toggle-C3pYvPx7.js";import{L as B}from"./ListingCard-YDL4intN.js";import{getRecommendations as S}from"./recommendations-DD8Y0n2s.js";import{k as R,e as W,f as A}from"./firebase-vendor-CvoiOdvz.js";import{A as F,a as I,b as P,c as z,d as D,e as O,f as T,g as E}from"./alert-dialog-D9Kc0D1X.js";import{n as _,B as L,H as V,b as G,W as Y,o as H,p as q,i as M,q as U,m as Q}from"./icons-vendor-3zhgXMYa.js";import"./ui-vendor-CZx_xpmK.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./scroll-area-DiLI9L8b.js";import"./badge-Bdu_tSqo.js";import"./dropdown-menu-BRbzCJvi.js";const J=()=>{const{user:J,userRole:K,userProfile:X,signOut:Z,hasRole:$,addRole:ee}=e(),se=u(),[te,ae]=p.useState({favorites:0,wishlist:0,upcomingTrips:0,pastBookings:0,walletBalance:0}),[re,ie]=p.useState([]),[oe,le]=p.useState([]),[ne,ce]=p.useState(!0),[de,me]=p.useState(!1);p.useEffect(()=>{if(!J||!$("guest"))return void se("/guest/login");he();const e=R(W(s,"users",J.uid),e=>{if(e.exists()){const s=e.data();ae(e=>({...e,favorites:s.favorites?.length||0,wishlist:s.wishlist?.length||0,walletBalance:s.walletBalance||0})),le(s.favorites||[])}});return()=>{e()}},[J,K,se]);const he=async()=>{if(J){ce(!0);try{const e=await t({guestId:J.uid}),s=new Date,r=e.filter(e=>new Date(e.checkIn)>=s&&"confirmed"===e.status).length,i=e.filter(e=>{const t=new Date(e.checkOut);return s>t||"completed"===e.status}).length;ae(e=>({...e,upcomingTrips:r,pastBookings:i}));const o=await S(J.uid,6);if(o.length>0){const e=o.map(e=>e.id),s=await a(e),t=o.map(e=>{const t=s.get(e.id);return{...e,averageRating:t?.averageRating||0,reviewCount:t?.reviewCount||0}});ie(t)}else ie(o)}catch(e){}finally{ce(!1)}}},xe=async()=>{$("host")?se("/host/dashboard"):se("/host/policies")};return j.jsxs("div",{className:"min-h-screen bg-background",children:[j.jsx("header",{className:"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 shadow-soft",children:j.jsxs("div",{className:"container mx-auto px-6 py-4 flex justify-between items-center",children:[j.jsxs("div",{className:"flex items-center gap-3",children:[j.jsx(r,{size:"sm"}),j.jsx("div",{className:"p-2 rounded-lg bg-secondary/10",children:j.jsx(_,{className:"w-5 h-5 text-secondary"})}),j.jsxs("div",{children:[j.jsxs("h1",{className:"text-lg font-bold",children:["Welcome, ",X?.fullName||"Guest","!"]}),j.jsx("p",{className:"text-xs text-muted-foreground",children:"Discover your next adventure"})]})]}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(v,{}),j.jsx(C,{}),j.jsx(i,{variant:"outline",onClick:()=>me(!0),children:"Sign Out"})]})]})}),j.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[j.jsxs("div",{className:"relative mb-8 rounded-xl overflow-hidden h-64 md:h-80 lg:h-96 shadow-lg",children:[j.jsx(k,{src:"/videos/landing-hero.mp4",overlay:!0,fallbackImage:f}),j.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/60 via-black/40 to-black/60 z-10"}),j.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent z-10"}),j.jsxs("div",{className:"relative z-20 h-full flex flex-col items-center justify-center text-center px-6",children:[j.jsx("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold mb-4 text-white drop-shadow-2xl",children:"Discover Your Next Adventure"}),j.jsxs("p",{className:"text-lg md:text-xl text-white/90 mb-6 max-w-2xl drop-shadow-lg",children:["Welcome back, ",X?.fullName||"Guest","! Ready to explore amazing places?"]}),j.jsx(i,{size:"lg",className:"h-12 px-8 text-lg bg-primary hover:bg-primary/90 shadow-2xl hover:shadow-2xl hover:scale-105 transition-all",onClick:()=>se("/guest/browse"),children:"Browse All Listings"})]})]}),j.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8 "+($("host")?"lg:grid-cols-5":"lg:grid-cols-6"),children:[j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group",children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary via-secondary to-accent"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Favorites"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-primary to-primary-glow bg-clip-text text-transparent",children:te.favorites})})]}),j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group",children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 via-blue-400 to-blue-300"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Wishlist"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-blue-500 to-blue-600 bg-clip-text text-transparent",children:te.wishlist})})]}),j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>se("/guest/bookings?filter=upcoming"),children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-primary to-accent"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Upcoming Trips"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-secondary to-secondary/80 bg-clip-text text-transparent",children:te.upcomingTrips})})]}),j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>se("/guest/bookings?filter=past"),children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-accent via-primary to-secondary"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Past Bookings"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold",children:te.pastBookings})})]}),j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group",children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-accent via-green-500 to-green-600"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Wallet Balance"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold text-accent",children:d(te.walletBalance)})})]}),!$("host")&&j.jsxs(o,{className:"relative overflow-hidden border-2 border-secondary/30 shadow-lg hover:shadow-xl transition-all duration-300 group cursor-pointer bg-gradient-to-br from-secondary/5 to-secondary/10",onClick:xe,children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-secondary/80 to-secondary/60"}),j.jsx(l,{className:"pb-3",children:j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(L,{className:"w-5 h-5 text-secondary"}),j.jsx(n,{className:"text-sm font-medium text-secondary uppercase tracking-wide",children:"Become a Host"})]})}),j.jsxs(c,{children:[j.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Start earning by hosting your property"}),j.jsx(i,{variant:"secondary",className:"w-full",onClick:e=>{e.stopPropagation(),xe()},children:"Get Started"})]})]})]}),j.jsxs("div",{className:"mb-8",children:[j.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Browse Categories"}),j.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[j.jsx(b,{videoSrc:"/videos/category-home.mp4",fallbackImage:w,icon:V,title:"Homes",description:"Find your perfect stay",href:"/guest/browse?category=home",colorClass:"primary"}),j.jsx(b,{videoSrc:"/videos/category-experience.mp4",fallbackImage:N,icon:G,title:"Experiences",description:"Discover unique activities",href:"/guest/browse?category=experience",colorClass:"secondary"}),j.jsx(b,{videoSrc:"/videos/category-service.mp4",fallbackImage:y,icon:Y,title:"Services",description:"Professional assistance",href:"/guest/browse?category=service",colorClass:"accent"})]})]}),re.length>0&&j.jsxs("div",{className:"mb-8",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(H,{className:"w-6 h-6 text-primary"}),j.jsx("h3",{className:"text-2xl font-bold",children:"Recommended for You"})]}),j.jsx(i,{variant:"outline",onClick:()=>se("/guest/browse"),children:"View All"})]}),j.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 items-stretch",children:re.slice(0,3).map(e=>j.jsx(B,{listing:e,onView:()=>se("/guest/listing/"+e.id),onFavorite:()=>(async e=>{if(J)try{const s=await g(J.uid,e,oe);le(s),h.success(s.includes(e)?"Added to favorites":"Removed from favorites")}catch(s){h.error("Failed to update favorites")}else h.error("Please login to add favorites")})(e.id),onWishlist:()=>(async e=>{if(J)try{const{toggleWishlist:t}=await x(async()=>{const{toggleWishlist:e}=await import("./index-BbvEjZj9.js").then(e=>e.R);return{toggleWishlist:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),a=await A(W(s,"users",J.uid)),r=a.exists()&&a.data().wishlist||[],i=await t(J.uid,e,r);h.success(i.includes(e)?"Added to wishlist":"Removed from wishlist")}catch(t){h.error("Failed to update wishlist")}else h.error("Please login to add to wishlist")})(e.id),isFavorite:oe.includes(e.id)},e.id))})]}),j.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>se("/guest/settings?tab=favorites"),children:j.jsxs(l,{children:[j.jsx(q,{className:"w-8 h-8 text-primary mb-2"}),j.jsx(n,{children:"Favorites"}),j.jsx(m,{children:"Your saved listings"})]})}),j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>se("/guest/bookings"),children:j.jsxs(l,{children:[j.jsx(M,{className:"w-8 h-8 text-secondary mb-2"}),j.jsx(n,{children:"My Bookings"}),j.jsx(m,{children:"View your trips"})]})}),j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>se("/guest/wallet"),children:j.jsxs(l,{children:[j.jsx(U,{className:"w-8 h-8 text-accent mb-2"}),j.jsx(n,{children:"E-Wallet"}),j.jsx(m,{children:"Manage your balance"})]})}),j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>se("/guest/settings"),children:j.jsxs(l,{children:[j.jsx(Q,{className:"w-8 h-8 text-muted-foreground mb-2"}),j.jsx(n,{children:"Settings"}),j.jsx(m,{children:"Account preferences"})]})})]})]}),j.jsx(F,{open:de,onOpenChange:me,children:j.jsxs(I,{children:[j.jsxs(P,{children:[j.jsx(z,{children:"Sign Out"}),j.jsx(D,{children:"Are you sure you want to sign out? You'll need to sign in again to access your account."})]}),j.jsxs(O,{children:[j.jsx(T,{children:"Cancel"}),j.jsx(E,{onClick:async()=>{await Z(),se("/")},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sign Out"})]})]})})]})};export{J as default};
