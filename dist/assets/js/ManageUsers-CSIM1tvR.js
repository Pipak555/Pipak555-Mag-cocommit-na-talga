import{r as e,j as s,u as a}from"./react-vendor-DAkY0NgE.js";import{g as r,u as t,j as l,e as d,B as o,C as i,d as n,i as c}from"./index-BbvEjZj9.js";import{d as m,c as x}from"./firebase-vendor-CvoiOdvz.js";import{B as h}from"./badge-Bdu_tSqo.js";import{A as j,L as f,C as u}from"./icons-vendor-3zhgXMYa.js";import"./maps-vendor-CYGXCXz5.js";import"./utils-vendor-yBsXXcRr.js";import"./ui-vendor-CZx_xpmK.js";const N=e.forwardRef(({className:e,...a},t)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:t,className:r("w-full caption-bottom text-sm",e),...a})}));N.displayName="Table";const b=e.forwardRef(({className:e,...a},t)=>s.jsx("thead",{ref:t,className:r("[&_tr]:border-b",e),...a}));b.displayName="TableHeader";const p=e.forwardRef(({className:e,...a},t)=>s.jsx("tbody",{ref:t,className:r("[&_tr:last-child]:border-0",e),...a}));p.displayName="TableBody",e.forwardRef(({className:e,...a},t)=>s.jsx("tfoot",{ref:t,className:r("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...a})).displayName="TableFooter";const g=e.forwardRef(({className:e,...a},t)=>s.jsx("tr",{ref:t,className:r("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...a}));g.displayName="TableRow";const y=e.forwardRef(({className:e,...a},t)=>s.jsx("th",{ref:t,className:r("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...a}));y.displayName="TableHead";const w=e.forwardRef(({className:e,...a},t)=>s.jsx("td",{ref:t,className:r("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...a}));w.displayName="TableCell",e.forwardRef(({className:e,...a},t)=>s.jsx("caption",{ref:t,className:r("mt-4 text-sm text-muted-foreground",e),...a})).displayName="TableCaption";const v=()=>{const r=a(),{user:v,userRole:R}=t(),[k,T]=e.useState([]),[B,C]=e.useState(!0),[A,F]=e.useState(null);e.useEffect(()=>{v&&"admin"===R?P():r("/admin/login")},[v,R,r]);const P=async()=>{C(!0),F(null);try{const e=(await m(x(l,"users"))).docs.map(e=>({id:e.id,...e.data()}));T(e),0===e.length&&F("No users found in the database.")}catch(e){const s="permission-denied"===e.code?"Permission denied. Please check that your admin role is set correctly in Firestore.":e.message||"Failed to load users. Please check the console for details.";F(s),d.error(s)}finally{C(!1)}};return s.jsx("div",{className:"min-h-screen bg-background p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs(o,{variant:"ghost",onClick:()=>r("/admin/dashboard"),className:"mb-6",children:[s.jsx(j,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),s.jsx("h1",{className:"text-3xl font-bold mb-6",children:"User Management"}),B?s.jsx(i,{children:s.jsxs(n,{className:"py-12 text-center",children:[s.jsx(f,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-primary"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading users..."})]})}):A?s.jsx(i,{children:s.jsxs(n,{className:"py-12 text-center",children:[s.jsx(u,{className:"h-12 w-12 mx-auto mb-4 text-destructive"}),s.jsx("p",{className:"text-destructive font-medium mb-2",children:A}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:'Make sure your admin user has the role field set to "admin" in Firestore.'}),s.jsx(o,{onClick:P,variant:"outline",children:"Retry"})]})}):0===k.length?s.jsx(i,{children:s.jsx(n,{className:"py-12 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"No users found in the database."})})}):s.jsx(i,{children:s.jsxs(N,{children:[s.jsx(b,{children:s.jsxs(g,{children:[s.jsx(y,{children:"Full Name"}),s.jsx(y,{children:"Email"}),s.jsx(y,{children:"Role"}),s.jsx(y,{children:"Points"}),s.jsx(y,{children:"Wallet Balance"}),s.jsx(y,{children:"Joined"})]})}),s.jsx(p,{children:k.map(e=>s.jsxs(g,{children:[s.jsx(w,{className:"font-medium",children:e.fullName||"N/A"}),s.jsx(w,{children:e.email}),s.jsx(w,{children:s.jsx(h,{variant:"admin"===e.role?"default":"secondary",children:e.role})}),s.jsx(w,{children:e.points||0}),s.jsx(w,{children:c(e.walletBalance||0)}),s.jsx(w,{children:e.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A"})]},e.id))})]})})]})})};export{v as default};
