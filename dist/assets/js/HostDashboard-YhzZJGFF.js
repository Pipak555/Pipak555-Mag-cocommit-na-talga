import{u as e,r as s,j as t}from"./react-vendor-BMVo5gto.js";import{u as a,h as r,L as i,B as o,C as n,d as c,i as l,a as d,b as m,e as h,c as x,j as g}from"./index-BbQqfVom.js";import{N as u}from"./NotificationBell-DC2MErt-.js";import{hasActiveSubscription as p,getUserSubscription as j}from"./billingService-BpXNrE61.js";import{B as b}from"./badge-0vFpitRp.js";import{V as f}from"./video-background-0x67CGr6.js";import{T as v}from"./theme-toggle-DFp1ra6v.js";import{k as w,q as N,w as k,c as y}from"./firebase-vendor-BtzXZj7S.js";import{h as C}from"./hero-home-D5ap7Mum.js";import{A as D,a as S,b as T,c as I,d as L,e as O,f as B,g as H}from"./alert-dialog-Biqv9se3.js";import{H as z,C as E,i as q,P as A,j as M,k as P,l as V,m as R,n as Y}from"./icons-vendor-D1YpcxsO.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-Dbp4DHG_.js";import"./scroll-area-BZ9Ss1y2.js";import"./dropdown-menu-DES5sCK6.js";const $=()=>{const{user:r}=a(),[i,o]=s.useState([]),h=e();return s.useEffect(()=>{if(!r)return;const e=new Date;e.setHours(0,0,0,0);const s=new Date(e);s.setDate(s.getDate()+1);const t=w(N(y(g,"bookings"),k("hostId","==",r.uid)),s=>{const t=s.docs.map(e=>({id:e.id,...e.data()})).filter(s=>{const t=new Date(s.checkIn);t.setHours(0,0,0,0);const a=new Date(s.checkOut);return a.setHours(0,0,0,0),!(t.getTime()!==e.getTime()&&a.getTime()!==e.getTime()||"confirmed"!==s.status&&"pending"!==s.status)}).sort((e,s)=>new Date(e.checkIn).getTime()-new Date(s.checkIn).getTime());o(t)});return()=>t()},[r]),t.jsxs(n,{className:"shadow-medium",children:[t.jsxs(d,{children:[t.jsx(m,{children:"Today's Schedule"}),t.jsx(x,{children:i.length>0?`${i.length} booking${i.length>1?"s":""} today`:"No bookings scheduled for today"})]}),t.jsx(c,{children:0===i.length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(M,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"You're all set! No check-ins or check-outs today."})]}):t.jsx("div",{className:"space-y-3",children:i.map(e=>{const s=new Date(e.checkIn),a=new Date(e.checkOut),r=s.toDateString()===(new Date).toDateString(),i=a.toDateString()===(new Date).toDateString();return t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>h("/host/bookings"),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:r&&i?"Check-in & Check-out":r?"Check-in":"Check-out"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.toLocaleDateString()," - ",a.toLocaleDateString()]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.guests," guest",e.guests>1?"s":""," â€¢ ",l(e.totalPrice||0)]})]}),t.jsx(b,{children:e.status})]})},e.id)})})})]})},W=()=>{const{user:W,userRole:Q,userProfile:U,signOut:_,hasRole:F}=a(),G=e(),[J,K]=s.useState({activeListings:0,upcomingBookings:0,totalEarnings:0}),[X,Z]=s.useState(!1),[ee,se]=s.useState(null),[te,ae]=s.useState(null);s.useEffect(()=>{if(!W||!F("host"))return void G("/host/login");(async()=>{try{const e=await p(W.uid);if(se(e),e){const e=await j(W.uid);ae(e)}}catch(e){se(!1)}})(),re();const e=w(N(y(g,"listing"),k("hostId","==",W.uid)),e=>{const s=e.docs.filter(e=>"approved"===e.data().status).length;K(e=>({...e,activeListings:s}))}),s=w(N(y(g,"bookings"),k("hostId","==",W.uid)),e=>{const s=new Date,t=e.docs.filter(e=>{const t=e.data();return new Date(t.checkIn)>=s&&"confirmed"===t.status}).length,a=e.docs.filter(e=>"confirmed"===e.data().status||"completed"===e.data().status).reduce((e,s)=>e+(s.data().totalPrice||0),0);K(e=>({...e,upcomingBookings:t,totalEarnings:a}))});return()=>{e(),s()}},[W,Q,G]);const re=async()=>{if(W)try{const e=await r({hostId:W.uid}),s=new Date;s.setHours(0,0,0,0),e.filter(e=>{const t=new Date(e.checkIn);return t.setHours(0,0,0,0),t.getTime()===s.getTime()})}catch(e){}};return t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx("header",{className:"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 shadow-soft",children:t.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center gap-2 sm:gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[t.jsx(i,{size:"sm"}),t.jsx("div",{className:"hidden sm:block p-2 rounded-lg bg-primary/10",children:t.jsx(z,{className:"w-5 h-5 text-primary"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("h1",{className:"text-base sm:text-lg font-bold truncate",children:["Welcome, ",U?.fullName||"Host","!"]}),t.jsx("p",{className:"text-xs text-muted-foreground hidden sm:block",children:"Manage your properties"})]})]}),t.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0",children:[t.jsx(u,{}),t.jsx(v,{}),t.jsxs(o,{variant:"outline",onClick:()=>Z(!0),className:"h-9 sm:h-auto text-xs sm:text-sm px-2 sm:px-4 touch-manipulation",children:[t.jsx("span",{className:"hidden sm:inline",children:"Sign Out"}),t.jsx("span",{className:"sm:hidden",children:"Out"})]})]})]})}),t.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[!1===ee&&t.jsx(n,{className:"mb-6 border-yellow-500/50 bg-yellow-500/10",children:t.jsx(c,{className:"pt-6",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(E,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold mb-1",children:"Subscription Required"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"You need an active subscription to create and manage listings. Subscribe now to unlock all features."}),t.jsxs(o,{size:"sm",onClick:()=>G("/host/register"),children:[t.jsx(q,{className:"h-4 w-4 mr-2"}),"Subscribe Now"]})]})]})})}),!0===ee&&te&&t.jsx(n,{className:"mb-6 border-green-500/50 bg-green-500/10",children:t.jsx(c,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(q,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Active Subscription"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[te.planName," (",te.billingCycle,") - ",l(te.amount),"/",te.billingCycle]}),te.endDate&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Expires: ",new Date(te.endDate).toLocaleDateString()]})]})]}),t.jsx(b,{variant:"outline",className:"bg-green-500/10 text-green-600 dark:text-green-400 border-green-500/50",children:"Active"})]})})}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 md:gap-6 mb-6 sm:mb-8",children:[t.jsxs(n,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer hover:scale-105 active:scale-100",onClick:()=>G("/host/listings"),children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary via-secondary to-accent"}),t.jsx(d,{className:"pb-3",children:t.jsx(m,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Active Listings"})}),t.jsx(c,{children:t.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-primary to-primary-glow bg-clip-text text-transparent",children:J.activeListings})})]}),t.jsxs(n,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer hover:scale-105 active:scale-100",onClick:()=>G("/host/bookings"),children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 via-blue-400 to-blue-300"}),t.jsx(d,{className:"pb-3",children:t.jsx(m,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Upcoming Bookings"})}),t.jsx(c,{children:t.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-blue-500 to-blue-600 bg-clip-text text-transparent",children:J.upcomingBookings})})]}),t.jsxs(n,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>G("/host/payments"),children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-primary to-accent"}),t.jsx(d,{className:"pb-3",children:t.jsx(m,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Total Earnings"})}),t.jsx(c,{children:t.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-secondary to-secondary/80 bg-clip-text text-transparent",children:l(J.totalEarnings)})})]})]}),t.jsxs("div",{className:"relative mb-8 rounded-xl overflow-hidden h-64 md:h-80 lg:h-96 shadow-lg",children:[t.jsx(f,{src:"/videos/landing-hero.mp4",overlay:!0,fallbackImage:C}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/60 via-black/40 to-black/60 z-10"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent z-10"}),t.jsxs("div",{className:"relative z-20 h-full flex flex-col items-center justify-center text-center px-6",children:[t.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold mb-4 text-white drop-shadow-2xl",children:["Welcome back, ",U?.fullName||"Host","!"]}),t.jsx("p",{className:"text-lg md:text-xl text-white/90 mb-6 max-w-2xl drop-shadow-lg",children:"Manage your properties and track your performance"}),t.jsx(o,{size:"lg",className:"h-12 px-8 text-lg bg-primary hover:bg-primary/90 shadow-2xl hover:shadow-2xl hover:scale-105 transition-all",onClick:()=>{ee?G("/host/create-listing"):(h.error("Subscription required to create listings"),G("/host/register"))},children:"Create New Listing"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-6 sm:mb-8",children:[t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer "+(ee?"":"opacity-60"),onClick:()=>{ee?G("/host/create-listing"):(h.error("Subscription required to create listings"),G("/host/register"))},children:t.jsxs(d,{children:[t.jsx(A,{className:"w-8 h-8 text-primary mb-2"}),t.jsx(m,{children:"Create New Listing"}),t.jsx(x,{children:ee?"Add a new property, experience, or service":"Subscribe to create listings"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>G("/host/listings"),children:t.jsxs(d,{children:[t.jsx(z,{className:"w-8 h-8 text-secondary mb-2"}),t.jsx(m,{children:"My Listings"}),t.jsx(x,{children:"View and manage your active listings"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>G("/host/bookings"),children:t.jsxs(d,{children:[t.jsx(M,{className:"w-8 h-8 text-accent mb-2"}),t.jsx(m,{children:"Bookings"}),t.jsx(x,{children:"Manage booking requests"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>G("/host/calendar"),children:t.jsxs(d,{children:[t.jsx(P,{className:"w-8 h-8 text-primary mb-2"}),t.jsx(m,{children:"Calendar"}),t.jsx(x,{children:"View bookings schedule"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>G("/host/messages"),children:t.jsxs(d,{children:[t.jsx(V,{className:"w-8 h-8 text-secondary mb-2"}),t.jsx(m,{children:"Messages"}),t.jsx(x,{children:"Chat with guests and respond to inquiries"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>G("/host/payments"),children:t.jsxs(d,{children:[t.jsx(R,{className:"w-8 h-8 text-accent mb-2"}),t.jsx(m,{children:"Payments"}),t.jsx(x,{children:"View earnings and payment methods"})]})}),t.jsx(n,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>G("/host/settings"),children:t.jsxs(d,{children:[t.jsx(Y,{className:"w-8 h-8 text-muted-foreground mb-2"}),t.jsx(m,{children:"Settings"}),t.jsx(x,{children:"Manage your account preferences"})]})})]}),t.jsx($,{})]}),t.jsx(D,{open:X,onOpenChange:Z,children:t.jsxs(S,{children:[t.jsxs(T,{children:[t.jsx(I,{children:"Sign Out"}),t.jsx(L,{children:"Are you sure you want to sign out? You'll need to sign in again to access your account."})]}),t.jsxs(O,{children:[t.jsx(B,{children:"Cancel"}),t.jsx(H,{onClick:async()=>{await _(),G("/")},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sign Out"})]})]})})]})};export{W as default};
