import{u as e,r as s,j as t}from"./react-vendor-DcULH_Au.js";import{u as a,L as i,B as n,C as l,d as r,a as c,b as d,c as o,i as m,j as x}from"./index-F95ZJi6y.js";import{N as h}from"./NotificationBell-DGLwxi-L.js";import{B as u}from"./badge-BPytCQbI.js";import{T as g}from"./theme-toggle-CJqSL7LK.js";import{q as j,w as p,c as f,k as N,e as v,f as b}from"./firebase-vendor-BtzXZj7S.js";import{S as w,a as k,b as y,c as D,d as S}from"./select-CpU4hhzn.js";import{D as C,a as I,b as T,c as L,d as O}from"./dialog-1q5CFjjn.js";import{A as B,a as H,b as M,c as P,d as z,e as A,f as F,g as G}from"./alert-dialog-Ce5W9-KF.js";import{H as V,ac as Y,i as U,k as E,_ as W,Z as $,x as q,ad as X}from"./icons-vendor-D18eSOBA.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-C9dhA_ey.js";import"./scroll-area-CWYRPkzZ.js";import"./dropdown-menu-C4xHPRIa.js";const Z=()=>{const Z=e(),{user:_,signOut:J}=a(),[K,Q]=s.useState([]),[R,ee]=s.useState([]),[se,te]=s.useState(!0),[ae,ie]=s.useState(new Date),[ne,le]=s.useState("month"),[re,ce]=s.useState("all"),[de,oe]=s.useState(null),[me,xe]=s.useState(!1),[he,ue]=s.useState(!1);s.useEffect(()=>{if(!_)return;const e=j(f(x,"listing"),p("hostId","==",_.uid)),s=N(e,e=>{const s=e.docs.map(e=>({id:e.id,...e.data()}));ee(s)});return()=>s()},[_]),s.useEffect(()=>{if(!_)return;te(!0);const e=j(f(x,"bookings"),p("hostId","==",_.uid)),s=N(e,async e=>{const s=await Promise.all(e.docs.map(async e=>{const s={id:e.id,...e.data()};if(s.listingId){const e=v(x,"listing",s.listingId),t=await b(e);if(t.exists()){const e=t.data();s.listingTitle=e?.title,s.listingLocation=e?.location}}if(s.guestId){const e=v(x,"users",s.guestId),t=await b(e);t.exists()&&(s.guestName=t.data()?.fullName)}return s}));Q(s),te(!1)});return()=>s()},[_]);const ge=e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e.checkOut);return t.setHours(0,0,0,0),s>t&&"confirmed"===e.status?"bg-green-500":"confirmed"===e.status?"bg-blue-500":"pending"===e.status?"bg-orange-500":(e.status,"bg-gray-400")},je=e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e.checkOut);return t.setHours(0,0,0,0),s>t&&"confirmed"===e.status?"Successful":"confirmed"===e.status?"Upcoming":"pending"===e.status?"Pending":"cancelled"===e.status?"Cancelled":e.status},pe=e=>{oe(e),xe(!0)},fe=(()=>{const e=ae.getFullYear(),s=ae.getMonth(),t=new Date(e,s,1),a=new Date(e,s+1,0).getDate(),i=t.getDay(),n=[];for(let l=0;i>l;l++)n.push(null);for(let l=1;a>=l;l++)n.push(new Date(e,s,l));return n})(),Ne=ae.toLocaleDateString("en-US",{month:"long",year:"numeric"}),ve=()=>{let e=K.filter(e=>"cancelled"!==e.status);return"all"!==re&&(e=e.filter(e=>e.listingId===re)),e.sort((e,s)=>new Date(e.checkIn).getTime()-new Date(s.checkIn).getTime()),e};return t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx("header",{className:"border-b bg-card",children:t.jsx("div",{className:"container mx-auto px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-8",children:[t.jsx(i,{size:"sm"}),t.jsxs("nav",{className:"hidden md:flex items-center gap-6",children:[t.jsxs(n,{variant:"ghost",onClick:()=>Z("/host/dashboard"),children:[t.jsx(V,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),t.jsxs(n,{variant:"ghost",onClick:()=>Z("/host/listings"),children:[t.jsx(Y,{className:"h-4 w-4 mr-2"}),"Listings"]}),t.jsxs(n,{variant:"default",children:[t.jsx(U,{className:"h-4 w-4 mr-2"}),"Calendar"]}),t.jsxs(n,{variant:"ghost",onClick:()=>Z("/host/messages"),children:[t.jsx(E,{className:"h-4 w-4 mr-2"}),"Messages"]})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(h,{}),t.jsx(g,{}),t.jsx(n,{variant:"outline",onClick:()=>ue(!0),children:"Sign Out"})]})]})})}),t.jsxs("main",{className:"container mx-auto px-6 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Booking Calendar"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage your bookings and availability"})]}),t.jsx(l,{className:"mb-6",children:t.jsx(r,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(n,{variant:"outline",size:"icon",onClick:()=>{ie(new Date(ae.getFullYear(),ae.getMonth()-1))},children:t.jsx(W,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-xl font-semibold min-w-[200px] text-center",children:Ne}),t.jsx(n,{variant:"outline",size:"icon",onClick:()=>{ie(new Date(ae.getFullYear(),ae.getMonth()+1))},children:t.jsx($,{className:"h-4 w-4"})}),t.jsx(n,{variant:"outline",onClick:()=>{ie(new Date)},children:"Today"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(w,{value:re,onValueChange:ce,children:[t.jsxs(k,{className:"w-[200px]",children:[t.jsx(q,{className:"h-4 w-4 mr-2"}),t.jsx(y,{placeholder:"All Properties"})]}),t.jsxs(D,{children:[t.jsx(S,{value:"all",children:"All Properties"}),R.map(e=>t.jsx(S,{value:e.id,children:e.title},e.id))]})]}),t.jsxs("div",{className:"flex items-center gap-2 border rounded-md p-1",children:[t.jsxs(n,{variant:"month"===ne?"default":"ghost",size:"sm",onClick:()=>le("month"),children:[t.jsx(Y,{className:"h-4 w-4 mr-2"}),"Month"]}),t.jsxs(n,{variant:"list"===ne?"default":"ghost",size:"sm",onClick:()=>le("list"),children:[t.jsx(X,{className:"h-4 w-4 mr-2"}),"List"]})]})]})]})})}),t.jsx(l,{className:"mb-6",children:t.jsx(r,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-6",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-6 h-6 rounded border-2 border-primary bg-primary/10 flex items-center justify-center",children:t.jsx(U,{className:"h-3 w-3 text-primary"})}),t.jsx("span",{className:"text-sm font-medium",children:"Today"})]}),t.jsx("div",{className:"h-4 w-px bg-border"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded bg-blue-500"}),t.jsx("span",{className:"text-sm",children:"Upcoming"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded bg-green-500"}),t.jsx("span",{className:"text-sm",children:"Successful"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded bg-orange-500"}),t.jsx("span",{className:"text-sm",children:"Pending"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded bg-gray-400"}),t.jsx("span",{className:"text-sm",children:"Cancelled"})]})]})})}),"month"===ne&&t.jsx(l,{children:t.jsxs(r,{className:"p-6",children:[t.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>t.jsx("div",{className:"text-center font-semibold text-sm py-2",children:e},e))}),t.jsx("div",{className:"grid grid-cols-7 gap-2",children:fe.map((e,s)=>{const a=e?(e=>{if(!e)return[];e.toISOString().split("T")[0];let s=K.filter(s=>{if("cancelled"===s.status)return!1;const t=new Date(s.checkIn),a=new Date(s.checkOut);return t.setHours(0,0,0,0),a.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=t&&a>=e});return"all"!==re&&(s=s.filter(e=>e.listingId===re)),s})(e):[],i=e&&e.toDateString()===(new Date).toDateString();return t.jsx("div",{className:`\n                        min-h-[120px] border rounded-lg p-2 relative\n                        ${e?"bg-card hover:bg-muted/50 cursor-pointer":"bg-muted/20"}\n                        ${i?"border-primary border-2 bg-primary/5":""}\n                        transition-colors\n                      `,children:e&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"text-sm font-medium mb-2 flex items-center gap-1 "+(i?"text-primary font-bold":""),children:[e.getDate(),i&&t.jsx("span",{className:"text-xs bg-primary text-primary-foreground px-1.5 py-0.5 rounded font-normal",children:"Today"})]}),t.jsxs("div",{className:"space-y-1",children:[a.slice(0,3).map((e,s)=>t.jsx("div",{className:"text-xs p-1 rounded text-white truncate cursor-pointer hover:opacity-80 "+ge(e),onClick:()=>pe(e),title:e.listingTitle,children:e.listingTitle},s)),a.length>3&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",a.length-3," more"]})]})]})},s)})})]})}),"list"===ne&&t.jsxs(l,{children:[t.jsxs(c,{children:[t.jsx(d,{children:"All Bookings"}),t.jsxs(o,{children:[ve().length," booking",1!==ve().length?"s":""]})]}),t.jsx(r,{children:se?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading bookings..."}):0===ve().length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(U,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No bookings found"})]}):t.jsx("div",{className:"space-y-4",children:ve().map(e=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>pe(e),children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("h3",{className:"font-semibold",children:e.listingTitle}),t.jsx(u,{className:ge(e),children:je(e)})]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:["ðŸ“ ",e.listingLocation]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:["ðŸ‘¤ ",e.guestName||"Guest"]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["ðŸ“… ",new Date(e.checkIn).toLocaleDateString()," - ",new Date(e.checkOut).toLocaleDateString()]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-semibold text-lg",children:m(e.totalPrice||0)}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.guests," guest",1!==e.guests?"s":""]})]})]})},e.id))})})]})]}),t.jsx(C,{open:me,onOpenChange:xe,children:t.jsxs(I,{className:"max-w-2xl",children:[t.jsxs(T,{children:[t.jsx(L,{children:"Booking Details"}),t.jsx(O,{children:"View booking information"})]}),de&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold",children:de.listingTitle}),t.jsx(u,{className:ge(de),children:je(de)})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-in"}),t.jsx("p",{className:"font-medium",children:new Date(de.checkIn).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-out"}),t.jsx("p",{className:"font-medium",children:new Date(de.checkOut).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Guest"}),t.jsx("p",{className:"font-medium",children:de.guestName||"Guest"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Guests"}),t.jsx("p",{className:"font-medium",children:de.guests})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),t.jsx("p",{className:"font-medium text-lg",children:m(de.totalPrice||0)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Booking ID"}),t.jsxs("p",{className:"font-medium text-sm",children:[de.id.slice(0,8),"..."]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Location"}),t.jsx("p",{className:"font-medium",children:de.listingLocation})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(n,{variant:"default",className:"flex-1",onClick:()=>{Z("/host/bookings"),xe(!1)},children:"View in Bookings"}),t.jsx(n,{variant:"outline",onClick:()=>xe(!1),children:"Close"})]})]})]})}),t.jsx(B,{open:he,onOpenChange:ue,children:t.jsxs(H,{children:[t.jsxs(M,{children:[t.jsx(P,{children:"Sign Out?"}),t.jsx(z,{children:"Are you sure you want to sign out?"})]}),t.jsxs(A,{children:[t.jsx(F,{children:"Cancel"}),t.jsx(G,{onClick:async()=>{try{await J(),Z("/")}catch(e){}},children:"Sign Out"})]})]})})]})};export{Z as default};
