import{u as e,r as s,j as a}from"./react-vendor-Ve3SFwKO.js";import{u as t,o as l,a as i,v as r,B as n,i as o,A as c,p as d,G as m}from"./index-BnushFQy.js";import{L as h}from"./ListingCard-D6Td60Vf.js";import{B as x}from"./BackButton-DohCcac0.js";import{T as u}from"./textarea-DvORGimk.js";import{L as g}from"./label-DdT-oWKe.js";import{D as p,a as j,b as f,c as b,d as N,e as v}from"./dialog-B475KvSN.js";import{B as w}from"./badge-CYghlWc2.js";import{S as y}from"./separator-ChZB0NG6.js";import{aa as k,a3 as C,a4 as z,a5 as S,o as A,M as L,w as I,m as P,U as D,y as B,z as F,H as T,X as $}from"./icons-vendor-DD8ZfUKZ.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-D9RGQy8n.js";import"./firebase-vendor-BC71bXmb.js";const E=()=>{e();const{user:E}=t(),[G,O]=s.useState([]),[U,V]=s.useState(!0),[q,H]=s.useState(!1),[M,R]=s.useState(null),[Y,X]=s.useState(""),[J,K]=s.useState(null),[Q,W]=s.useState(null),[Z,_]=s.useState(!1),[ee,se]=s.useState(!1),[ae,te]=s.useState(!1),[le,ie]=s.useState(!1),[re,ne]=s.useState(0),[oe,ce]=s.useState([]),[de,me]=s.useState(0);s.useEffect(()=>{he()},[]);const he=async()=>{try{V(!0);const e=await l({status:"approved"});O(e)}catch(e){i.error("Failed to load active listings: "+(e.message||"Unknown error"))}finally{V(!1)}},xe=e=>{R(e),X(""),H(!0)};return a.jsxs("div",{className:"min-h-screen bg-background p-4 sm:p-6",children:[a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx(x,{to:"/admin/dashboard",className:"mb-4 sm:mb-6"}),a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-4 sm:mb-6",children:"Active Listings"}),U?a.jsx(r,{}):0===G.length?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-muted-foreground",children:"No active listings"})}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:G.map(e=>a.jsxs("div",{className:"cursor-pointer",onClick:()=>(async e=>{if(K(e),_(!0),me(0),se(!0),e.hostId)try{const s=await c(e.hostId);W(s?{fullName:s.fullName||"N/A",email:s.email||"N/A"}:{fullName:"N/A",email:"N/A"})}catch(s){W({fullName:"Error loading",email:"Error loading"})}finally{se(!1)}else W({fullName:"N/A",email:"N/A"}),se(!1)})(e),children:[a.jsx(h,{listing:e}),a.jsx("div",{className:"mt-2 flex gap-2",onClick:e=>e.stopPropagation(),children:a.jsxs(n,{variant:"destructive",size:"sm",className:"flex-1 h-11 sm:h-auto text-sm sm:text-base touch-manipulation",onClick:()=>xe(e),children:[a.jsx(k,{className:"h-4 w-4 mr-2"}),"Delete"]})})]},e.id))})]}),a.jsx(p,{open:q,onOpenChange:H,children:a.jsxs(j,{className:"max-w-2xl",children:[a.jsxs(f,{children:[a.jsxs(b,{className:"text-2xl flex items-center gap-2",children:[a.jsx(k,{className:"h-6 w-6 text-destructive"}),"Delete Listing"]}),a.jsxs(N,{children:['You are about to delete the listing "',M?.title,'". Please provide a reason for deletion. This message will be sent to the host.']})]}),M&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Listing to delete:"}),a.jsx("p",{className:"font-semibold",children:M.title}),a.jsx("p",{className:"text-sm text-muted-foreground",children:M.location})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(g,{htmlFor:"delete-reason",className:"text-base font-semibold",children:["Reason for Deletion ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsx(u,{id:"delete-reason",placeholder:"Please explain why this listing is being deleted. This message will be sent to the host...",value:Y,onChange:e=>X(e.target.value),className:"min-h-[120px]",required:!0}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This message will be sent to the host through the messaging system."})]})]}),a.jsxs(v,{children:[a.jsx(n,{variant:"outline",onClick:()=>{H(!1),R(null),X("")},disabled:ae,children:"Cancel"}),a.jsx(n,{variant:"destructive",onClick:async()=>{if(M&&E)if(Y.trim()){te(!0);try{if(await d(M.id),M.hostId)try{const e=`Your listing "${M.title}" has been deleted by an administrator.\n\nReason: ${Y.trim()}\n\nIf you have any questions or concerns, please contact support.`;await m({senderId:E.uid,receiverId:M.hostId,content:e,read:!1}),i.success("Listing deleted and host notified")}catch(e){i.success("Listing deleted, but failed to notify host. Please contact them manually.")}else i.success("Listing deleted");await he(),R(null),X("")}catch(s){i.error("Failed to delete listing: "+(s.message||"Unknown error"))}finally{te(!1),H(!1)}}else i.error("Please provide a reason for deletion")},disabled:ae||!Y.trim(),children:ae?"Deleting...":"Delete Listing"})]})]})}),a.jsx(p,{open:Z,onOpenChange:_,children:a.jsxs(j,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(f,{children:[a.jsx(b,{className:"text-2xl",children:J?.title}),a.jsx(N,{children:"View full listing details and host information"})]}),J&&a.jsxs("div",{className:"space-y-6",children:[J.images&&J.images.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"relative w-full h-[400px] rounded-lg overflow-hidden group bg-muted cursor-pointer",onClick:()=>{ce(J.images),ne(de),ie(!0)},children:[a.jsx("div",{className:"flex transition-transform duration-500 ease-in-out h-full",style:{transform:`translateX(-${100*de}%)`},children:J.images.map((e,s)=>a.jsx("div",{className:"min-w-full h-full flex-shrink-0 relative",children:a.jsx("img",{src:e||"/placeholder.svg",alt:`${J.title} - Image ${s+1}`,className:"w-full h-full object-cover"})},s))}),J.images.length>1&&a.jsxs(a.Fragment,{children:[a.jsx(n,{variant:"secondary",size:"icon",className:"absolute left-4 top-1/2 -translate-y-1/2 opacity-80 hover:opacity-100 transition-opacity bg-black/70 hover:bg-black/90 text-white border-none z-10 shadow-lg backdrop-blur-sm h-10 w-10",onClick:e=>{e.stopPropagation(),me(e=>0===e?J.images.length-1:e-1)},"aria-label":"Previous image",children:a.jsx(C,{className:"h-5 w-5"})}),a.jsx(n,{variant:"secondary",size:"icon",className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-80 hover:opacity-100 transition-opacity bg-black/70 hover:bg-black/90 text-white border-none z-10 shadow-lg backdrop-blur-sm h-10 w-10",onClick:e=>{e.stopPropagation(),me(e=>e===J.images.length-1?0:e+1)},"aria-label":"Next image",children:a.jsx(z,{className:"h-5 w-5"})}),a.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white px-3 py-1.5 rounded-full text-xs font-medium backdrop-blur-sm z-10 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx(S,{className:"h-3 w-3 inline mr-1"}),"Click to zoom"]}),a.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/70 text-white px-4 py-1.5 rounded-full text-sm font-medium backdrop-blur-sm z-10",children:[de+1," / ",J.images.length]})]})]}),J.images.length>1&&a.jsx("div",{className:"relative",children:a.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-2 snap-x snap-mandatory",children:J.images.map((e,s)=>a.jsx("button",{onClick:()=>me(s),className:"relative flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-all snap-start "+(de===s?"border-primary ring-2 ring-primary/50 scale-105":"border-transparent hover:border-border opacity-70 hover:opacity-100"),children:a.jsx("img",{src:e,alt:"Thumbnail "+(s+1),className:"w-full h-full object-cover"})},s))})})]}),a.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[a.jsx(A,{className:"h-5 w-5"}),"Host Information"]}),ee?a.jsx("p",{className:"text-muted-foreground",children:"Loading host information..."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(A,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium",children:"Name:"}),a.jsx("span",{children:Q?.fullName||"N/A"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(L,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium",children:"Email:"}),a.jsx("a",{href:"mailto:"+(Q?.email||""),className:"text-primary hover:underline",children:Q?.email||"N/A"})]})]})]}),a.jsx(y,{}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[a.jsx(I,{className:"h-5 w-5"}),"Location"]}),a.jsx("p",{className:"text-muted-foreground",children:J.location})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),a.jsx("p",{className:"text-muted-foreground whitespace-pre-wrap",children:J.description})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(P,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Price"}),a.jsxs("p",{className:"font-semibold",children:[o(J.price),"/night"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Max Guests"}),a.jsx("p",{className:"font-semibold",children:J.maxGuests})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Bedrooms"}),a.jsx("p",{className:"font-semibold",children:J.bedrooms||"N/A"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(F,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Bathrooms"}),a.jsx("p",{className:"font-semibold",children:void 0!==J.bathrooms?J.bathrooms:"N/A"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(T,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Category"}),a.jsx(w,{variant:"secondary",children:J.category})]})]}),J.amenities&&J.amenities.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Amenities"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:J.amenities.map((e,s)=>a.jsx(w,{variant:"outline",children:e},s))})]})]}),a.jsx(y,{}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(n,{variant:"outline",onClick:()=>_(!1),children:"Close"}),a.jsxs(n,{variant:"destructive",onClick:()=>{_(!1),xe(J)},children:[a.jsx(k,{className:"h-4 w-4 mr-2"}),"Delete Listing"]})]})]})]})}),a.jsx(p,{open:le,onOpenChange:ie,children:a.jsxs(j,{className:"max-w-[98vw] max-h-[98vh] w-auto h-auto p-0 bg-black/95 border-none m-1",children:[a.jsx(b,{className:"sr-only",children:"View Full Size Image"}),a.jsxs(N,{className:"sr-only",children:["Viewing image ",re+1," of ",oe.length]}),a.jsx("div",{className:"relative w-full h-full flex items-center justify-center min-h-[400px]",children:oe.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(n,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-10 sm:w-10",onClick:()=>ie(!1),children:a.jsx($,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),a.jsxs("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 bg-black/70 text-white px-3 py-1.5 rounded-full text-xs sm:text-sm font-medium backdrop-blur-sm z-50",children:[re+1," / ",oe.length]}),a.jsx("div",{className:"w-full h-full flex items-center justify-center p-2 sm:p-4 pt-12 pb-20 sm:pb-24",children:a.jsx("img",{src:oe[re]||"/placeholder.svg",alt:"Image "+(re+1),className:"max-w-full max-h-[calc(98vh-160px)] object-contain"})}),oe.length>1&&a.jsxs(a.Fragment,{children:[a.jsx(n,{variant:"ghost",size:"icon",className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-12 sm:w-12",onClick:()=>ne(e=>0===e?oe.length-1:e-1),children:a.jsx(C,{className:"h-4 w-4 sm:h-6 sm:w-6"})}),a.jsx(n,{variant:"ghost",size:"icon",className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-12 sm:w-12",onClick:()=>ne(e=>e===oe.length-1?0:e+1),children:a.jsx(z,{className:"h-4 w-4 sm:h-6 sm:w-6"})})]}),oe.length>1&&a.jsx("div",{className:"absolute bottom-2 sm:bottom-4 left-1/2 -translate-x-1/2 bg-black/70 backdrop-blur-sm rounded-lg p-2 sm:p-3 z-50 max-w-[calc(98vw-32px)]",children:a.jsx("div",{className:"flex gap-2 sm:gap-3 overflow-x-auto scrollbar-hide px-1",children:oe.map((e,s)=>a.jsx("button",{onClick:()=>ne(s),className:"relative flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 rounded transition-all "+(re===s?"scale-110 shadow-lg shadow-primary/50":"opacity-70 hover:opacity-100"),children:a.jsx("div",{className:"absolute inset-0 rounded overflow-hidden border-2 "+(re===s?"border-primary ring-2 ring-primary/50 ring-offset-2 ring-offset-black/70":"border-transparent hover:border-white/50"),children:a.jsx("img",{src:e,alt:"Thumbnail "+(s+1),className:"w-full h-full object-cover transition-opacity "+(re===s?"opacity-100":"opacity-70")})})},s))})})]})})]})})]})};export{E as default};
