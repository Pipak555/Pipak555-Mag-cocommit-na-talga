import{u as e,l as s,r as i,j as a}from"./react-vendor-BMVo5gto.js";import{u as n,j as t,h as l,v as o,B as c,C as r,a as d,b as m,c as x,d as h,i as j,e as p}from"./index-BbQqfVom.js";import{f as u,e as f,u as g}from"./firebase-vendor-BtzXZj7S.js";import{I as v}from"./input-B93J7yYR.js";import{T as b,a as y,b as N,c as k}from"./tabs-CPhJH8Ta.js";import{L as w}from"./label-CE6eI_XB.js";import{B as C}from"./badge-0vFpitRp.js";import{S}from"./switch-D-T8Tgnl.js";import{E as A}from"./empty-state-Fqt3Rb73.js";import{C as F}from"./CouponManager-7m7oVs-H.js";import{A as R,a as M,b as B,c as P,d as U,e as O,f as E,g as D}from"./alert-dialog-Biqv9se3.js";import{A as I,o as G,j as L,a3 as V,a8 as Y,S as q,M as H,a9 as T}from"./icons-vendor-D1YpcxsO.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-Dbp4DHG_.js";const W=()=>{const W=e(),[$]=s(),{user:z,userRole:J,refreshUserProfile:K,signOut:Q,hasRole:X}=n(),[Z,_]=i.useState(null),[ee,se]=i.useState(!1),[ie,ae]=i.useState([]),[ne,te]=i.useState([]),[le,oe]=i.useState($.get("tab")||"profile"),[ce,re]=i.useState(!1),[de,me]=i.useState({email:{bookingConfirmations:!0,bookingCancellations:!0,bookingReminders:!0,newMessages:!0,paymentUpdates:!0,promotionalOffers:!0},inApp:{bookingUpdates:!0,newMessages:!0,paymentNotifications:!0,systemAlerts:!0}});i.useEffect(()=>{!z||X("host")?z&&xe():W("/host/login")},[z,J,W]),i.useEffect(()=>{const e=$.get("tab");e&&oe(e)},[$]),i.useEffect(()=>{z&&X("host")&&(he(),Z?.notifications&&me(Z.notifications))},[z,J,Z]);const xe=async()=>{if(z)try{const e=await u(f(t,"users",z.uid));if(e.exists()){const s=e.data();_(s),te(s.coupons||[])}}catch(e){}},he=async()=>{if(z)try{const e=await l({hostId:z.uid});ae(e)}catch(e){}};return Z?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8 max-w-4xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs(c,{variant:"ghost",onClick:()=>{W("/host/dashboard")},children:[a.jsx(I,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),a.jsx(c,{variant:"outline",onClick:()=>re(!0),children:"Sign Out"})]}),a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Account Settings"}),a.jsxs(b,{value:le,onValueChange:oe,className:"space-y-6",children:[a.jsxs(y,{className:"grid w-full grid-cols-5",children:[a.jsxs(N,{value:"profile",children:[a.jsx(G,{className:"h-4 w-4 mr-2"}),"Profile"]}),a.jsxs(N,{value:"bookings",children:[a.jsx(L,{className:"h-4 w-4 mr-2"}),"Bookings"]}),a.jsxs(N,{value:"coupons",children:[a.jsx(V,{className:"h-4 w-4 mr-2"}),"Coupons"]}),a.jsxs(N,{value:"notifications",children:[a.jsx(Y,{className:"h-4 w-4 mr-2"}),"Notifications"]}),a.jsxs(N,{value:"security",children:[a.jsx(q,{className:"h-4 w-4 mr-2"}),"Security"]})]}),a.jsx(k,{value:"profile",children:a.jsxs(r,{children:[a.jsxs(d,{children:[a.jsx(m,{children:"Profile Information"}),a.jsx(x,{children:"Update your account details"})]}),a.jsxs(h,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"fullName",children:"Full Name"}),a.jsx(v,{id:"fullName",type:"text",value:Z.fullName,onChange:e=>_({...Z,fullName:e.target.value}),placeholder:"Enter your full name"})]}),a.jsxs("div",{children:[a.jsx(w,{htmlFor:"email",children:"Email"}),a.jsx(v,{id:"email",type:"email",value:Z.email,disabled:!0})]}),a.jsxs("div",{children:[a.jsx(w,{htmlFor:"role",children:"Role"}),a.jsx(v,{id:"role",value:Z.role,disabled:!0})]}),a.jsxs("div",{children:[a.jsx(w,{htmlFor:"points",children:"Reward Points"}),a.jsx(v,{id:"points",value:Z.points,disabled:!0})]}),a.jsxs("div",{children:[a.jsx(w,{htmlFor:"balance",children:"Wallet Balance"}),a.jsx(v,{id:"balance",value:j(Z.walletBalance),disabled:!0})]}),a.jsx(c,{onClick:async()=>{if(z&&Z){se(!0);try{await g(f(t,"users",z.uid),{fullName:Z.fullName}),await xe(),await K(),p.success("Profile updated successfully!")}catch(e){p.error("Failed to update profile")}finally{se(!1)}}},disabled:ee,children:ee?"Saving...":"Save Changes"})]})]})}),a.jsx(k,{value:"bookings",children:a.jsxs(r,{children:[a.jsxs(d,{children:[a.jsx(m,{children:"Host Bookings"}),a.jsx(x,{children:"Manage your property bookings"})]}),a.jsx(h,{children:0===ie.length?a.jsx(A,{icon:a.jsx(L,{className:"h-10 w-10"}),title:"No bookings yet",description:"No booking requests at this time."}):a.jsx("div",{className:"space-y-4",children:ie.map(e=>a.jsxs("div",{className:"p-4 border rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium",children:["Booking #",e.id.slice(0,8)]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[new Date(e.checkIn).toLocaleDateString()," - ",new Date(e.checkOut).toLocaleDateString()]})]}),a.jsx(C,{variant:"confirmed"===e.status?"default":"pending"===e.status?"secondary":"cancelled"===e.status?"destructive":"completed"===e.status?"outline":"secondary",children:e.status})]}),a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.guests," guest",e.guests>1?"s":""]}),a.jsx("p",{className:"font-semibold",children:j(e.totalPrice||0)})]})]},e.id))})})]})}),a.jsx(k,{value:"coupons",children:a.jsxs(r,{children:[a.jsxs(d,{children:[a.jsx(m,{children:"Coupons"}),a.jsx(x,{children:"Manage your promotional coupons"})]}),a.jsx(h,{children:a.jsx(F,{coupons:ne,onApplyCoupon:e=>p.info(`Coupon ${e} applied`)})})]})}),a.jsx(k,{value:"notifications",children:a.jsxs(r,{children:[a.jsxs(d,{children:[a.jsx(m,{children:"Notification Preferences"}),a.jsx(x,{children:"Manage how you receive updates"})]}),a.jsxs(h,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[a.jsx(H,{className:"h-5 w-5 text-primary"}),a.jsx("h3",{className:"text-lg font-semibold",children:"Email Notifications"})]}),a.jsxs("div",{className:"space-y-3 pl-7",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"email-booking-confirmations",children:"Booking Confirmations"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Receive emails when bookings are confirmed"})]}),a.jsx(S,{id:"email-booking-confirmations",checked:de.email.bookingConfirmations,onCheckedChange:e=>me(s=>({...s,email:{...s.email,bookingConfirmations:e}}))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"email-booking-cancellations",children:"Booking Cancellations"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Receive emails when bookings are cancelled"})]}),a.jsx(S,{id:"email-booking-cancellations",checked:de.email.bookingCancellations,onCheckedChange:e=>me(s=>({...s,email:{...s.email,bookingCancellations:e}}))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"email-booking-reminders",children:"Booking Reminders"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Receive reminders about upcoming bookings"})]}),a.jsx(S,{id:"email-booking-reminders",checked:de.email.bookingReminders,onCheckedChange:e=>me(s=>({...s,email:{...s.email,bookingReminders:e}}))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"email-new-messages",children:"New Messages"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Receive emails for new messages"})]}),a.jsx(S,{id:"email-new-messages",checked:de.email.newMessages,onCheckedChange:e=>me(s=>({...s,email:{...s.email,newMessages:e}}))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"email-payment-updates",children:"Payment Updates"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Receive emails about payment transactions"})]}),a.jsx(S,{id:"email-payment-updates",checked:de.email.paymentUpdates,onCheckedChange:e=>me(s=>({...s,email:{...s.email,paymentUpdates:e}}))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"email-promotional-offers",children:"Promotional Offers"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Receive promotional emails and special offers"})]}),a.jsx(S,{id:"email-promotional-offers",checked:de.email.promotionalOffers,onCheckedChange:e=>me(s=>({...s,email:{...s.email,promotionalOffers:e}}))})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[a.jsx(T,{className:"h-5 w-5 text-secondary"}),a.jsx("h3",{className:"text-lg font-semibold",children:"In-App Notifications"})]}),a.jsxs("div",{className:"space-y-3 pl-7",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"inapp-booking-updates",children:"Booking Updates"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Get notified about booking status changes"})]}),a.jsx(S,{id:"inapp-booking-updates",checked:de.inApp.bookingUpdates,onCheckedChange:e=>me(s=>({...s,inApp:{...s.inApp,bookingUpdates:e}}))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"inapp-new-messages",children:"New Messages"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Get notified about new messages"})]}),a.jsx(S,{id:"inapp-new-messages",checked:de.inApp.newMessages,onCheckedChange:e=>me(s=>({...s,inApp:{...s.inApp,newMessages:e}}))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"inapp-payment-notifications",children:"Payment Notifications"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Get notified about payment activities"})]}),a.jsx(S,{id:"inapp-payment-notifications",checked:de.inApp.paymentNotifications,onCheckedChange:e=>me(s=>({...s,inApp:{...s.inApp,paymentNotifications:e}}))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"inapp-system-alerts",children:"System Alerts"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Receive important system notifications"})]}),a.jsx(S,{id:"inapp-system-alerts",checked:de.inApp.systemAlerts,onCheckedChange:e=>me(s=>({...s,inApp:{...s.inApp,systemAlerts:e}}))})]})]})]}),a.jsx("div",{className:"pt-4 border-t",children:a.jsx(c,{onClick:async()=>{if(z){se(!0);try{await g(f(t,"users",z.uid),{notifications:de}),await K(),p.success("Notification preferences saved!")}catch(e){p.error("Failed to save notification preferences")}finally{se(!1)}}},disabled:ee,children:ee?"Saving...":"Save Preferences"})})]})]})}),a.jsx(k,{value:"security",children:a.jsxs(r,{children:[a.jsxs(d,{children:[a.jsx(m,{children:"Security Settings"}),a.jsx(x,{children:"Manage your account security"})]}),a.jsx(h,{children:a.jsx("p",{className:"text-muted-foreground",children:"Security settings coming soon"})})]})})]})]}),a.jsx(R,{open:ce,onOpenChange:re,children:a.jsxs(M,{children:[a.jsxs(B,{children:[a.jsx(P,{children:"Sign Out"}),a.jsx(U,{children:"Are you sure you want to sign out? You'll need to sign in again to access your account."})]}),a.jsxs(O,{children:[a.jsx(E,{children:"Cancel"}),a.jsx(D,{onClick:async()=>{await Q(),W("/")},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sign Out"})]})]})})]}):a.jsx(o,{})};export{W as default};
