import{u as s,r as e,j as t}from"./react-vendor-DcULH_Au.js";import{u as a,L as i,B as r,C as o,a as l,b as n,d as c,i as d,c as m,e as x,j as h}from"./index-F95ZJi6y.js";import{N as j}from"./NotificationBell-DGLwxi-L.js";import{T as u}from"./theme-toggle-CJqSL7LK.js";import{k as g,c as p}from"./firebase-vendor-BtzXZj7S.js";import{A as f,a as v,b as N,c as b,d as w,e as k,f as y,g as A}from"./alert-dialog-Ce5W9-KF.js";import{S as C,U as B,H as F,l as S,s as L,F as O,n as P,C as U}from"./icons-vendor-D18eSOBA.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-C9dhA_ey.js";import"./scroll-area-CWYRPkzZ.js";import"./badge-BPytCQbI.js";import"./dropdown-menu-C4xHPRIa.js";const M=()=>{const{user:M,userRole:R,userProfile:z,signOut:G}=a(),H=s(),[T,W]=e.useState({totalUsers:0,totalHosts:0,totalGuests:0,totalAdmins:0,activeListings:0,totalBookings:0,cancelledBookings:0,serviceFees:0}),[V,Y]=e.useState(!1);return e.useEffect(()=>{if(!M||"admin"!==R)return void H("/admin/login");let s=null,e=null,t=null;return s=g(p(h,"users"),s=>{const e=s.docs.map(s=>{const e=s.data();return{id:s.id,email:e.email,role:e.role,fullName:e.fullName,...e}}),t=e.filter(s=>"host"===s.role).length,a=e.filter(s=>"guest"===s.role).length,i=e.filter(s=>"admin"===s.role).length;W(e=>({...e,totalUsers:s.size,totalHosts:t,totalGuests:a,totalAdmins:i}))},s=>{x.error("Failed to load users: "+s.message)}),e=g(p(h,"listing"),s=>{const e=s.docs.filter(s=>"approved"===s.data().status).length;W(s=>({...s,activeListings:e}))},s=>{x.error("Failed to load listings: "+s.message)}),t=g(p(h,"bookings"),s=>{const e=s.docs.map(s=>s.data()),t=e.filter(s=>"confirmed"===s.status||"completed"===s.status),a=e.filter(s=>"cancelled"===s.status),i=.1*t.reduce((s,e)=>s+(e.totalPrice||0),0);W(e=>({...e,totalBookings:s.size,cancelledBookings:a.length,serviceFees:i}))},s=>{x.error("Failed to load bookings: "+s.message)}),()=>{s&&s(),e&&e(),t&&t()}},[M,R,H]),t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx("header",{className:"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 shadow-soft",children:t.jsxs("div",{className:"container mx-auto px-6 py-4 flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(i,{size:"sm"}),t.jsx("div",{className:"p-2 rounded-lg bg-accent/10",children:t.jsx(C,{className:"w-5 h-5 text-accent"})}),t.jsxs("div",{children:[t.jsxs("h1",{className:"text-lg font-bold",children:["Welcome, ",z?.fullName||"Admin","!"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Platform management"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(j,{}),t.jsx(u,{}),t.jsx(r,{variant:"outline",onClick:()=>Y(!0),children:"Sign Out"})]})]})}),t.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8 p-6 rounded-xl bg-gradient-accent text-white",children:[t.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Platform Overview"}),t.jsxs("p",{className:"text-white/90",children:["Welcome back, ",z?.fullName||"Admin","!"]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[t.jsxs(o,{className:"shadow-soft",children:[t.jsx(l,{className:"pb-3",children:t.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Total Users"})}),t.jsxs(c,{children:[t.jsx("div",{className:"text-2xl font-bold",children:T.totalUsers}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[T.totalHosts," hosts, ",T.totalGuests," guests",T.totalAdmins>0?`, ${T.totalAdmins} admin${T.totalAdmins>1?"s":""}`:""]})]})]}),t.jsxs(o,{className:"shadow-soft",children:[t.jsx(l,{className:"pb-3",children:t.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Active Listings"})}),t.jsx(c,{children:t.jsx("div",{className:"text-2xl font-bold",children:T.activeListings})})]}),t.jsxs(o,{className:"shadow-soft",children:[t.jsx(l,{className:"pb-3",children:t.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Total Bookings"})}),t.jsx(c,{children:t.jsx("div",{className:"text-2xl font-bold",children:T.totalBookings})})]}),t.jsxs(o,{className:"shadow-soft",children:[t.jsx(l,{className:"pb-3",children:t.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Service Fees"})}),t.jsxs(c,{children:[t.jsx("div",{className:"text-2xl font-bold text-accent",children:d(T.serviceFees)}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"10% commission"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[t.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>H("/admin/users"),children:t.jsxs(l,{children:[t.jsx(B,{className:"w-8 h-8 text-primary mb-2"}),t.jsx(n,{children:"User Management"}),t.jsx(m,{children:"Manage hosts, guests, and permissions"})]})}),t.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>H("/admin/listings"),children:t.jsxs(l,{children:[t.jsx(F,{className:"w-8 h-8 text-primary mb-2"}),t.jsx(n,{children:"Listings Review"}),t.jsx(m,{children:"Approve and moderate listings"})]})}),t.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>H("/admin/payments"),children:t.jsxs(l,{children:[t.jsx(S,{className:"w-8 h-8 text-accent mb-2"}),t.jsx(n,{children:"Payment Management"}),t.jsx(m,{children:"Review and confirm payments"})]})}),t.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>H("/admin/analytics"),children:t.jsxs(l,{children:[t.jsx(L,{className:"w-8 h-8 text-secondary mb-2"}),t.jsx(n,{children:"Analytics"}),t.jsx(m,{children:"View platform performance metrics"})]})}),t.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>H("/admin/reports"),children:t.jsxs(l,{children:[t.jsx(O,{className:"w-8 h-8 text-secondary mb-2"}),t.jsx(n,{children:"Reports"}),t.jsx(m,{children:"Generate platform reports"})]})}),t.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>H("/admin/policies"),children:t.jsxs(l,{children:[t.jsx(P,{className:"w-8 h-8 text-muted-foreground mb-2"}),t.jsx(n,{children:"Policies & Settings"}),t.jsx(m,{children:"Manage platform policies"})]})})]}),t.jsxs(o,{className:"shadow-medium",children:[t.jsxs(l,{children:[t.jsx(n,{children:"Recent Activity"}),t.jsx(m,{children:"Latest platform events"})]}),t.jsx(c,{children:t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(U,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No recent activity to display"})]})})]})]}),t.jsx(f,{open:V,onOpenChange:Y,children:t.jsxs(v,{children:[t.jsxs(N,{children:[t.jsx(b,{children:"Sign Out"}),t.jsx(w,{children:"Are you sure you want to sign out? You'll need to sign in again to access your account."})]}),t.jsxs(k,{children:[t.jsx(y,{children:"Cancel"}),t.jsx(A,{onClick:async()=>{await G(),H("/")},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sign Out"})]})]})})]})};export{M as default};
