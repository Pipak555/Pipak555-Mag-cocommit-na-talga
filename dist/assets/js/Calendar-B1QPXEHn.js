import{u as e,r as s,j as t}from"./react-vendor-BMVo5gto.js";import{u as r,L as a,B as n,C as i,d as l,a as o,b as d,c,i as m,j as g}from"./index-Bl4WVUm9.js";import{N as x}from"./NotificationBell-CwTk-oRi.js";import{B as h}from"./badge-_91-i8yA.js";import{T as u}from"./theme-toggle-Cc0KLt9y.js";import{q as j,w as p,c as b,k as f,e as N,f as v}from"./firebase-vendor-BtzXZj7S.js";import{S as w,a as y,b as k,c as D,d as S}from"./select-Cc7L2WO6.js";import{D as C,a as I,b as T,c as L,d as O}from"./dialog-DVuhSEXh.js";import{A as H,a as B,b as P,c as M,d as $,e as z,f as A,g as F}from"./alert-dialog-ChaDevpt.js";import{H as G,ah as U,j as V,l as Y,$ as E,a0 as q,G as R,ai as W}from"./icons-vendor-BQMxNFbQ.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-Dbp4DHG_.js";import"./scroll-area-Dt92Xony.js";import"./dropdown-menu-CmwzabuV.js";const J=()=>{const J=e(),{user:K,signOut:Q}=r(),[X,Z]=s.useState([]),[_,ee]=s.useState([]),[se,te]=s.useState(!0),[re,ae]=s.useState(new Date),[ne,ie]=s.useState("month"),[le,oe]=s.useState("all"),[de,ce]=s.useState(null),[me,ge]=s.useState(!1),[xe,he]=s.useState(!1);s.useEffect(()=>{if(!K)return;const e=j(b(g,"listing"),p("hostId","==",K.uid)),s=f(e,e=>{const s=e.docs.map(e=>({id:e.id,...e.data()}));ee(s)});return()=>s()},[K]),s.useEffect(()=>{if(!K)return;te(!0);const e=j(b(g,"bookings"),p("hostId","==",K.uid)),s=f(e,async e=>{const s=await Promise.all(e.docs.map(async e=>{const s={id:e.id,...e.data()};if(s.listingId){const e=N(g,"listing",s.listingId),t=await v(e);if(t.exists()){const e=t.data();s.listingTitle=e?.title,s.listingLocation=e?.location}}if(s.guestId){const e=N(g,"users",s.guestId),t=await v(e);t.exists()&&(s.guestName=t.data()?.fullName)}return s}));Z(s),te(!1)});return()=>s()},[K]);const ue=e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e.checkOut);return t.setHours(0,0,0,0),s>t&&"confirmed"===e.status?"bg-green-500":"confirmed"===e.status?"bg-blue-500":"pending"===e.status?"bg-orange-500":(e.status,"bg-gray-400")},je=e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e.checkOut);return t.setHours(0,0,0,0),s>t&&"confirmed"===e.status?"Successful":"confirmed"===e.status?"Upcoming":"pending"===e.status?"Pending":"cancelled"===e.status?"Cancelled":e.status},pe=e=>{ce(e),ge(!0)},be=(()=>{const e=re.getFullYear(),s=re.getMonth(),t=new Date(e,s,1),r=new Date(e,s+1,0).getDate(),a=t.getDay(),n=[];for(let i=0;a>i;i++)n.push(null);for(let i=1;r>=i;i++)n.push(new Date(e,s,i));return n})(),fe=re.toLocaleDateString("en-US",{month:"long",year:"numeric"}),Ne=()=>{let e=X.filter(e=>"cancelled"!==e.status);return"all"!==le&&(e=e.filter(e=>e.listingId===le)),e.sort((e,s)=>new Date(e.checkIn).getTime()-new Date(s.checkIn).getTime()),e};return t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx("header",{className:"border-b bg-card",children:t.jsx("div",{className:"container mx-auto px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-8",children:[t.jsx(a,{size:"sm"}),t.jsxs("nav",{className:"hidden md:flex items-center gap-6",children:[t.jsxs(n,{variant:"ghost",onClick:()=>J("/host/dashboard"),children:[t.jsx(G,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),t.jsxs(n,{variant:"ghost",onClick:()=>J("/host/listings"),children:[t.jsx(U,{className:"h-4 w-4 mr-2"}),"Listings"]}),t.jsxs(n,{variant:"default",children:[t.jsx(V,{className:"h-4 w-4 mr-2"}),"Calendar"]}),t.jsxs(n,{variant:"ghost",onClick:()=>J("/host/messages"),children:[t.jsx(Y,{className:"h-4 w-4 mr-2"}),"Messages"]})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(x,{}),t.jsx(u,{}),t.jsx(n,{variant:"outline",onClick:()=>he(!0),children:"Sign Out"})]})]})})}),t.jsxs("main",{className:"container mx-auto px-6 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Booking Calendar"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage your bookings and availability"})]}),t.jsx(i,{className:"mb-6",children:t.jsx(l,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(n,{variant:"outline",size:"icon",onClick:()=>{ae(new Date(re.getFullYear(),re.getMonth()-1))},children:t.jsx(E,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-xl font-semibold min-w-[200px] text-center",children:fe}),t.jsx(n,{variant:"outline",size:"icon",onClick:()=>{ae(new Date(re.getFullYear(),re.getMonth()+1))},children:t.jsx(q,{className:"h-4 w-4"})}),t.jsx(n,{variant:"outline",onClick:()=>{ae(new Date)},children:"Today"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(w,{value:le,onValueChange:oe,children:[t.jsxs(y,{className:"w-[200px]",children:[t.jsx(R,{className:"h-4 w-4 mr-2"}),t.jsx(k,{placeholder:"All Properties"})]}),t.jsxs(D,{children:[t.jsx(S,{value:"all",children:"All Properties"}),_.map(e=>t.jsx(S,{value:e.id,children:e.title},e.id))]})]}),t.jsxs("div",{className:"flex items-center gap-2 border rounded-md p-1",children:[t.jsxs(n,{variant:"month"===ne?"default":"ghost",size:"sm",onClick:()=>ie("month"),children:[t.jsx(U,{className:"h-4 w-4 mr-2"}),"Month"]}),t.jsxs(n,{variant:"list"===ne?"default":"ghost",size:"sm",onClick:()=>ie("list"),children:[t.jsx(W,{className:"h-4 w-4 mr-2"}),"List"]})]})]})]})})}),t.jsx(i,{className:"mb-6",children:t.jsx(l,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-4 sm:gap-6",children:[t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-primary/5 border border-primary/20 hover:bg-primary/10 transition-colors",children:[t.jsx("div",{className:"w-5 h-5 rounded-md border-2 border-primary bg-primary/10 flex items-center justify-center shadow-sm",children:t.jsx(V,{className:"h-3 w-3 text-primary"})}),t.jsx("span",{className:"text-sm font-semibold text-primary",children:"Today"})]}),t.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-blue-500/5 border border-blue-500/20 hover:bg-blue-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-blue-500 shadow-sm ring-2 ring-blue-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Upcoming"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-green-500/5 border border-green-500/20 hover:bg-green-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-green-500 shadow-sm ring-2 ring-green-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Successful"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-orange-500/5 border border-orange-500/20 hover:bg-orange-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-orange-500 shadow-sm ring-2 ring-orange-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Pending"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-gray-500/5 border border-gray-500/20 hover:bg-gray-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-gray-400 dark:bg-gray-500 shadow-sm ring-2 ring-gray-400/20 dark:ring-gray-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Cancelled"})]})]})})}),"month"===ne&&t.jsx(i,{children:t.jsxs(l,{className:"p-6",children:[t.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>t.jsx("div",{className:"text-center font-semibold text-sm py-2",children:e},e))}),t.jsx("div",{className:"grid grid-cols-7 gap-2",children:be.map((e,s)=>{const r=e?(e=>{if(!e)return[];e.toISOString().split("T")[0];let s=X.filter(s=>{if("cancelled"===s.status)return!1;const t=new Date(s.checkIn),r=new Date(s.checkOut);return t.setHours(0,0,0,0),r.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=t&&r>=e});return"all"!==le&&(s=s.filter(e=>e.listingId===le)),s})(e):[],a=e&&e.toDateString()===(new Date).toDateString();return t.jsx("div",{className:`\n                        min-h-[120px] border rounded-lg p-2 relative\n                        ${e?"bg-card hover:bg-muted/50 cursor-pointer":"bg-muted/20"}\n                        ${a?"border-primary border-2 bg-primary/5":""}\n                        transition-colors\n                      `,children:e&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"text-sm font-medium mb-2 flex items-center gap-1.5 "+(a?"text-primary font-bold":""),children:[t.jsx("span",{className:a?"text-base":"",children:e.getDate()}),a&&t.jsx("span",{className:"text-xs bg-primary text-primary-foreground px-2 py-0.5 rounded-md font-medium shadow-sm",children:"Today"})]}),t.jsxs("div",{className:"space-y-1.5",children:[r.slice(0,3).map((e,s)=>{const r=new Date;r.setHours(0,0,0,0);const a=new Date(e.checkOut);a.setHours(0,0,0,0);const n="completed"===e.status||r>a&&"confirmed"===e.status,i="confirmed"===e.status&&a>=r,l="pending"===e.status,o="cancelled"===e.status;return t.jsx("div",{className:`\n                                    text-xs px-2.5 py-1.5 rounded-md cursor-pointer \n                                    transition-all duration-200 hover:scale-[1.02] hover:shadow-md active:scale-[0.98]\n                                    truncate font-medium shadow-sm\n                                    ${n?"bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700 border border-green-400/30":i?"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 border border-blue-400/30":l?"bg-gradient-to-r from-orange-500 to-orange-600 text-white hover:from-orange-600 hover:to-orange-700 border border-orange-400/30":o?"bg-gradient-to-r from-gray-400 to-gray-500 dark:from-gray-500 dark:to-gray-600 text-white hover:from-gray-500 hover:to-gray-600 dark:hover:from-gray-600 dark:hover:to-gray-700 border border-gray-300/30 dark:border-gray-400/30":"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 border border-blue-400/30"}\n                                  `,onClick:()=>pe(e),title:`${e.listingTitle} - ${je(e)}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0 "+(n?"bg-green-200 ring-2 ring-green-300/50":i?"bg-blue-200 ring-2 ring-blue-300/50":l?"bg-orange-200 ring-2 ring-orange-300/50":o?"bg-gray-200 ring-2 ring-gray-300/50":"bg-blue-200 ring-2 ring-blue-300/50")}),t.jsx("span",{className:"truncate flex-1 leading-tight",children:e.listingTitle})]})},s)}),r.length>3&&t.jsxs("div",{className:"text-xs text-muted-foreground font-medium px-2.5 py-1.5 bg-muted/60 dark:bg-muted/40 rounded-md text-center border border-border/50 hover:bg-muted/80 transition-colors",children:["+",r.length-3," more"]})]})]})},s)})})]})}),"list"===ne&&t.jsxs(i,{children:[t.jsxs(o,{children:[t.jsx(d,{children:"All Bookings"}),t.jsxs(c,{children:[Ne().length," booking",1!==Ne().length?"s":""]})]}),t.jsx(l,{children:se?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading bookings..."}):0===Ne().length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(V,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No bookings found"})]}):t.jsx("div",{className:"space-y-4",children:Ne().map(e=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>pe(e),children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("h3",{className:"font-semibold",children:e.listingTitle}),t.jsx(h,{className:ue(e),children:je(e)})]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:["ðŸ“ ",e.listingLocation]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:["ðŸ‘¤ ",e.guestName||"Guest"]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["ðŸ“… ",new Date(e.checkIn).toLocaleDateString()," - ",new Date(e.checkOut).toLocaleDateString()]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-semibold text-lg",children:m(e.totalPrice||0)}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.guests," guest",1!==e.guests?"s":""]})]})]})},e.id))})})]})]}),t.jsx(C,{open:me,onOpenChange:ge,children:t.jsxs(I,{className:"max-w-2xl",children:[t.jsxs(T,{children:[t.jsx(L,{children:"Booking Details"}),t.jsx(O,{children:"View booking information"})]}),de&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold",children:de.listingTitle}),t.jsx(h,{className:ue(de),children:je(de)})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-in"}),t.jsx("p",{className:"font-medium",children:new Date(de.checkIn).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-out"}),t.jsx("p",{className:"font-medium",children:new Date(de.checkOut).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Guest"}),t.jsx("p",{className:"font-medium",children:de.guestName||"Guest"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Guests"}),t.jsx("p",{className:"font-medium",children:de.guests})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),t.jsx("p",{className:"font-medium text-lg",children:m(de.totalPrice||0)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Booking ID"}),t.jsxs("p",{className:"font-medium text-sm",children:[de.id.slice(0,8),"..."]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Location"}),t.jsx("p",{className:"font-medium",children:de.listingLocation})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(n,{variant:"default",className:"flex-1",onClick:()=>{J("/host/bookings"),ge(!1)},children:"View in Bookings"}),t.jsx(n,{variant:"outline",onClick:()=>ge(!1),children:"Close"})]})]})]})}),t.jsx(H,{open:xe,onOpenChange:he,children:t.jsxs(B,{children:[t.jsxs(P,{children:[t.jsx(M,{children:"Sign Out?"}),t.jsx($,{children:"Are you sure you want to sign out?"})]}),t.jsxs(z,{children:[t.jsx(A,{children:"Cancel"}),t.jsx(F,{onClick:async()=>{try{await Q(),J("/")}catch(e){}},children:"Sign Out"})]})]})})]})};export{J as default};
