const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-DaMaslBo.js","assets/js/react-vendor-Ve3SFwKO.js","assets/js/utils-vendor-DzY7Ay74.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-D9RGQy8n.js","assets/js/icons-vendor-Dhca6XHc.js","assets/js/firebase-vendor-BC71bXmb.js","assets/index-Bo0Pi70j.css"])))=>i.map(i=>d[i]);
import{u as s,j as i,_ as t,v as e,C as a,a as o,b as r,c as n,d as l,B as d,e as c,q as u,t as m}from"./index-DaMaslBo.js";import{u as f,r as g,j as h}from"./react-vendor-Ve3SFwKO.js";import{h as j,f as v}from"./firebase-vendor-BC71bXmb.js";import{L as p}from"./ListingCard-qYDZ01KR.js";import{E as x}from"./empty-state-BDfunuWx.js";import{B as w}from"./BackButton-uEV41aeK.js";import{p as y}from"./icons-vendor-Dhca6XHc.js";import"./ui-vendor-D9RGQy8n.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./badge-BSgvUoVt.js";const b=()=>{const b=f(),{user:L,hasRole:N}=s(),[B,F]=g.useState(null),[S,_]=g.useState([]),[k,E]=g.useState([]),[P,R]=g.useState([]),[A,C]=g.useState(!0);g.useEffect(()=>{!L||N("guest")?L?W():C(!1):b("/guest/login")},[L,b]),g.useEffect(()=>{L&&B&&(I(),D())},[L,B]);const W=async()=>{if(L)try{const s=await j(v(i,"users",L.uid));if(s.exists()){const i=s.data();F(i),E(i.favorites||[]),R(i.wishlist||[])}}catch(s){}finally{C(!1)}},D=async()=>{if(L)try{const s=await j(v(i,"users",L.uid));if(s.exists()){const i=s.data();R(i.wishlist||[])}}catch(s){}},I=async()=>{if(L&&B?.favorites?.length)try{const{getListing:s}=await t(async()=>{const{getListing:s}=await import("./index-DaMaslBo.js").then(s=>s.W);return{getListing:s}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),i=await Promise.all(B.favorites.map(i=>s(i)));_(i.filter(s=>null!==s))}catch(s){_([])}else _([])};return A?h.jsx(e,{}):h.jsx("div",{className:"min-h-screen bg-background",children:h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsx(w,{to:"/guest/dashboard",label:"Back to Dashboard",className:"mb-4 sm:mb-6"}),h.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Your Favorites"}),h.jsxs(a,{children:[h.jsxs(o,{children:[h.jsx(r,{children:"Your Favorites"}),h.jsx(n,{children:"Listings you've liked and saved"})]}),h.jsx(l,{children:0===S.length?h.jsx(x,{icon:h.jsx(y,{className:"h-10 w-10"}),title:"No favorites yet",description:"Start exploring and add listings to your favorites!",action:h.jsx(d,{onClick:()=>b("/guest/browse"),children:"Browse Listings"})}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map(s=>h.jsx(p,{listing:s,onView:()=>b("/guest/listing/"+s.id),onFavorite:()=>(async s=>{if(L)try{const i=await m(L.uid,s,k);E(i),F(s=>s?{...s,favorites:i}:null),I(),c.success(i.includes(s)?"Added to favorites":"Removed from favorites")}catch(i){c.error("Failed to update favorites")}else c.error("Please login to manage favorites")})(s.id),onWishlist:()=>(async s=>{if(L)try{const i=await u(L.uid,s,P);R(i),F(s=>s?{...s,wishlist:i}:null),c.success(i.includes(s)?"Added to wishlist":"Removed from wishlist")}catch(i){c.error("Failed to update wishlist")}else c.error("Please login to manage wishlist")})(s.id),isFavorite:k.includes(s.id),isInWishlist:P.includes(s.id)},s.id))})})]})]})})};export{b as default};
