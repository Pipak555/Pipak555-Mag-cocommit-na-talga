const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-F95ZJi6y.js","assets/js/react-vendor-DcULH_Au.js","assets/js/utils-vendor-yBsXXcRr.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-C9dhA_ey.js","assets/js/icons-vendor-D18eSOBA.js","assets/js/firebase-vendor-BtzXZj7S.js","assets/index-jZhKPZKM.css"])))=>i.map(i=>d[i]);
import{u as s,j as i,_ as t,s as e,B as a,C as r,a as o,b as n,c as l,d as c,e as d,o as u,t as m}from"./index-F95ZJi6y.js";import{u as h,r as f,j as g}from"./react-vendor-DcULH_Au.js";import{f as j,e as x}from"./firebase-vendor-BtzXZj7S.js";import{L as p}from"./ListingCard-D08Qz4_k.js";import{E as w}from"./empty-state-DNlvimib.js";import{A as v,Y as y}from"./icons-vendor-D18eSOBA.js";import"./ui-vendor-C9dhA_ey.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./badge-BPytCQbI.js";const b=()=>{const b=h(),{user:N,hasRole:L}=s(),[_,k]=f.useState(null),[A,E]=f.useState([]),[R,S]=f.useState([]),[W,C]=f.useState([]),[F,P]=f.useState(!0);f.useEffect(()=>{!N||L("guest")?N?B():P(!1):b("/guest/login")},[N,b]),f.useEffect(()=>{N&&_&&(D(),Y())},[N,_]);const B=async()=>{if(N)try{const s=await j(x(i,"users",N.uid));if(s.exists()){const i=s.data();k(i),S(i.favorites||[]),C(i.wishlist||[])}}catch(s){}finally{P(!1)}},Y=async()=>{if(N)try{const s=await j(x(i,"users",N.uid));if(s.exists()){const i=s.data();S(i.favorites||[])}}catch(s){}},D=async()=>{if(N&&_?.wishlist?.length)try{const{getListing:s}=await t(async()=>{const{getListing:s}=await import("./index-F95ZJi6y.js").then(s=>s.R);return{getListing:s}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),i=await Promise.all(_.wishlist.map(i=>s(i)));E(i.filter(s=>null!==s))}catch(s){E([])}else E([])};return F?g.jsx(e,{}):g.jsx("div",{className:"min-h-screen bg-background",children:g.jsxs("div",{className:"container mx-auto px-4 py-8",children:[g.jsx("div",{className:"flex items-center justify-between mb-6",children:g.jsxs(a,{variant:"ghost",onClick:()=>b("/guest/dashboard"),className:"flex items-center gap-2",children:[g.jsx(v,{className:"h-4 w-4"}),"Back to Dashboard"]})}),g.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Your Wishlist"}),g.jsxs(r,{children:[g.jsxs(o,{children:[g.jsx(n,{children:"Your Wishlist"}),g.jsx(l,{children:"Listings you're planning to book in the future"})]}),g.jsx(c,{children:0===A.length?g.jsx(w,{icon:g.jsx(y,{className:"h-10 w-10"}),title:"No wishlist items yet",description:"Add listings to your wishlist for future trips!",action:g.jsx(a,{onClick:()=>b("/guest/browse"),children:"Browse Listings"})}):g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(s=>g.jsx(p,{listing:s,onView:()=>b("/guest/listing/"+s.id),onFavorite:()=>(async s=>{if(N)try{const i=await m(N.uid,s,R);S(i),k(s=>s?{...s,favorites:i}:null),d.success(i.includes(s)?"Added to favorites":"Removed from favorites")}catch(i){d.error("Failed to update favorites")}else d.error("Please login to manage favorites")})(s.id),onWishlist:()=>(async s=>{if(N)try{const i=await u(N.uid,s,W);C(i),k(s=>s?{...s,wishlist:i}:null),D(),d.success(i.includes(s)?"Added to wishlist":"Removed from wishlist")}catch(i){d.error("Failed to update wishlist")}else d.error("Please login to manage wishlist")})(s.id),isFavorite:R.includes(s.id),isInWishlist:W.includes(s.id)},s.id))})})]})]})})};export{b as default};
