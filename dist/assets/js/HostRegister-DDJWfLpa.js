import{u as e,i as s,r as a,j as t}from"./react-vendor-Ve3SFwKO.js";import{u as r,B as l,C as c,b as i,c as n,e as o,d,i as m,a as h}from"./index-BnushFQy.js";import{getAvailablePlans as x,getPlanById as u}from"./billingService-BIHIVurG.js";import{H as p,X as j,Z as g,h as f,af as N,A as v,o as y}from"./icons-vendor-DD8ZfUKZ.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-D9RGQy8n.js";import"./firebase-vendor-BC71bXmb.js";const b=()=>{const b=e(),w=s(),{user:C,signUp:S,signInWithGoogle:P,hasRole:I}=r(),[k,A]=a.useState("plan"),[z,H]=a.useState(null),[R,Y]=a.useState(!1),D="dashboard"===w.state?.from||document.referrer.includes("/host/dashboard"),M=x();a.useEffect(()=>{sessionStorage.getItem("hostPolicyAccepted")||(C&&I("host")?sessionStorage.setItem("hostPolicyAccepted","true"):b("/host/policies",{state:{returnTo:"/host/register",planId:new URLSearchParams(window.location.search).get("planId"),from:D?"dashboard":void 0}}))},[b,C,I,D]),a.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("planId");C&&I("host")&&e&&u(e)&&b("/host/payment?planId="+e,{state:{from:D?"dashboard":void 0}})},[C,I,b,D]);const B=e=>{H(e),C&&I("host")?b("/host/payment?planId="+e.id,{state:{from:D?"dashboard":w.state?.from}}):A("account")},E=()=>{z?b("/host/payment?planId="+z.id,{state:{from:D?"dashboard":w.state?.from}}):(h.error("Please select a plan first"),A("plan"))};C&&z&&"account"===k&&E();const G=()=>{"account"===k?(A("plan"),H(null)):"payment"===k&&A("account")};return t.jsx("div",{className:"min-h-screen bg-background",children:t.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx(l,{variant:"ghost",size:"icon",onClick:()=>{C&&I("host")?b("/host/dashboard"):b(D?"/host/dashboard":"/")},children:t.jsx(p,{className:"h-4 w-4"})}),t.jsxs(l,{variant:"ghost",onClick:()=>{window.confirm("Are you sure you want to exit registration? Your progress will be saved.")&&(C&&I("host")?b("/host/dashboard"):b(D?"/host/dashboard":"/"))},className:"gap-2 text-muted-foreground hover:text-destructive",children:[t.jsx(j,{className:"h-4 w-4"}),"Exit"]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs(c,{children:[t.jsx(i,{children:t.jsx(n,{className:"text-lg",children:"Registration Progress"})}),t.jsxs(o,{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"mt-1",children:t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-primary",children:"plan"!==k?t.jsx(g,{className:"h-4 w-4 text-primary-foreground"}):t.jsx("span",{className:"text-xs font-bold text-primary-foreground",children:"1"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:"1. Choose Plan"}),t.jsx("div",{className:"text-sm text-muted-foreground",children:"Select your hosting package."})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"mt-1",children:t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center "+("account"===k||"payment"===k?"bg-primary":"bg-muted"),children:"payment"===k?t.jsx(g,{className:"h-4 w-4 text-primary-foreground"}):"account"===k?t.jsx("span",{className:"text-xs font-bold text-primary-foreground",children:"2"}):t.jsx("span",{className:"text-xs font-bold text-muted-foreground",children:"2"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:"2. Create Account"}),t.jsx("div",{className:"text-sm text-muted-foreground",children:"Set up your host profile."})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"mt-1",children:t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center "+("payment"===k?"bg-primary":"bg-muted"),children:"payment"===k?t.jsx(f,{className:"h-4 w-4 text-primary-foreground"}):t.jsx("span",{className:"text-xs font-bold text-muted-foreground",children:"3"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:"3. Payment"}),t.jsx("div",{className:"text-sm text-muted-foreground",children:"Connect PayPal & pay."})]})]}),t.jsxs("div",{className:"pt-4",children:[t.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Progress"}),t.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:t.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:"plan"===k?"33%":"account"===k?"66%":"100%"}})}),t.jsx("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:"plan"===k?"33%":"account"===k?"66%":"100%"})]})]})]})}),t.jsxs("div",{className:"lg:col-span-2",children:["plan"===k&&t.jsxs(c,{children:[t.jsxs(i,{children:[t.jsx(n,{children:"Choose Your Plan"}),t.jsx(d,{children:"Select a hosting package that fits your needs"})]}),t.jsx(o,{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:M.map(e=>t.jsxs(c,{className:"cursor-pointer transition-all hover:border-primary "+(z?.id===e.id?"border-primary border-2":""),onClick:()=>B(e),children:[t.jsxs(i,{children:[t.jsx(n,{className:"text-xl",children:e.name}),t.jsx(d,{children:e.description})]}),t.jsxs(o,{children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("span",{className:"text-3xl font-bold",children:m(e.price)}),t.jsxs("span",{className:"text-muted-foreground",children:["/",e.billingCycle]})]}),t.jsx("ul",{className:"space-y-2 mb-4",children:e.features.map((e,s)=>t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx(g,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),t.jsx("span",{className:"text-sm",children:e})]},s))}),t.jsxs(l,{className:"w-full",variant:z?.id===e.id?"default":"outline",onClick:()=>B(e),children:["Select Plan",t.jsx(N,{className:"h-4 w-4 ml-2"})]})]})]},e.id))})})]}),"account"===k&&t.jsxs(c,{children:[t.jsx(i,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(n,{children:"Create Your Account"}),t.jsx(d,{children:"Sign up to start hosting. You can also sign in if you already have an account."})]}),t.jsx(l,{variant:"ghost",size:"icon",onClick:G,className:"ml-auto",children:t.jsx(v,{className:"h-4 w-4"})})]})}),t.jsxs(o,{className:"space-y-4",children:[t.jsxs(l,{variant:"ghost",onClick:G,className:"mb-4 -ml-2",children:[t.jsx(v,{className:"h-4 w-4 mr-2"}),"Back to Plan Selection"]}),t.jsxs("div",{className:"text-center py-8",children:[t.jsx(y,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),t.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Ready to Start Hosting?"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:z&&`You've selected the ${z.name} plan (${m(z.price)}/${z.billingCycle}).`}),t.jsxs("div",{className:"space-y-3 max-w-md mx-auto",children:[t.jsxs(l,{className:"w-full",onClick:()=>b("/host/login",{state:{showSignup:!0,planId:z?.id}}),children:["Create Account",t.jsx(N,{className:"h-4 w-4 ml-2"})]}),t.jsxs(l,{variant:"outline",className:"w-full",onClick:async()=>{if(!sessionStorage.getItem("hostPolicyAccepted"))return h.error("To create a host account, you must first read and accept our policies and compliance terms. Please review them and accept before continuing."),void b("/host/policies",{state:{returnTo:"/host/register",planId:z?.id}});Y(!0);try{const e=sessionStorage.getItem("hostPolicyAcceptedDate")||(new Date).toISOString();await P("host",{policyAccepted:!0,policyAcceptedDate:e}),sessionStorage.removeItem("hostPolicyAccepted"),sessionStorage.removeItem("hostPolicyAcceptedDate"),E()}catch(e){h.error(e.message||"Failed to sign up with Google")}finally{Y(!1)}},disabled:R,children:[t.jsxs("svg",{className:"h-4 w-4 mr-2",viewBox:"0 0 24 24",children:[t.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),t.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),t.jsxs("div",{className:"text-sm text-muted-foreground text-center pt-4",children:["Already have an account?"," ",t.jsx(l,{variant:"link",className:"p-0 h-auto",onClick:()=>b("/host/login",{state:{planId:z?.id}}),children:"Sign in"})]})]})]})]})]})]})]})]})})};export{b as default};
