const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-DaMaslBo.js","assets/js/react-vendor-Ve3SFwKO.js","assets/js/utils-vendor-DzY7Ay74.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-D9RGQy8n.js","assets/js/icons-vendor-Dhca6XHc.js","assets/js/firebase-vendor-BC71bXmb.js","assets/index-Bo0Pi70j.css"])))=>i.map(i=>d[i]);
import{u as e,j as s,_ as t,v as i,C as r,a as o,b as a,c as n,d as l,B as d,e as c,q as m,t as u}from"./index-DaMaslBo.js";import{u as p,r as x,j as h}from"./react-vendor-Ve3SFwKO.js";import{h as b,f as j}from"./firebase-vendor-BC71bXmb.js";import{L as f}from"./ListingCard-qYDZ01KR.js";import{E as g}from"./empty-state-BDfunuWx.js";import{B as y}from"./BackButton-uEV41aeK.js";import{q as v}from"./icons-vendor-Dhca6XHc.js";import"./ui-vendor-D9RGQy8n.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./badge-BSgvUoVt.js";const w=()=>{const w=p(),{user:R,hasRole:N}=e(),[k,q]=x.useState(null),[A,B]=x.useState([]),[L,_]=x.useState([]),[E,I]=x.useState([]),[S,W]=x.useState(!0);x.useEffect(()=>{!R||N("guest")?R?F():W(!1):w("/guest/login")},[R,w]),x.useEffect(()=>{R&&k&&(C(),P())},[R,k]);const F=async()=>{if(R)try{const e=await b(j(s,"users",R.uid));if(e.exists()){const s=e.data();q(s),_(s.favorites||[]),I(s.wishlist||[])}}catch(e){}finally{W(!1)}},P=async()=>{if(R)try{const e=await b(j(s,"users",R.uid));if(e.exists()){const s=e.data();_(s.favorites||[])}}catch(e){}},C=async()=>{if(R&&k?.wishlist?.length)try{const{getListing:e}=await t(async()=>{const{getListing:e}=await import("./index-DaMaslBo.js").then(e=>e.W);return{getListing:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),s=k.wishlist.map(e=>"string"==typeof e?e:e.listingId),i=await Promise.all(s.map(s=>e(s)));B(i.filter(e=>null!==e))}catch(e){B([])}else B([])};return S?h.jsx(i,{}):h.jsx("div",{className:"min-h-screen bg-background",children:h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsx(y,{to:"/guest/dashboard",label:"Back to Dashboard",className:"mb-4 sm:mb-6"}),h.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Your Wishlist"}),h.jsxs(r,{children:[h.jsxs(o,{children:[h.jsx(a,{children:"Your Wishlist"}),h.jsx(n,{children:"Listings you're planning to book in the future"})]}),h.jsx(l,{children:0===A.length?h.jsx(g,{icon:h.jsx(v,{className:"h-10 w-10"}),title:"No wishlist items yet",description:"Add listings to your wishlist for future trips!",action:h.jsx(d,{onClick:()=>w("/guest/browse"),children:"Browse Listings"})}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(e=>{const s=E.find(s=>"string"==typeof s?s===e.id:s.listingId===e.id),t="object"==typeof s&&s?.recommendations,i=E.some(s=>"string"==typeof s?s===e.id:s.listingId===e.id);return h.jsxs("div",{className:"space-y-2",children:[h.jsx(f,{listing:e,onView:()=>w("/guest/listing/"+e.id),onFavorite:()=>(async e=>{if(R)try{const s=await u(R.uid,e,L);_(s),q(e=>e?{...e,favorites:s}:null),c.success(s.includes(e)?"Added to favorites":"Removed from favorites")}catch(s){c.error("Failed to update favorites")}else c.error("Please login to manage favorites")})(e.id),onWishlist:()=>(async e=>{if(R)try{const s=await m(R.uid,e,E);I(s),q(e=>e?{...e,wishlist:s}:null),C(),c.success(s.includes(e)?"Added to wishlist":"Removed from wishlist")}catch(s){c.error("Failed to update wishlist")}else c.error("Please login to manage wishlist")})(e.id),isFavorite:L.includes(e.id),isInWishlist:i}),(t||"object"==typeof s&&s?.propertyRequirements||"object"==typeof s&&s?.desiredAmenities)&&h.jsx(r,{className:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800",children:h.jsxs(l,{className:"p-3 space-y-2",children:["object"==typeof s&&s?.propertyRequirements&&Object.keys(s.propertyRequirements).length>0&&h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-semibold text-blue-900 dark:text-blue-100 mb-1",children:"Requirements:"}),h.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1",children:[s.propertyRequirements.beds&&h.jsxs("p",{children:["• Beds: ",s.propertyRequirements.beds]}),s.propertyRequirements.bedrooms&&h.jsxs("p",{children:["• Bedrooms: ",s.propertyRequirements.bedrooms]}),s.propertyRequirements.bathrooms&&h.jsxs("p",{children:["• Bathrooms: ",s.propertyRequirements.bathrooms]}),s.propertyRequirements.guests&&h.jsxs("p",{children:["• Guests: ",s.propertyRequirements.guests]})]})]}),"object"==typeof s&&s?.desiredAmenities&&s.desiredAmenities.length>0&&h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-semibold text-blue-900 dark:text-blue-100 mb-1",children:"Desired Amenities:"}),h.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:s.desiredAmenities.join(", ")})]}),t&&h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-semibold text-blue-900 dark:text-blue-100 mb-1",children:"Recommendations:"}),h.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:t})]})]})})]},e.id)})})})]})]})})};export{w as default};
