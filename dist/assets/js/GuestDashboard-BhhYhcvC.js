const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-F95ZJi6y.js","assets/js/react-vendor-DcULH_Au.js","assets/js/utils-vendor-yBsXXcRr.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-C9dhA_ey.js","assets/js/icons-vendor-D18eSOBA.js","assets/js/firebase-vendor-BtzXZj7S.js","assets/index-jZhKPZKM.css"])))=>i.map(i=>d[i]);
import{u as e,j as s,h as t,k as a,L as r,B as i,C as o,a as l,b as n,d as c,i as d,c as m,e as h,_ as x,t as g}from"./index-F95ZJi6y.js";import{u,r as p,j as v}from"./react-vendor-DcULH_Au.js";import{N as j}from"./NotificationBell-DGLwxi-L.js";import{h as f,C as b,a as w,e as N,s as y}from"./category-service-B_GP7yWM.js";import{V as k}from"./video-background-D2BJi4ly.js";import{T as C}from"./theme-toggle-CJqSL7LK.js";import{L as B}from"./ListingCard-D08Qz4_k.js";import{getRecommendations as S}from"./recommendations-Brf4yw9Y.js";import{k as R,e as W,f as A}from"./firebase-vendor-BtzXZj7S.js";import{A as O,a as z,b as D,c as F,d as I,e as P,f as _,g as L}from"./alert-dialog-Ce5W9-KF.js";import{o as T,B as V,H as E,b as Y,W as G,p as H,q as M,i as q,r as K,n as U}from"./icons-vendor-D18eSOBA.js";import"./ui-vendor-C9dhA_ey.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./scroll-area-CWYRPkzZ.js";import"./badge-BPytCQbI.js";import"./dropdown-menu-C4xHPRIa.js";const X=()=>{const{user:X,userRole:Z,userProfile:J,signOut:Q,hasRole:$,addRole:ee}=e(),se=u(),[te,ae]=p.useState({favorites:0,wishlist:0,upcomingTrips:0,pastBookings:0,walletBalance:0}),[re,ie]=p.useState([]),[oe,le]=p.useState([]),[ne,ce]=p.useState(!0),[de,me]=p.useState(!1);p.useEffect(()=>{if(!X||!$("guest"))return void se("/guest/login");he();const e=R(W(s,"users",X.uid),e=>{if(e.exists()){const s=e.data();ae(e=>({...e,favorites:s.favorites?.length||0,wishlist:s.wishlist?.length||0,walletBalance:s.walletBalance||0})),le(s.favorites||[])}});return()=>{e()}},[X,Z,se]);const he=async()=>{if(X){ce(!0);try{const e=await t({guestId:X.uid}),s=new Date,r=e.filter(e=>new Date(e.checkIn)>=s&&"confirmed"===e.status).length,i=e.filter(e=>{const t=new Date(e.checkOut);return s>t||"completed"===e.status}).length;ae(e=>({...e,upcomingTrips:r,pastBookings:i}));const o=await S(X.uid,6);if(o.length>0){const e=o.map(e=>e.id),s=await a(e),t=o.map(e=>{const t=s.get(e.id);return{...e,averageRating:t?.averageRating||0,reviewCount:t?.reviewCount||0}});ie(t)}else ie(o)}catch(e){}finally{ce(!1)}}},xe=async()=>{$("host")?se("/host/dashboard"):se("/host/policies")};return v.jsxs("div",{className:"min-h-screen bg-background",children:[v.jsx("header",{className:"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 shadow-soft",children:v.jsxs("div",{className:"container mx-auto px-6 py-4 flex justify-between items-center",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(r,{size:"sm"}),v.jsx("div",{className:"p-2 rounded-lg bg-secondary/10",children:v.jsx(T,{className:"w-5 h-5 text-secondary"})}),v.jsxs("div",{children:[v.jsxs("h1",{className:"text-lg font-bold",children:["Welcome, ",J?.fullName||"Guest","!"]}),v.jsx("p",{className:"text-xs text-muted-foreground",children:"Discover your next adventure"})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(j,{}),v.jsx(C,{}),v.jsx(i,{variant:"outline",onClick:()=>me(!0),children:"Sign Out"})]})]})}),v.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[v.jsxs("div",{className:"relative mb-8 rounded-xl overflow-hidden h-64 md:h-80 lg:h-96 shadow-lg",children:[v.jsx(k,{src:"/videos/landing-hero.mp4",overlay:!0,fallbackImage:f}),v.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/60 via-black/40 to-black/60 z-10"}),v.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent z-10"}),v.jsxs("div",{className:"relative z-20 h-full flex flex-col items-center justify-center text-center px-6",children:[v.jsx("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold mb-4 text-white drop-shadow-2xl",children:"Discover Your Next Adventure"}),v.jsxs("p",{className:"text-lg md:text-xl text-white/90 mb-6 max-w-2xl drop-shadow-lg",children:["Welcome back, ",J?.fullName||"Guest","! Ready to explore amazing places?"]}),v.jsx(i,{size:"lg",className:"h-12 px-8 text-lg bg-primary hover:bg-primary/90 shadow-2xl hover:shadow-2xl hover:scale-105 transition-all",onClick:()=>se("/guest/browse"),children:"Browse All Listings"})]})]}),v.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8 "+($("host")?"lg:grid-cols-5":"lg:grid-cols-6"),children:[v.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer hover:scale-105 active:scale-100",onClick:()=>se("/guest/favorites"),children:[v.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary via-secondary to-accent"}),v.jsx(l,{className:"pb-3",children:v.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Favorites"})}),v.jsx(c,{children:v.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-primary to-primary-glow bg-clip-text text-transparent",children:te.favorites})})]}),v.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer hover:scale-105 active:scale-100",onClick:()=>se("/guest/wishlist"),children:[v.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 via-blue-400 to-blue-300"}),v.jsx(l,{className:"pb-3",children:v.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Wishlist"})}),v.jsx(c,{children:v.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-blue-500 to-blue-600 bg-clip-text text-transparent",children:te.wishlist})})]}),v.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>se("/guest/bookings?filter=upcoming"),children:[v.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-primary to-accent"}),v.jsx(l,{className:"pb-3",children:v.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Upcoming Trips"})}),v.jsx(c,{children:v.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-secondary to-secondary/80 bg-clip-text text-transparent",children:te.upcomingTrips})})]}),v.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>se("/guest/bookings?filter=past"),children:[v.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-accent via-primary to-secondary"}),v.jsx(l,{className:"pb-3",children:v.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Past Bookings"})}),v.jsx(c,{children:v.jsx("div",{className:"text-3xl font-bold",children:te.pastBookings})})]}),v.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group",children:[v.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-accent via-green-500 to-green-600"}),v.jsx(l,{className:"pb-3",children:v.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Wallet Balance"})}),v.jsx(c,{children:v.jsx("div",{className:"text-3xl font-bold text-accent",children:d(te.walletBalance)})})]}),!$("host")&&v.jsxs(o,{className:"relative overflow-hidden border-2 border-secondary/30 shadow-lg hover:shadow-xl transition-all duration-300 group cursor-pointer bg-gradient-to-br from-secondary/5 to-secondary/10",onClick:xe,children:[v.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-secondary/80 to-secondary/60"}),v.jsx(l,{className:"pb-3",children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(V,{className:"w-5 h-5 text-secondary"}),v.jsx(n,{className:"text-sm font-medium text-secondary uppercase tracking-wide",children:"Become a Host"})]})}),v.jsxs(c,{children:[v.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Start earning by hosting your property"}),v.jsx(i,{variant:"secondary",className:"w-full",onClick:e=>{e.stopPropagation(),xe()},children:"Get Started"})]})]})]}),v.jsxs("div",{className:"mb-8",children:[v.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Browse Categories"}),v.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[v.jsx(b,{videoSrc:"/videos/category-home.mp4",fallbackImage:w,icon:E,title:"Homes",description:"Find your perfect stay",href:"/guest/browse?category=home",colorClass:"primary"}),v.jsx(b,{videoSrc:"/videos/category-experience.mp4",fallbackImage:N,icon:Y,title:"Experiences",description:"Discover unique activities",href:"/guest/browse?category=experience",colorClass:"secondary"}),v.jsx(b,{videoSrc:"/videos/category-service.mp4",fallbackImage:y,icon:G,title:"Services",description:"Professional assistance",href:"/guest/browse?category=service",colorClass:"accent"})]})]}),re.length>0&&v.jsxs("div",{className:"mb-8",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(H,{className:"w-6 h-6 text-primary"}),v.jsx("h3",{className:"text-2xl font-bold",children:"Recommended for You"})]}),v.jsx(i,{variant:"outline",onClick:()=>se("/guest/browse"),children:"View All"})]}),v.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 items-stretch",children:re.slice(0,3).map(e=>v.jsx(B,{listing:e,onView:()=>se("/guest/listing/"+e.id),onFavorite:()=>(async e=>{if(X)try{const s=await g(X.uid,e,oe);le(s),h.success(s.includes(e)?"Added to favorites":"Removed from favorites")}catch(s){h.error("Failed to update favorites")}else h.error("Please login to add favorites")})(e.id),onWishlist:()=>(async e=>{if(X)try{const{toggleWishlist:t}=await x(async()=>{const{toggleWishlist:e}=await import("./index-F95ZJi6y.js").then(e=>e.R);return{toggleWishlist:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),a=await A(W(s,"users",X.uid)),r=a.exists()&&a.data().wishlist||[],i=await t(X.uid,e,r);h.success(i.includes(e)?"Added to wishlist":"Removed from wishlist")}catch(t){h.error("Failed to update wishlist")}else h.error("Please login to add to wishlist")})(e.id),isFavorite:oe.includes(e.id)},e.id))})]}),v.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[v.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>se("/guest/favorites"),children:v.jsxs(l,{children:[v.jsx(M,{className:"w-8 h-8 text-primary mb-2"}),v.jsx(n,{children:"Favorites"}),v.jsx(m,{children:"Your saved listings"})]})}),v.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>se("/guest/bookings"),children:v.jsxs(l,{children:[v.jsx(q,{className:"w-8 h-8 text-secondary mb-2"}),v.jsx(n,{children:"My Bookings"}),v.jsx(m,{children:"View your trips"})]})}),v.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>se("/guest/wallet"),children:v.jsxs(l,{children:[v.jsx(K,{className:"w-8 h-8 text-accent mb-2"}),v.jsx(n,{children:"E-Wallet"}),v.jsx(m,{children:"Manage your balance"})]})}),v.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>se("/guest/settings"),children:v.jsxs(l,{children:[v.jsx(U,{className:"w-8 h-8 text-muted-foreground mb-2"}),v.jsx(n,{children:"Settings"}),v.jsx(m,{children:"Account preferences"})]})})]})]}),v.jsx(O,{open:de,onOpenChange:me,children:v.jsxs(z,{children:[v.jsxs(D,{children:[v.jsx(F,{children:"Sign Out"}),v.jsx(I,{children:"Are you sure you want to sign out? You'll need to sign in again to access your account."})]}),v.jsxs(P,{children:[v.jsx(_,{children:"Cancel"}),v.jsx(L,{onClick:async()=>{await Q(),se("/")},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sign Out"})]})]})})]})};export{X as default};
