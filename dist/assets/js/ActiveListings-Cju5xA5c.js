import{u as e,r as s,j as a}from"./react-vendor-BMVo5gto.js";import{u as t,o as l,e as i,B as r,v as n,i as o,y as c,p as d,E as m}from"./index-Bl4WVUm9.js";import{L as h}from"./ListingCard-CV_xDRBJ.js";import{T as x}from"./textarea-BOgKdTrJ.js";import{L as u}from"./label-CNgDwY3J.js";import{D as g,a as p,b as j,c as f,d as b,e as N}from"./dialog-DVuhSEXh.js";import{B as v}from"./badge-_91-i8yA.js";import{S as w}from"./separator-B1Y9EFTv.js";import{A as y,a7 as k,$ as C,a0 as z,a1 as S,o as A,M as L,u as I,m as D,U as P,w as F,x as B,H as T,X as $}from"./icons-vendor-BQMxNFbQ.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-Dbp4DHG_.js";import"./firebase-vendor-BtzXZj7S.js";const E=()=>{const E=e(),{user:O}=t(),[U,V]=s.useState([]),[q,G]=s.useState(!0),[H,M]=s.useState(!1),[R,Y]=s.useState(null),[X,Z]=s.useState(""),[J,K]=s.useState(null),[Q,W]=s.useState(null),[_,ee]=s.useState(!1),[se,ae]=s.useState(!1),[te,le]=s.useState(!1),[ie,re]=s.useState(!1),[ne,oe]=s.useState(0),[ce,de]=s.useState([]),[me,he]=s.useState(0);s.useEffect(()=>{xe()},[]);const xe=async()=>{try{G(!0);const e=await l({status:"approved"});V(e)}catch(e){i.error("Failed to load active listings: "+(e.message||"Unknown error"))}finally{G(!1)}},ue=e=>{Y(e),Z(""),M(!0)};return a.jsxs("div",{className:"min-h-screen bg-background p-4 sm:p-6",children:[a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs(r,{variant:"ghost",onClick:()=>E("/admin/dashboard"),className:"mb-4 sm:mb-6 h-10 sm:h-auto",children:[a.jsx(y,{className:"h-4 w-4 mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Back to Dashboard"}),a.jsx("span",{className:"sm:hidden",children:"Back"})]}),a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-4 sm:mb-6",children:"Active Listings"}),q?a.jsx(n,{}):0===U.length?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-muted-foreground",children:"No active listings"})}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:U.map(e=>a.jsxs("div",{className:"cursor-pointer",onClick:()=>(async e=>{if(K(e),ee(!0),he(0),ae(!0),e.hostId)try{const s=await c(e.hostId);W(s?{fullName:s.fullName||"N/A",email:s.email||"N/A"}:{fullName:"N/A",email:"N/A"})}catch(s){W({fullName:"Error loading",email:"Error loading"})}finally{ae(!1)}else W({fullName:"N/A",email:"N/A"}),ae(!1)})(e),children:[a.jsx(h,{listing:e}),a.jsx("div",{className:"mt-2 flex gap-2",onClick:e=>e.stopPropagation(),children:a.jsxs(r,{variant:"destructive",size:"sm",className:"flex-1 h-11 sm:h-auto text-sm sm:text-base touch-manipulation",onClick:()=>ue(e),children:[a.jsx(k,{className:"h-4 w-4 mr-2"}),"Delete"]})})]},e.id))})]}),a.jsx(g,{open:H,onOpenChange:M,children:a.jsxs(p,{className:"max-w-2xl",children:[a.jsxs(j,{children:[a.jsxs(f,{className:"text-2xl flex items-center gap-2",children:[a.jsx(k,{className:"h-6 w-6 text-destructive"}),"Delete Listing"]}),a.jsxs(b,{children:['You are about to delete the listing "',R?.title,'". Please provide a reason for deletion. This message will be sent to the host.']})]}),R&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Listing to delete:"}),a.jsx("p",{className:"font-semibold",children:R.title}),a.jsx("p",{className:"text-sm text-muted-foreground",children:R.location})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(u,{htmlFor:"delete-reason",className:"text-base font-semibold",children:["Reason for Deletion ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsx(x,{id:"delete-reason",placeholder:"Please explain why this listing is being deleted. This message will be sent to the host...",value:X,onChange:e=>Z(e.target.value),className:"min-h-[120px]",required:!0}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This message will be sent to the host through the messaging system."})]})]}),a.jsxs(N,{children:[a.jsx(r,{variant:"outline",onClick:()=>{M(!1),Y(null),Z("")},disabled:te,children:"Cancel"}),a.jsx(r,{variant:"destructive",onClick:async()=>{if(R&&O)if(X.trim()){le(!0);try{if(await d(R.id),R.hostId)try{const e=`Your listing "${R.title}" has been deleted by an administrator.\n\nReason: ${X.trim()}\n\nIf you have any questions or concerns, please contact support.`;await m({senderId:O.uid,receiverId:R.hostId,content:e,read:!1}),i.success("Listing deleted and host notified")}catch(e){i.success("Listing deleted, but failed to notify host. Please contact them manually.")}else i.success("Listing deleted");await xe(),Y(null),Z("")}catch(s){i.error("Failed to delete listing: "+(s.message||"Unknown error"))}finally{le(!1),M(!1)}}else i.error("Please provide a reason for deletion")},disabled:te||!X.trim(),children:te?"Deleting...":"Delete Listing"})]})]})}),a.jsx(g,{open:_,onOpenChange:ee,children:a.jsxs(p,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(j,{children:[a.jsx(f,{className:"text-2xl",children:J?.title}),a.jsx(b,{children:"View full listing details and host information"})]}),J&&a.jsxs("div",{className:"space-y-6",children:[J.images&&J.images.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"relative w-full h-[400px] rounded-lg overflow-hidden group bg-muted cursor-pointer",onClick:()=>{de(J.images),oe(me),re(!0)},children:[a.jsx("div",{className:"flex transition-transform duration-500 ease-in-out h-full",style:{transform:`translateX(-${100*me}%)`},children:J.images.map((e,s)=>a.jsx("div",{className:"min-w-full h-full flex-shrink-0 relative",children:a.jsx("img",{src:e||"/placeholder.svg",alt:`${J.title} - Image ${s+1}`,className:"w-full h-full object-cover"})},s))}),J.images.length>1&&a.jsxs(a.Fragment,{children:[a.jsx(r,{variant:"secondary",size:"icon",className:"absolute left-4 top-1/2 -translate-y-1/2 opacity-80 hover:opacity-100 transition-opacity bg-black/70 hover:bg-black/90 text-white border-none z-10 shadow-lg backdrop-blur-sm h-10 w-10",onClick:e=>{e.stopPropagation(),he(e=>0===e?J.images.length-1:e-1)},"aria-label":"Previous image",children:a.jsx(C,{className:"h-5 w-5"})}),a.jsx(r,{variant:"secondary",size:"icon",className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-80 hover:opacity-100 transition-opacity bg-black/70 hover:bg-black/90 text-white border-none z-10 shadow-lg backdrop-blur-sm h-10 w-10",onClick:e=>{e.stopPropagation(),he(e=>e===J.images.length-1?0:e+1)},"aria-label":"Next image",children:a.jsx(z,{className:"h-5 w-5"})}),a.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white px-3 py-1.5 rounded-full text-xs font-medium backdrop-blur-sm z-10 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx(S,{className:"h-3 w-3 inline mr-1"}),"Click to zoom"]}),a.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/70 text-white px-4 py-1.5 rounded-full text-sm font-medium backdrop-blur-sm z-10",children:[me+1," / ",J.images.length]})]})]}),J.images.length>1&&a.jsx("div",{className:"relative",children:a.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-2 snap-x snap-mandatory",children:J.images.map((e,s)=>a.jsx("button",{onClick:()=>he(s),className:"relative flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-all snap-start "+(me===s?"border-primary ring-2 ring-primary/50 scale-105":"border-transparent hover:border-border opacity-70 hover:opacity-100"),children:a.jsx("img",{src:e,alt:"Thumbnail "+(s+1),className:"w-full h-full object-cover"})},s))})})]}),a.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[a.jsx(A,{className:"h-5 w-5"}),"Host Information"]}),se?a.jsx("p",{className:"text-muted-foreground",children:"Loading host information..."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(A,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium",children:"Name:"}),a.jsx("span",{children:Q?.fullName||"N/A"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(L,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium",children:"Email:"}),a.jsx("a",{href:"mailto:"+(Q?.email||""),className:"text-primary hover:underline",children:Q?.email||"N/A"})]})]})]}),a.jsx(w,{}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[a.jsx(I,{className:"h-5 w-5"}),"Location"]}),a.jsx("p",{className:"text-muted-foreground",children:J.location})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),a.jsx("p",{className:"text-muted-foreground whitespace-pre-wrap",children:J.description})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Price"}),a.jsxs("p",{className:"font-semibold",children:[o(J.price),"/night"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(P,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Max Guests"}),a.jsx("p",{className:"font-semibold",children:J.maxGuests})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(F,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Bedrooms"}),a.jsx("p",{className:"font-semibold",children:J.bedrooms||"N/A"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(B,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Bathrooms"}),a.jsx("p",{className:"font-semibold",children:void 0!==J.bathrooms?J.bathrooms:"N/A"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(T,{className:"h-5 w-5 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Category"}),a.jsx(v,{variant:"secondary",children:J.category})]})]}),J.amenities&&J.amenities.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Amenities"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:J.amenities.map((e,s)=>a.jsx(v,{variant:"outline",children:e},s))})]})]}),a.jsx(w,{}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(r,{variant:"outline",onClick:()=>ee(!1),children:"Close"}),a.jsxs(r,{variant:"destructive",onClick:()=>{ee(!1),ue(J)},children:[a.jsx(k,{className:"h-4 w-4 mr-2"}),"Delete Listing"]})]})]})]})}),a.jsx(g,{open:ie,onOpenChange:re,children:a.jsxs(p,{className:"max-w-[98vw] max-h-[98vh] w-auto h-auto p-0 bg-black/95 border-none m-1",children:[a.jsx(f,{className:"sr-only",children:"View Full Size Image"}),a.jsxs(b,{className:"sr-only",children:["Viewing image ",ne+1," of ",ce.length]}),a.jsx("div",{className:"relative w-full h-full flex items-center justify-center min-h-[400px]",children:ce.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(r,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-10 sm:w-10",onClick:()=>re(!1),children:a.jsx($,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),a.jsxs("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 bg-black/70 text-white px-3 py-1.5 rounded-full text-xs sm:text-sm font-medium backdrop-blur-sm z-50",children:[ne+1," / ",ce.length]}),a.jsx("div",{className:"w-full h-full flex items-center justify-center p-2 sm:p-4 pt-12 pb-20 sm:pb-24",children:a.jsx("img",{src:ce[ne]||"/placeholder.svg",alt:"Image "+(ne+1),className:"max-w-full max-h-[calc(98vh-160px)] object-contain"})}),ce.length>1&&a.jsxs(a.Fragment,{children:[a.jsx(r,{variant:"ghost",size:"icon",className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-12 sm:w-12",onClick:()=>oe(e=>0===e?ce.length-1:e-1),children:a.jsx(C,{className:"h-4 w-4 sm:h-6 sm:w-6"})}),a.jsx(r,{variant:"ghost",size:"icon",className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-50 bg-black/70 hover:bg-black/90 text-white border-none h-8 w-8 sm:h-12 sm:w-12",onClick:()=>oe(e=>e===ce.length-1?0:e+1),children:a.jsx(z,{className:"h-4 w-4 sm:h-6 sm:w-6"})})]}),ce.length>1&&a.jsx("div",{className:"absolute bottom-2 sm:bottom-4 left-1/2 -translate-x-1/2 bg-black/70 backdrop-blur-sm rounded-lg p-2 sm:p-3 z-50 max-w-[calc(98vw-32px)]",children:a.jsx("div",{className:"flex gap-2 sm:gap-3 overflow-x-auto scrollbar-hide px-1",children:ce.map((e,s)=>a.jsx("button",{onClick:()=>oe(s),className:"relative flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 rounded transition-all "+(ne===s?"scale-110 shadow-lg shadow-primary/50":"opacity-70 hover:opacity-100"),children:a.jsx("div",{className:"absolute inset-0 rounded overflow-hidden border-2 "+(ne===s?"border-primary ring-2 ring-primary/50 ring-offset-2 ring-offset-black/70":"border-transparent hover:border-white/50"),children:a.jsx("img",{src:e,alt:"Thumbnail "+(s+1),className:"w-full h-full object-cover transition-opacity "+(ne===s?"opacity-100":"opacity-70")})})},s))})})]})})]})})]})};export{E as default};
