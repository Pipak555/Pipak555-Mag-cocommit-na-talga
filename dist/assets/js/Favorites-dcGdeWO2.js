const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-Bl4WVUm9.js","assets/js/react-vendor-BMVo5gto.js","assets/js/utils-vendor-yBsXXcRr.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-Dbp4DHG_.js","assets/js/icons-vendor-BQMxNFbQ.js","assets/js/firebase-vendor-BtzXZj7S.js","assets/index-D7xL4X8S.css"])))=>i.map(i=>d[i]);
import{u as s,j as e,_ as i,v as t,B as a,C as r,a as o,b as n,c as l,d as c,e as d,q as u,t as m}from"./index-Bl4WVUm9.js";import{u as f,r as g,j as h}from"./react-vendor-BMVo5gto.js";import{f as j,e as v}from"./firebase-vendor-BtzXZj7S.js";import{L as x}from"./ListingCard-CV_xDRBJ.js";import{E as p}from"./empty-state-Fqt3Rb73.js";import{A as w,q as y}from"./icons-vendor-BQMxNFbQ.js";import"./ui-vendor-Dbp4DHG_.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./badge-_91-i8yA.js";const b=()=>{const b=f(),{user:N,hasRole:L}=s(),[F,S]=g.useState(null),[_,k]=g.useState([]),[E,A]=g.useState([]),[C,P]=g.useState([]),[R,B]=g.useState(!0);g.useEffect(()=>{!N||L("guest")?N?q():B(!1):b("/guest/login")},[N,b]),g.useEffect(()=>{N&&F&&(I(),D())},[N,F]);const q=async()=>{if(N)try{const s=await j(v(e,"users",N.uid));if(s.exists()){const e=s.data();S(e),A(e.favorites||[]),P(e.wishlist||[])}}catch(s){}finally{B(!1)}},D=async()=>{if(N)try{const s=await j(v(e,"users",N.uid));if(s.exists()){const e=s.data();P(e.wishlist||[])}}catch(s){}},I=async()=>{if(N&&F?.favorites?.length)try{const{getListing:s}=await i(async()=>{const{getListing:s}=await import("./index-Bl4WVUm9.js").then(s=>s.T);return{getListing:s}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),e=await Promise.all(F.favorites.map(e=>s(e)));k(e.filter(s=>null!==s))}catch(s){k([])}else k([])};return R?h.jsx(t,{}):h.jsx("div",{className:"min-h-screen bg-background",children:h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsx("div",{className:"flex items-center justify-between mb-6",children:h.jsxs(a,{variant:"ghost",onClick:()=>b("/guest/dashboard"),className:"flex items-center gap-2",children:[h.jsx(w,{className:"h-4 w-4"}),"Back to Dashboard"]})}),h.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Your Favorites"}),h.jsxs(r,{children:[h.jsxs(o,{children:[h.jsx(n,{children:"Your Favorites"}),h.jsx(l,{children:"Listings you've liked and saved"})]}),h.jsx(c,{children:0===_.length?h.jsx(p,{icon:h.jsx(y,{className:"h-10 w-10"}),title:"No favorites yet",description:"Start exploring and add listings to your favorites!",action:h.jsx(a,{onClick:()=>b("/guest/browse"),children:"Browse Listings"})}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map(s=>h.jsx(x,{listing:s,onView:()=>b("/guest/listing/"+s.id),onFavorite:()=>(async s=>{if(N)try{const e=await m(N.uid,s,E);A(e),S(s=>s?{...s,favorites:e}:null),I(),d.success(e.includes(s)?"Added to favorites":"Removed from favorites")}catch(e){d.error("Failed to update favorites")}else d.error("Please login to manage favorites")})(s.id),onWishlist:()=>(async s=>{if(N)try{const e=await u(N.uid,s,C);P(e),S(s=>s?{...s,wishlist:e}:null),d.success(e.includes(s)?"Added to wishlist":"Removed from wishlist")}catch(e){d.error("Failed to update wishlist")}else d.error("Please login to manage wishlist")})(s.id),isFavorite:E.includes(s.id),isInWishlist:C.includes(s.id)},s.id))})})]})]})})};export{b as default};
