import{u as e,r as s,j as t}from"./react-vendor-Ve3SFwKO.js";import{u as r,L as a,B as n,C as i,d as l,a as o,b as d,c,i as m,j as x}from"./index-DaMaslBo.js";import{N as g}from"./NotificationBell-D2XQODdv.js";import{B as h}from"./badge-BSgvUoVt.js";import{T as u}from"./theme-toggle-Djm4W2SX.js";import{B as p}from"./BackButton-uEV41aeK.js";import{q as j,w as b,d as f,l as N,f as v,h as y}from"./firebase-vendor-BC71bXmb.js";import{S as w,a as k,b as D,c as S,d as C}from"./select-CXm8ONYg.js";import{D as I,a as T,b as O,c as B,d as L}from"./dialog-GBvfaobK.js";import{A as H,a as P,b as z,c as M,d as A,e as F,f as $,g as G}from"./alert-dialog-DLw-Qa8s.js";import{a3 as V,a4 as Y,K as U,am as E,an as q,j as K}from"./icons-vendor-Dhca6XHc.js";import"./utils-vendor-DzY7Ay74.js";import"./maps-vendor-CYGXCXz5.js";import"./ui-vendor-D9RGQy8n.js";import"./input-D5hloL4G.js";import"./scroll-area-Dps723Uf.js";import"./switch-CSe7-F5W.js";import"./label-B2t2XnWQ.js";import"./dropdown-menu-DVnKNEtJ.js";const W=()=>{const W=e(),{user:Z,signOut:J}=r(),[Q,R]=s.useState([]),[X,_]=s.useState([]),[ee,se]=s.useState(!0),[te,re]=s.useState(new Date),[ae,ne]=s.useState("month"),[ie,le]=s.useState("all"),[oe,de]=s.useState(null),[ce,me]=s.useState(!1),[xe,ge]=s.useState(!1);s.useEffect(()=>{if(!Z)return;const e=j(f(x,"listing"),b("hostId","==",Z.uid)),s=N(e,e=>{const s=e.docs.map(e=>({id:e.id,...e.data()}));_(s)});return()=>s()},[Z]),s.useEffect(()=>{if(!Z)return;se(!0);const e=j(f(x,"bookings"),b("hostId","==",Z.uid)),s=N(e,async e=>{const s=await Promise.all(e.docs.map(async e=>{const s={id:e.id,...e.data()};if(s.listingId){const e=v(x,"listing",s.listingId),t=await y(e);if(t.exists()){const e=t.data();s.listingTitle=e?.title,s.listingLocation=e?.location}}if(s.guestId){const e=v(x,"users",s.guestId),t=await y(e);t.exists()&&(s.guestName=t.data()?.fullName)}return s}));R(s),se(!1)});return()=>s()},[Z]);const he=e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e.checkOut);return t.setHours(0,0,0,0),s>t&&"confirmed"===e.status?"bg-green-500":"confirmed"===e.status?"bg-blue-500":"pending"===e.status?"bg-orange-500":(e.status,"bg-gray-400")},ue=e=>{const s=new Date;s.setHours(0,0,0,0);const t=new Date(e.checkOut);return t.setHours(0,0,0,0),s>t&&"confirmed"===e.status?"Successful":"confirmed"===e.status?"Upcoming":"pending"===e.status?"Pending":"cancelled"===e.status?"Cancelled":e.status},pe=e=>{de(e),me(!0)},je=(()=>{const e=te.getFullYear(),s=te.getMonth(),t=new Date(e,s,1),r=new Date(e,s+1,0).getDate(),a=t.getDay(),n=[];for(let i=0;a>i;i++)n.push(null);for(let i=1;r>=i;i++)n.push(new Date(e,s,i));return n})(),be=te.toLocaleDateString("en-US",{month:"long",year:"numeric"}),fe=()=>{let e=Q.filter(e=>"cancelled"!==e.status);return"all"!==ie&&(e=e.filter(e=>e.listingId===ie)),e.sort((e,s)=>new Date(e.checkIn).getTime()-new Date(s.checkIn).getTime()),e};return t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx("header",{className:"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 shadow-soft",children:t.jsxs("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-3 sm:py-4 flex justify-between items-center gap-2 sm:gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[t.jsx(p,{to:"/host/dashboard",label:"Back to Dashboard"}),t.jsx(a,{size:"sm"})]}),t.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0",children:[t.jsx(g,{}),t.jsx(u,{}),t.jsxs(n,{variant:"outline",onClick:()=>ge(!0),className:"h-9 sm:h-auto text-xs sm:text-sm px-2 sm:px-4 touch-manipulation",children:[t.jsx("span",{className:"hidden sm:inline",children:"Sign Out"}),t.jsx("span",{className:"sm:hidden",children:"Out"})]})]})]})}),t.jsxs("main",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6 md:py-8",children:[t.jsx(p,{to:"/host/dashboard",label:"Back to Dashboard",className:"mb-4 sm:mb-6"}),t.jsxs("div",{className:"mb-4 sm:mb-6 md:mb-8",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-2",children:"Booking Calendar"}),t.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage your bookings and availability"})]}),t.jsx(i,{className:"mb-6",children:t.jsx(l,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(n,{variant:"outline",size:"icon",onClick:()=>{re(new Date(te.getFullYear(),te.getMonth()-1))},children:t.jsx(V,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-xl font-semibold min-w-[200px] text-center",children:be}),t.jsx(n,{variant:"outline",size:"icon",onClick:()=>{re(new Date(te.getFullYear(),te.getMonth()+1))},children:t.jsx(Y,{className:"h-4 w-4"})}),t.jsx(n,{variant:"outline",onClick:()=>{re(new Date)},children:"Today"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(w,{value:ie,onValueChange:le,children:[t.jsxs(k,{className:"w-[200px]",children:[t.jsx(U,{className:"h-4 w-4 mr-2"}),t.jsx(D,{placeholder:"All Properties"})]}),t.jsxs(S,{children:[t.jsx(C,{value:"all",children:"All Properties"}),X.map(e=>t.jsx(C,{value:e.id,children:e.title},e.id))]})]}),t.jsxs("div",{className:"flex items-center gap-2 border rounded-md p-1",children:[t.jsxs(n,{variant:"month"===ae?"default":"ghost",size:"sm",onClick:()=>ne("month"),children:[t.jsx(E,{className:"h-4 w-4 mr-2"}),"Month"]}),t.jsxs(n,{variant:"list"===ae?"default":"ghost",size:"sm",onClick:()=>ne("list"),children:[t.jsx(q,{className:"h-4 w-4 mr-2"}),"List"]})]})]})]})})}),t.jsx(i,{className:"mb-6",children:t.jsx(l,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-4 sm:gap-6",children:[t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-primary/5 border border-primary/20 hover:bg-primary/10 transition-colors",children:[t.jsx("div",{className:"w-5 h-5 rounded-md border-2 border-primary bg-primary/10 flex items-center justify-center shadow-sm",children:t.jsx(K,{className:"h-3 w-3 text-primary"})}),t.jsx("span",{className:"text-sm font-semibold text-primary",children:"Today"})]}),t.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-blue-500/5 border border-blue-500/20 hover:bg-blue-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-blue-500 shadow-sm ring-2 ring-blue-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Upcoming"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-green-500/5 border border-green-500/20 hover:bg-green-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-green-500 shadow-sm ring-2 ring-green-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Successful"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-orange-500/5 border border-orange-500/20 hover:bg-orange-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-orange-500 shadow-sm ring-2 ring-orange-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Pending"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-gray-500/5 border border-gray-500/20 hover:bg-gray-500/10 transition-colors",children:[t.jsx("div",{className:"w-4 h-4 rounded-md bg-gray-400 dark:bg-gray-500 shadow-sm ring-2 ring-gray-400/20 dark:ring-gray-500/20"}),t.jsx("span",{className:"text-sm font-medium",children:"Cancelled"})]})]})})}),"month"===ae&&t.jsx(i,{children:t.jsxs(l,{className:"p-6",children:[t.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>t.jsx("div",{className:"text-center font-semibold text-sm py-2",children:e},e))}),t.jsx("div",{className:"grid grid-cols-7 gap-2",children:je.map((e,s)=>{const r=e?(e=>{if(!e)return[];e.toISOString().split("T")[0];let s=Q.filter(s=>{if("cancelled"===s.status)return!1;const t=new Date(s.checkIn),r=new Date(s.checkOut);return t.setHours(0,0,0,0),r.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=t&&r>=e});return"all"!==ie&&(s=s.filter(e=>e.listingId===ie)),s})(e):[],a=e&&e.toDateString()===(new Date).toDateString();return t.jsx("div",{className:`\n                        min-h-[120px] border rounded-lg p-2 relative\n                        ${e?"bg-card hover:bg-muted/50 cursor-pointer":"bg-muted/20"}\n                        ${a?"border-primary border-2 bg-primary/5":""}\n                        transition-colors\n                      `,children:e&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"text-sm font-medium mb-2 flex items-center gap-1.5 "+(a?"text-primary font-bold":""),children:[t.jsx("span",{className:a?"text-base":"",children:e.getDate()}),a&&t.jsx("span",{className:"text-xs bg-primary text-primary-foreground px-2 py-0.5 rounded-md font-medium shadow-sm",children:"Today"})]}),t.jsxs("div",{className:"space-y-1.5",children:[r.slice(0,3).map((e,s)=>{const r=new Date;r.setHours(0,0,0,0);const a=new Date(e.checkOut);a.setHours(0,0,0,0);const n="completed"===e.status||r>a&&"confirmed"===e.status,i="confirmed"===e.status&&a>=r,l="pending"===e.status,o="cancelled"===e.status;return t.jsx("div",{className:`\n                                    text-xs px-2.5 py-1.5 rounded-md cursor-pointer \n                                    transition-all duration-200 hover:scale-[1.02] hover:shadow-md active:scale-[0.98]\n                                    truncate font-medium shadow-sm\n                                    ${n?"bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700 border border-green-400/30":i?"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 border border-blue-400/30":l?"bg-gradient-to-r from-orange-500 to-orange-600 text-white hover:from-orange-600 hover:to-orange-700 border border-orange-400/30":o?"bg-gradient-to-r from-gray-400 to-gray-500 dark:from-gray-500 dark:to-gray-600 text-white hover:from-gray-500 hover:to-gray-600 dark:hover:from-gray-600 dark:hover:to-gray-700 border border-gray-300/30 dark:border-gray-400/30":"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 border border-blue-400/30"}\n                                  `,onClick:()=>pe(e),title:`${e.listingTitle} - ${ue(e)}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0 "+(n?"bg-green-200 ring-2 ring-green-300/50":i?"bg-blue-200 ring-2 ring-blue-300/50":l?"bg-orange-200 ring-2 ring-orange-300/50":o?"bg-gray-200 ring-2 ring-gray-300/50":"bg-blue-200 ring-2 ring-blue-300/50")}),t.jsx("span",{className:"truncate flex-1 leading-tight",children:e.listingTitle})]})},s)}),r.length>3&&t.jsxs("div",{className:"text-xs text-muted-foreground font-medium px-2.5 py-1.5 bg-muted/60 dark:bg-muted/40 rounded-md text-center border border-border/50 hover:bg-muted/80 transition-colors",children:["+",r.length-3," more"]})]})]})},s)})})]})}),"list"===ae&&t.jsxs(i,{children:[t.jsxs(o,{children:[t.jsx(d,{children:"All Bookings"}),t.jsxs(c,{children:[fe().length," booking",1!==fe().length?"s":""]})]}),t.jsx(l,{children:ee?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading bookings..."}):0===fe().length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(K,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No bookings found"})]}):t.jsx("div",{className:"space-y-4",children:fe().map(e=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>pe(e),children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("h3",{className:"font-semibold",children:e.listingTitle}),t.jsx(h,{className:he(e),children:ue(e)})]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:["ðŸ“ ",e.listingLocation]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:["ðŸ‘¤ ",e.guestName||"Guest"]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["ðŸ“… ",new Date(e.checkIn).toLocaleDateString()," - ",new Date(e.checkOut).toLocaleDateString()]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-semibold text-lg",children:m(e.totalPrice||0)}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.guests," guest",1!==e.guests?"s":""]})]})]})},e.id))})})]})]}),t.jsx(I,{open:ce,onOpenChange:me,children:t.jsxs(T,{className:"max-w-2xl",children:[t.jsxs(O,{children:[t.jsx(B,{children:"Booking Details"}),t.jsx(L,{children:"View booking information"})]}),oe&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold",children:oe.listingTitle}),t.jsx(h,{className:he(oe),children:ue(oe)})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-in"}),t.jsx("p",{className:"font-medium",children:new Date(oe.checkIn).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-out"}),t.jsx("p",{className:"font-medium",children:new Date(oe.checkOut).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Guest"}),t.jsx("p",{className:"font-medium",children:oe.guestName||"Guest"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Guests"}),t.jsx("p",{className:"font-medium",children:oe.guests})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),t.jsx("p",{className:"font-medium text-lg",children:m(oe.totalPrice||0)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Booking ID"}),t.jsxs("p",{className:"font-medium text-sm",children:[oe.id.slice(0,8),"..."]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Location"}),t.jsx("p",{className:"font-medium",children:oe.listingLocation})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(n,{variant:"default",className:"flex-1",onClick:()=>{W("/host/bookings"),me(!1)},children:"View in Bookings"}),t.jsx(n,{variant:"outline",onClick:()=>me(!1),children:"Close"})]})]})]})}),t.jsx(H,{open:xe,onOpenChange:ge,children:t.jsxs(P,{children:[t.jsxs(z,{children:[t.jsx(M,{children:"Sign Out?"}),t.jsx(A,{children:"Are you sure you want to sign out?"})]}),t.jsxs(F,{children:[t.jsx($,{children:"Cancel"}),t.jsx(G,{onClick:async()=>{try{await J(),W("/")}catch(e){}},children:"Sign Out"})]})]})})]})};export{W as default};
