const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-Bl4WVUm9.js","assets/js/react-vendor-BMVo5gto.js","assets/js/utils-vendor-yBsXXcRr.js","assets/js/maps-vendor-CYGXCXz5.js","assets/maps-vendor-Dgihpmma.css","assets/js/ui-vendor-Dbp4DHG_.js","assets/js/icons-vendor-BQMxNFbQ.js","assets/js/firebase-vendor-BtzXZj7S.js","assets/index-D7xL4X8S.css"])))=>i.map(i=>d[i]);
import{u as e,j as s,h as a,k as t,L as r,B as i,C as o,a as l,b as n,d as c,i as d,c as m,e as h,_ as x,t as g}from"./index-Bl4WVUm9.js";import{u,r as p,j}from"./react-vendor-BMVo5gto.js";import{N as v}from"./NotificationBell-CwTk-oRi.js";import{C as f,h as b,e as w,s as N}from"./category-service-BYU_VDmF.js";import{V as y}from"./video-background-0x67CGr6.js";import{T as k}from"./theme-toggle-Cc0KLt9y.js";import{L as C}from"./ListingCard-CV_xDRBJ.js";import{getRecommendations as B}from"./recommendations-J7sTgRiB.js";import{k as S,e as R,f as W}from"./firebase-vendor-BtzXZj7S.js";import{A,a as O,b as P,c as T,d as z,e as D,f as F,g as I}from"./alert-dialog-ChaDevpt.js";import{h as V}from"./hero-home-D5ap7Mum.js";import{o as _,B as E,H as L,b as Y,W as G,p as H,q as M,j as q,l as U,r as Q,n as $}from"./icons-vendor-BQMxNFbQ.js";import"./ui-vendor-Dbp4DHG_.js";import"./utils-vendor-yBsXXcRr.js";import"./maps-vendor-CYGXCXz5.js";import"./scroll-area-Dt92Xony.js";import"./badge-_91-i8yA.js";import"./dropdown-menu-CmwzabuV.js";const J=()=>{const{user:J,userRole:K,userProfile:X,signOut:Z,hasRole:ee,addRole:se}=e(),ae=u(),[te,re]=p.useState({favorites:0,wishlist:0,upcomingTrips:0,pastBookings:0,walletBalance:0}),[ie,oe]=p.useState([]),[le,ne]=p.useState([]),[ce,de]=p.useState(!0),[me,he]=p.useState(!1);p.useEffect(()=>{if(!J||!ee("guest"))return void ae("/guest/login");xe();const e=S(R(s,"users",J.uid),e=>{if(e.exists()){const s=e.data();re(e=>({...e,favorites:s.favorites?.length||0,wishlist:s.wishlist?.length||0,walletBalance:s.walletBalance||0})),ne(s.favorites||[])}});return()=>{e()}},[J,K,ae]);const xe=async()=>{if(J){de(!0);try{const e=await a({guestId:J.uid}),s=new Date,r=e.filter(e=>new Date(e.checkIn)>=s&&"confirmed"===e.status).length,i=e.filter(e=>{const a=new Date(e.checkOut);return s>a||"completed"===e.status}).length;re(e=>({...e,upcomingTrips:r,pastBookings:i}));const o=await B(J.uid,6);if(o.length>0){const e=o.map(e=>e.id),s=await t(e),a=o.map(e=>{const a=s.get(e.id);return{...e,averageRating:a?.averageRating||0,reviewCount:a?.reviewCount||0}});oe(a)}else oe(o)}catch(e){}finally{de(!1)}}},ge=async()=>{ee("host")?ae("/host/dashboard"):ae("/host/policies")};return j.jsxs("div",{className:"min-h-screen bg-background",children:[j.jsx("header",{className:"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 shadow-soft",children:j.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center gap-2 sm:gap-3",children:[j.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[j.jsx(r,{size:"sm"}),j.jsx("div",{className:"hidden sm:block p-2 rounded-lg bg-secondary/10",children:j.jsx(_,{className:"w-5 h-5 text-secondary"})}),j.jsxs("div",{className:"min-w-0 flex-1",children:[j.jsxs("h1",{className:"text-base sm:text-lg font-bold truncate",children:["Welcome, ",X?.fullName||"Guest","!"]}),j.jsx("p",{className:"text-xs text-muted-foreground hidden sm:block",children:"Discover your next adventure"})]})]}),j.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0",children:[j.jsx(v,{}),j.jsx(k,{}),j.jsxs(i,{variant:"outline",onClick:()=>he(!0),className:"h-9 sm:h-auto text-xs sm:text-sm px-2 sm:px-4 touch-manipulation",children:[j.jsx("span",{className:"hidden sm:inline",children:"Sign Out"}),j.jsx("span",{className:"sm:hidden",children:"Out"})]})]})]})}),j.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[j.jsxs("div",{className:"relative mb-8 rounded-xl overflow-hidden h-64 md:h-80 lg:h-96 shadow-lg",children:[j.jsx(y,{src:"/videos/landing-hero.mp4",overlay:!0,fallbackImage:V}),j.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/60 via-black/40 to-black/60 z-10"}),j.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent z-10"}),j.jsxs("div",{className:"relative z-20 h-full flex flex-col items-center justify-center text-center px-6",children:[j.jsx("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold mb-4 text-white drop-shadow-2xl",children:"Discover Your Next Adventure"}),j.jsxs("p",{className:"text-lg md:text-xl text-white/90 mb-6 max-w-2xl drop-shadow-lg",children:["Welcome back, ",X?.fullName||"Guest","! Ready to explore amazing places?"]}),j.jsx(i,{size:"lg",className:"h-12 px-8 text-lg bg-primary hover:bg-primary/90 shadow-2xl hover:shadow-2xl hover:scale-105 transition-all",onClick:()=>ae("/guest/browse"),children:"Browse All Listings"})]})]}),j.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4 md:gap-6 mb-6 sm:mb-8 "+(ee("host")?"lg:grid-cols-5":"lg:grid-cols-6"),children:[j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer hover:scale-105 active:scale-100",onClick:()=>ae("/guest/favorites"),children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary via-secondary to-accent"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Favorites"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-primary to-primary-glow bg-clip-text text-transparent",children:te.favorites})})]}),j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer hover:scale-105 active:scale-100",onClick:()=>ae("/guest/wishlist"),children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 via-blue-400 to-blue-300"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Wishlist"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-blue-500 to-blue-600 bg-clip-text text-transparent",children:te.wishlist})})]}),j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>ae("/guest/bookings?filter=upcoming"),children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-primary to-accent"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Upcoming Trips"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-secondary to-secondary/80 bg-clip-text text-transparent",children:te.upcomingTrips})})]}),j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group cursor-pointer",onClick:()=>ae("/guest/bookings?filter=past"),children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-accent via-primary to-secondary"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Past Bookings"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold",children:te.pastBookings})})]}),j.jsxs(o,{className:"relative overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group",children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-accent via-green-500 to-green-600"}),j.jsx(l,{className:"pb-3",children:j.jsx(n,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Wallet Balance"})}),j.jsx(c,{children:j.jsx("div",{className:"text-3xl font-bold text-accent",children:d(te.walletBalance)})})]}),!ee("host")&&j.jsxs(o,{className:"relative overflow-hidden border-2 border-secondary/30 shadow-lg hover:shadow-xl transition-all duration-300 group cursor-pointer bg-gradient-to-br from-secondary/5 to-secondary/10",onClick:ge,children:[j.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-secondary via-secondary/80 to-secondary/60"}),j.jsx(l,{className:"pb-3",children:j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(E,{className:"w-5 h-5 text-secondary"}),j.jsx(n,{className:"text-sm font-medium text-secondary uppercase tracking-wide",children:"Become a Host"})]})}),j.jsxs(c,{children:[j.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Start earning by hosting your property"}),j.jsx(i,{variant:"secondary",className:"w-full",onClick:e=>{e.stopPropagation(),ge()},children:"Get Started"})]})]})]}),j.jsxs("div",{className:"mb-8",children:[j.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Browse Categories"}),j.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[j.jsx(f,{videoSrc:"/videos/category-home.mp4",fallbackImage:b,icon:L,title:"Homes",description:"Find your perfect stay",href:"/guest/browse?category=home",colorClass:"primary"}),j.jsx(f,{videoSrc:"/videos/category-experience.mp4",fallbackImage:w,icon:Y,title:"Experiences",description:"Discover unique activities",href:"/guest/browse?category=experience",colorClass:"secondary"}),j.jsx(f,{videoSrc:"/videos/category-service.mp4",fallbackImage:N,icon:G,title:"Services",description:"Professional assistance",href:"/guest/browse?category=service",colorClass:"accent"})]})]}),ie.length>0&&j.jsxs("div",{className:"mb-8",children:[j.jsxs("div",{className:"flex items-center justify-between mb-6",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(H,{className:"w-6 h-6 text-primary"}),j.jsx("h3",{className:"text-2xl font-bold",children:"Recommended for You"})]}),j.jsx(i,{variant:"outline",onClick:()=>ae("/guest/browse"),children:"View All"})]}),j.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 items-stretch",children:ie.slice(0,3).map(e=>j.jsx(C,{listing:e,onView:()=>ae("/guest/listing/"+e.id),onFavorite:()=>(async e=>{if(J)try{const s=await g(J.uid,e,le);ne(s),h.success(s.includes(e)?"Added to favorites":"Removed from favorites")}catch(s){h.error("Failed to update favorites")}else h.error("Please login to add favorites")})(e.id),onWishlist:()=>(async e=>{if(J)try{const{toggleWishlist:a}=await x(async()=>{const{toggleWishlist:e}=await import("./index-Bl4WVUm9.js").then(e=>e.T);return{toggleWishlist:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),t=await W(R(s,"users",J.uid)),r=t.exists()&&t.data().wishlist||[],i=await a(J.uid,e,r);h.success(i.includes(e)?"Added to wishlist":"Removed from wishlist")}catch(a){h.error("Failed to update wishlist")}else h.error("Please login to add to wishlist")})(e.id),isFavorite:le.includes(e.id)},e.id))})]}),j.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-5 gap-6",children:[j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ae("/guest/favorites"),children:j.jsxs(l,{children:[j.jsx(M,{className:"w-8 h-8 text-primary mb-2"}),j.jsx(n,{children:"Favorites"}),j.jsx(m,{children:"Your saved listings"})]})}),j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ae("/guest/bookings"),children:j.jsxs(l,{children:[j.jsx(q,{className:"w-8 h-8 text-secondary mb-2"}),j.jsx(n,{children:"My Bookings"}),j.jsx(m,{children:"View your trips"})]})}),j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ae("/guest/messages"),children:j.jsxs(l,{children:[j.jsx(U,{className:"w-8 h-8 text-primary mb-2"}),j.jsx(n,{children:"Messages"}),j.jsx(m,{children:"View your conversations"})]})}),j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ae("/guest/wallet"),children:j.jsxs(l,{children:[j.jsx(Q,{className:"w-8 h-8 text-accent mb-2"}),j.jsx(n,{children:"E-Wallet"}),j.jsx(m,{children:"Manage your balance"})]})}),j.jsx(o,{className:"shadow-medium hover:shadow-hover transition-smooth cursor-pointer",onClick:()=>ae("/guest/settings"),children:j.jsxs(l,{children:[j.jsx($,{className:"w-8 h-8 text-muted-foreground mb-2"}),j.jsx(n,{children:"Settings"}),j.jsx(m,{children:"Account preferences"})]})})]})]}),j.jsx(A,{open:me,onOpenChange:he,children:j.jsxs(O,{children:[j.jsxs(P,{children:[j.jsx(T,{children:"Sign Out"}),j.jsx(z,{children:"Are you sure you want to sign out? You'll need to sign in again to access your account."})]}),j.jsxs(D,{children:[j.jsx(F,{children:"Cancel"}),j.jsx(I,{onClick:async()=>{await Z(),ae("/")},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sign Out"})]})]})})]})};export{J as default};
