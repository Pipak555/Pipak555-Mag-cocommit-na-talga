const c=async(r,e)=>{var s;const n="dpctmlqay",d="mojo_dojo_unsigned",a=new FormData;a.append("file",r),a.append("upload_preset",d),e&&a.append("folder",e);try{const o=await fetch(`https://api.cloudinary.com/v1_1/${n}/image/upload`,{method:"POST",body:a});if(!o.ok){const l=await o.json().catch(()=>({}));throw new Error(((s=l.error)==null?void 0:s.message)||`Cloudinary upload failed: ${o.status} ${o.statusText}`)}return(await o.json()).secure_url}catch(o){throw console.error("Cloudinary upload error:",o),new Error(`Failed to upload image: ${o.message||"Unknown error"}`)}},i=async(r,e,n)=>{const d=`listings/${e}`,a=[],s=r.length;for(let o=0;o<r.length;o++)try{const t=await c(r[o],d);if(a.push(t),n){const l=Math.round((o+1)/s*100);n(l)}}catch(t){throw console.error(`Failed to upload image ${o+1}:`,t),new Error(`Failed to upload image ${o+1}: ${t.message}`)}return a};export{c as uploadImageToCloudinary,i as uploadListingImages};
